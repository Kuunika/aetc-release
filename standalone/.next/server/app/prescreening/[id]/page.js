(()=>{var e={};e.id=3478,e.ids=[3478],e.modules={2279:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var i=r(60687),n=r(95602),s=r(61939),a=r(5608),l=r(75018),o=r(62116),c=r(42938),d=r(13670),u=r(48859),p=r(93251),x=r(77575),m=r(23818);r(43210);var h=r(85121),f=r(44504);function g(){let{ServerTime:e}=(0,f.useServerTime)(),{activeVisit:t,patientId:r}=(0,s.gd)(),{navigateTo:g}=(0,s.cq)(),{mutate:b,isPending:j,isSuccess:v}=(0,o.jM)(),{mutate:y,isSuccess:E}=(0,d.FD)(),{loading:T,setLoading:S,completed:A,setCompleted:_,message:R,setMessage:P,showForm:I,setShowForm:k,error:C,setError:D}=(0,u.g)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h.V,{title:"Prescreening",link:"/initial-registration/list"}),(0,i.jsxs)(l.Yr,{container:!0,children:[(0,i.jsx)(l.Yr,{xs:1,lg:3,item:!0}),(0,i.jsxs)(l.Yr,{xs:10,lg:6,sx:{display:"flex",flexDirection:"column"},item:!0,children:[(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(a.sL,{children:"Screening"}),(0,i.jsx)(a.VQ,{children:"This is a list of all patients that went through initial registration successfully and waiting for prescreening."}),I&&(0,i.jsx)(a.kC,{children:(0,i.jsx)(n.O,{onSubmit:i=>{k(!1),S(!0),P("add Screening data... ");let n=e.getServerTimeString();b({encounterType:c.fA.SCREENING_ENCOUNTER,visit:t,patient:r,encounterDatetime:n,obs:[{concept:c.W.IS_PATIENT_REFERRED,value:i[c.W.IS_PATIENT_REFERRED],obsDatetime:n},{concept:c.W.IS_SITUATION_URGENT,value:i[c.W.IS_SITUATION_URGENT],obsDatetime:n},{concept:c.W.PATIENT_REFERRED_TO,value:i[c.W.PATIENT_REFERRED_TO],obsDatetime:n}]}),i[c.W.PATIENT_REFERRED_TO]&&y(t)}})}),1==A&&(0,i.jsx)(p.n,{title:"Patient Screened Successfully",primaryActionText:"screen more",secondaryActionText:"Go Home",onPrimaryAction:()=>{g("/initial-registration/list"),k(!0),_(0)},onSecondaryAction:()=>{g("/dashboard")}}),C&&(0,i.jsx)(x.j,{error:R,onPrimaryAction:()=>{D(!1),_(0),S(!1),k(!0)},onSecondaryAction:()=>{_(0),k(!0),S(!1),D(!1)}}),T&&!C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(m.n,{message:R,progress:A/1*100})]})]}),(0,i.jsx)(l.Yr,{xs:1,lg:3,item:!0})]})]})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5608:(e,t,r)=>{"use strict";r.d(t,{VQ:()=>a,kC:()=>l,sL:()=>s,uQ:()=>o});var i=r(60687),n=r(75018);let s=({children:e,id:t})=>(0,i.jsx)(n.Th,{id:t,sx:{fontFamily:"Inter",fontSize:24,fontWeight:700,lineHeight:"29px",letterSpacing:0,textAlign:"center"},children:e}),a=({children:e})=>(0,i.jsx)(n.Th,{alignSelf:"center",sx:{fontFamily:"Inter",fontSize:14,fontWeight:400,lineHeight:"21px",letterSpacing:0,color:"#636363",width:"50ch",textAlign:"center",my:"2ch"},children:e}),l=({children:e,sx:t})=>(0,i.jsx)(n.sc,{elevation:0,sx:{display:"flex",flexDirection:"column",justifyContent:"center",px:"5ch",py:"5ch",mb:"2ch",...t},children:e}),o=({children:e})=>(0,i.jsx)(n.Th,{sx:{fontFamily:"Inter",fontSize:"16px",fontWeight:600,lineHeight:"24px",letterSpacing:"0em",textAlign:"center",my:"2ch"},children:e})},7304:(e,t,r)=>{"use strict";r.d(t,{C:()=>s});var i=r(43210),n=r(76831);let s=()=>{let{data:e,isLoading:t}=(0,n.X)("Service areas"),[r,s]=(0,i.useState)([]);return(0,i.useEffect)(()=>{if(e){let t=e.map(e=>({label:e.name,id:e.uuid}));s(t),t.find(e=>"Other"===e.label)}},[e]),{serviceAreaOptions:r,serviceAreaLoading:t,serviceAreas:e}}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11162:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var i=r(65239),n=r(48088),s=r(88170),a=r.n(s),l=r(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let c={children:["",{children:["prescreening",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,56317)),"/Users/pk/App/hwis/aetc/app/prescreening/[id]/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,20800)),"/Users/pk/App/hwis/aetc/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,52608)),"/Users/pk/App/hwis/aetc/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/pk/App/hwis/aetc/app/prescreening/[id]/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/prescreening/[id]/page",pathname:"/prescreening/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},12412:e=>{"use strict";e.exports=require("assert")},13670:(e,t,r)=>{"use strict";r.d(t,{b2:()=>d,FD:()=>u,qv:()=>p});var i=r(44504),n=r(60579);let s="visits",a=e=>(0,n.vt)(e,s),l=(e,t)=>(0,n.hc)(e,t,s);var o=r(8693),c=r(54050);let d=()=>{let e=(0,o.jE)();return(0,c.n)({mutationFn:e=>a(e).then(e=>e.data),onSuccess:t=>{e.invalidateQueries({queryKey:["visits"]})}})},u=()=>{let{ServerTime:e}=(0,i.useServerTime)(),t=async t=>l(t,{stopDatetime:e.getServerTimeString()}).then(e=>e.data);return(0,c.n)({mutationFn:t})},p=e=>{let t=(0,o.jE)();return(0,c.n)({mutationFn:e=>l(e,{stopDatetime:"null"}).then(e=>e.data),onSuccess:()=>{t.invalidateQueries({queryKey:["patients",e,"visits"]})}})}},17468:(e,t,r)=>{Promise.resolve().then(r.bind(r,2279))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},23818:(e,t,r)=>{"use strict";r.d(t,{n:()=>d});var i=r(60687);r(43210);var n=r(109),s=r(28274),a=r(1556),l=r(12058),o=r(75018);let c=(0,n.Ay)(a.A)(({theme:e})=>({height:10,borderRadius:5,[`&.${l.A.colorPrimary}`]:{backgroundColor:e.palette.grey["light"===e.palette.mode?200:800]},[`& .${l.A.bar}`]:{borderRadius:5,backgroundColor:e.palette.primary}}));function d({message:e,progress:t}){return(0,i.jsxs)(s.default,{sx:{flexGrow:1},children:[(0,i.jsx)(c,{variant:"determinate",value:t}),(0,i.jsx)(o.Th,{fontStyle:"italic",children:e})]})}},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},46055:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var i=r(31658);let n=async e=>[{type:"image/x-icon",sizes:"305x298",url:(0,i.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},48859:(e,t,r)=>{"use strict";r.d(t,{g:()=>n});var i=r(43210);let n=()=>{let[e,t]=(0,i.useState)(!1),[r,n]=(0,i.useState)(0),[s,a]=(0,i.useState)(!0),[l,o]=(0,i.useState)(""),[c,d]=(0,i.useState)(!1);return{loading:e,setLoading:t,completed:r,setCompleted:n,showForm:s,setShowForm:a,message:l,setMessage:o,error:c,setError:d}}},55330:(e,t,r)=>{"use strict";r.d(t,{iE:()=>n,Zt:()=>d,iL:()=>c,f6:()=>l,gX:()=>o,ZM:()=>u,k$:()=>p}),r(96851);var i=r(77567);let n=({title:e,text:t,icon:r,onConfirm:n,confirmButtonText:s,cancelButtonText:a="Cancel"})=>{i.A.fire({title:e,text:t,icon:r,showCancelButton:!0,confirmButtonColor:"#006401",confirmButtonText:s,cancelButtonText:a}).then(e=>{e.isConfirmed&&n()})};var s=r(42938),a=r(88794);let l=e=>Object.keys(e).reduce((t,r)=>(t[e[r].name]="",t),{}),o=(e,t)=>Object.keys(e).map(r=>({concept:r,value:e[r],obsDatetime:t})),c=(e,t,r)=>{let i=Object.keys(e).map(t=>({concept:e[t].name,label:e[t].label})),n=t.map(e=>({concept:e.id,label:e.label}));return[...i,...r.map(e=>({concept:e.value,label:e.label})),...n]},d=async e=>(await a.Fh.initialize(),e.map(e=>({concept:s.W.IMAGE_PART_NAME,value:e.label,obsDateTime:a.Fh.getServerTimeString(),groupMembers:e.formData.obs}))),u=(e,t,r,i=!1)=>Array.isArray(e)?e.map(e=>({concept:t,value:e.id,obsDatetime:r})):[],p=async(e,t,r)=>(await a.Fh.initialize(),Object.entries(t).map(([t,i])=>{let n=Object.keys(e).find(r=>e[r].name===t);if(!n)return null;let s=e[n].name,l=e[n].coded;return Array.isArray(i)&&i.every(e=>e&&void 0!==e.id)?i.map(e=>({key:s,value:e.id,coded:l})):{concept:s,value:i,coded:l,obsDatetime:r||a.Fh.getServerTimeString()}}).flat().filter(Boolean))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56317:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/pk/App/hwis/aetc/app/prescreening/[id]/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/pk/App/hwis/aetc/app/prescreening/[id]/page.tsx","default")},59324:(e,t,r)=>{Promise.resolve().then(r.bind(r,56317))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},76831:(e,t,r)=>{"use strict";r.d(t,{X:()=>s});var i=r(62116),n=r(29494);let s=e=>{let t=async()=>{let t=await (0,i.P$)(e);return t.data?.length?t.data[0].set_members.map(({names:e})=>({name:e[0]?.name||"Unknown",uuid:e[0]?.uuid||"N/A"})):[]};return(0,n.I)({queryKey:[e],queryFn:t,enabled:!!e})}},77575:(e,t,r)=>{"use strict";r.d(t,{j:()=>a});var i=r(60687),n=r(75018),s=r(30474);let a=({error:e,onPrimaryAction:t,onSecondaryAction:r})=>(0,i.jsxs)(n.jD,{sx:{display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center"},children:[(0,i.jsx)(s.default,{width:150,height:150,src:"/error.png",alt:"error"}),(0,i.jsx)("br",{}),(0,i.jsxs)(n.Th,{variant:"body2",children:["Error occurred whilst ",(0,i.jsx)("strong",{children:e})]}),(0,i.jsx)("br",{}),(0,i.jsxs)(n.jD,{sx:{display:"flex"},children:[(0,i.jsx)(n.O6,{onClick:t,title:"retry",sx:{mr:"0.5ch"}}),(0,i.jsx)(n.O6,{onClick:r,title:"cancel",variant:"secondary"})]})]})},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},85121:(e,t,r)=>{"use strict";r.d(t,{V:()=>l});var i=r(60687),n=r(61939),s=r(75018),a=r(89061);let l=({title:e,link:t})=>{let{navigateTo:r}=(0,n.cq)(),l={fontFamily:"Inter",fontSize:"14px",fontWeight:400,lineHeight:"21px",letterSpacing:"0em",textAlign:"center",mx:"1ch"};return(0,i.jsxs)(s.jD,{sx:{display:"flex",justifyContent:"space-evenly",py:"1ch",borderBottom:"solid 1px #E6E6E6"},children:[(0,i.jsxs)(s.jD,{onClick:()=>r(t),sx:{display:"flex",cursor:"pointer"},children:[(0,i.jsx)(s.Th,{children:(0,i.jsx)(a.oWm,{})}),(0,i.jsx)(s.Th,{sx:l,children:"Go back"})]}),(0,i.jsx)(s.Th,{sx:l,children:e}),(0,i.jsxs)(s.jD,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(a.M4e,{}),(0,i.jsx)(s.Th,{sx:l,children:"Need any help?"})]})]})}},93251:(e,t,r)=>{"use strict";r.d(t,{n:()=>o});var i=r(60687),n=r(28274),s=r(78590),a=r(89061),l=r(75018);function o({title:e,primaryActionText:t,secondaryActionText:r,onPrimaryAction:o,onSecondaryAction:c,printButton:d}){return(0,i.jsx)(n.default,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",children:(0,i.jsxs)(n.default,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,i.jsx)(s.default,{variant:"h1",color:"green",children:(0,i.jsx)(a.cxC,{})}),(0,i.jsx)(s.default,{variant:"h5",fontWeight:"500",children:e}),(0,i.jsxs)(n.default,{mt:"2ch",sx:{display:"flex"},children:[(0,i.jsx)(l.O6,{onClick:o,title:t}),(0,i.jsx)(l.O6,{variant:"secondary",sx:{ml:"0.5ch"},onClick:c,title:r}),d]})]})})}},94735:e=>{"use strict";e.exports=require("events")},95602:(e,t,r)=>{"use strict";r.d(t,{O:()=>p});var i=r(60687),n=r(43210),s=r(75018),a=r(30485),l=r(55330),o=r(42938),c=r(7304);let d={referred:{name:o.W.IS_PATIENT_REFERRED,label:"Is the patient referred?"},urgent:{name:o.W.IS_SITUATION_URGENT,label:" Is the situation urgent?"},Referred:{name:o.W.PATIENT_REFERRED_TO,label:"Patient Referred to"}},u=a.Ik({[d.referred.name]:a.Yj().required().label(d.referred.label),[d.urgent.name]:a.Yj().required().label(d.urgent.label),[d.Referred.name]:a.Yj().label(d.Referred.label)});function p({onSubmit:e}){let{serviceAreaOptions:t}=(0,c.C)(),[r,a]=(0,n.useState)({}),p=[{label:"Yes",value:o._Y},{label:"No",value:o.NO}],x=t.map(e=>({id:e.label,label:e.label})),m=r[d.referred.name]==o._Y?x:x.filter(e=>"OPD 2"!==e.id);return(0,i.jsxs)(s.PD,{validationSchema:u,initialValues:(0,l.f6)(d),onSubmit:e,children:[(0,i.jsx)(s.fP,{getValues:a}),(0,i.jsxs)(s.Vp,{children:[(0,i.jsx)(s.b1,{name:d.referred.name,label:d.referred.label,options:p}),(0,i.jsx)(s.b1,{name:d.urgent.name,label:d.urgent.label,options:[...p,{label:"Elective",value:o.W.ELECTIVE}]})]}),r[d.urgent.name]==o.NO&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("br",{}),(0,i.jsx)(s.el,{name:d.Referred.name,label:d.Referred.label,options:m,multiple:!1,sx:{mr:"1ch"}})]}),(r[d.urgent.name]==o._Y||r[d.urgent.name]==o.W.ELECTIVE)&&(0,i.jsx)(s.bL,{message:"Proceed with registration"})]})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[4447,6724,346,1658,485,7567,1146],()=>r(11162));module.exports=i})();