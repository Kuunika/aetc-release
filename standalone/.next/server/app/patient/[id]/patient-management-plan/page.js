(()=>{var e={};e.id=3328,e.ids=[3328],e.modules={2844:(e,t,i)=>{Promise.resolve().then(i.bind(i,83123))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19194:(e,t,i)=>{"use strict";i.d(t,{q:()=>S});var r=i(60687);i(43210);var a=i(24857),n=i(68730),l=i(2351),o=i(7850),s=i(69612),u=i(27621),d=i(71953),c=i(12040),p=i(58706),m=i(109);let h=(0,m.Ay)(a.A)(({theme:e})=>({borderRadius:e.shape.borderRadius,overflow:"auto",maxHeight:"400px",minHeight:"95px",boxShadow:e.shadows[3],position:"relative"})),A=(0,m.Ay)(n.A)(({theme:e})=>({borderCollapse:"separate",borderSpacing:"0px 4px"})),I=(0,m.Ay)(l.A)(({theme:e})=>({fontWeight:500,padding:"12px 16px",borderBottom:"none",color:e.palette.text.primary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"200px"})),b=(0,m.Ay)(I)(({theme:e})=>({fontSize:"0.9rem",fontWeight:"bold",backgroundColor:e.palette.background.default,textTransform:"uppercase"})),f=(0,m.Ay)(o.A)(({theme:e})=>({backgroundColor:"#fff",borderRadius:"8px",transition:"background 0.2s ease-in-out","&:hover":{backgroundColor:e.palette.grey[100]},boxShadow:e.shadows[1]})),E=(0,m.Ay)("div")(({theme:e})=>({display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:1})),S=({columns:e,data:t,actions:i=!1,getSelectedRow:a,loading:n=!1})=>(0,r.jsx)(h,{children:(0,r.jsxs)(A,{stickyHeader:!0,children:[(0,r.jsx)(s.A,{children:(0,r.jsxs)(o.A,{children:[e.map((e,t)=>(0,r.jsx)(b,{children:e.label},t)),i&&(0,r.jsx)(b,{children:"Actions"})]})}),(0,r.jsx)(u.A,{children:n?(0,r.jsx)(o.A,{children:(0,r.jsx)(l.A,{colSpan:e.length+ +!!i,children:(0,r.jsx)(E,{children:(0,r.jsx)(d.A,{})})})}):t.map((t,n)=>(0,r.jsxs)(f,{onClick:()=>a&&a(t),children:[e.map((e,i)=>(0,r.jsx)(c.A,{title:t[e.field],arrow:!0,children:(0,r.jsx)(I,{children:t[e.field]})},i)),i&&(0,r.jsxs)(I,{children:[(0,r.jsx)(p.default,{"aria-label":"edit",color:"primary",size:"small"}),(0,r.jsx)(p.default,{"aria-label":"delete",color:"secondary",size:"small"})]})]},n))})]})})},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35009:(e,t,i)=>{"use strict";i.d(t,{M:()=>d});var r=i(60687),a=i(43210),n=i(92438),l=i(38963),o=i(22286),s=i(78590),u=i(89061);function d({sections:e}){let[t,i]=a.useState(!1),d=e=>(t,r)=>{i(!!r&&e)};return(0,r.jsx)("div",{children:e.map(({id:e,title:i,content:a})=>(0,r.jsxs)(n.A,{expanded:t===e,onChange:d(e),children:[(0,r.jsx)(o.A,{expandIcon:(0,r.jsx)(u.Odn,{}),"aria-controls":`${e}-content`,id:`${e}-header`,children:(0,r.jsx)(s.default,{sx:{width:"33%",flexShrink:0,fontWeight:600},children:i})}),(0,r.jsx)(l.A,{children:a})]},e))})}},43866:(e,t,i)=>{"use strict";i.d(t,{u9:()=>p,wt:()=>I});var r=i(60687),a=i(75018),n=i(43210),l=i(30485),o=i(42938),s=i(62116),u=i(61939),d=i(76990),c=i(44504);let p={procedures:{name:o.W.PROCEDURES,label:"Procedures",type:"string",hasGroupMembers:!0,children:[{concept:o.W.OTHER,label:"Other (Specify)"}]},supportiveCare:{name:o.W.SUPPORTIVE_CARE,label:"Supportive Care",type:"string",hasGroupMembers:!0,children:[{concept:o.W.OTHER,label:"Other (Specify)"}]}},m=[{value:o.W.MINOR_SURGERY,label:"Minor Surgery"},{value:o.W.SUTURING,label:"Suturing"},{value:o.W.JOINT_REDUCTION,label:"Joint Reduction"},{value:o.W.FRACTURE_REDUCTION,label:"Fracture Reduction"},{value:o.W.INTERCOSTAL_DRAIN_INSERTION,label:"Intercostal Drain Insertion"},{value:o.W.PLEUROCENTESIS,label:"Pleurocentesis"},{value:o.W.PERICARDIOCENTESISI,label:"Pericardiocentesis"},{value:o.W.PARACENTESISI,label:"Paracentesis"},{value:o.W.LUMBER_PUNCTURE,label:"Lumbar Puncture"},{value:o.W.INTRAVENOUS_CANNULATION,label:"Intravenous Cannulation"},{value:o.W.CENTRAL_LINE_INSERTION,label:"Central Line Insertion"},{value:o.W.CATHETERIZATION_URETHRAL,label:"Urethral Catheterization"},{value:o.W.CATHETERIZATION_SUPRAPUBIC,label:"Suprapubic Catheterization"},{value:o.W.SUCTIONING,label:"Suctioning"},{value:o.W.OROPHARYNGEAL_AIRWAY_INSERTION,label:"Oropharyngeal Airway Insertion"},{value:o.W.NASOPHARYNGEAL_AIRWAY_INSERTION,label:"Nasopharyngeal Airway Insertion"},{value:o.W.LARYNGEAL_MASK_AIRWAY_INSERTION,label:"Laryngeal Mask Airway Insertion"},{value:o.W.ENDOTRACHEAL_TUBE_INSERTION,label:"Endotracheal Tube Insertion"},{value:o.W.NASOGASTRIC_TUBE_INSERTION,label:"Nasogastric Tube Insertion"},{value:o.W.MANUAL_VENTILATION,label:"Manual Ventilation"},{value:o.W.CONTINUOUS_POSITIVE_AIRWAY_PRESSURE,label:"Continuous Positive Airway Pressure (CPAP)"},{value:o.W.OTHER,label:"Other (Specify)"}],h=[{value:o.W.WOUND_DRESSING,label:"Wound Dressing"},{value:o.W.PATIENT_EDUCATION,label:"Patient Education"},{value:o.W.COUNSELLING,label:"Counselling"},{value:o.W.FEEDING,label:"Feeding"},{value:o.W.OXYGENATION,label:"Oxygenation"},{value:o.W.TEPID_SPONGING,label:"Tepid Sponging"},{value:o.W.ELECTROCARDIOGRAPHY_MONITORING,label:"Electrocardiography (ECG) Monitoring"},{value:o.W.TURNING_PATIENTS,label:"Turning Patients"},{value:o.W.ORAL_CARE,label:"Oral Care"},{value:o.W.OTHER,label:"Other (Specify)"}],A=l.Ik().shape({procedures:l.YO().of(l.Ik().shape({key:l.Yj().required(),value:l.zM().required()})).transform(e=>Array.isArray(e)?e.filter(e=>!0===e.value):[]).min(1,"At least one procedure must be selected"),otherProcedureSpecify:l.Yj().nullable().when("procedures",{is:e=>e.some(e=>e.key===o.W.OTHER),then:e=>e.required("Please specify the other procedure")}),supportiveCare:l.YO().of(l.Ik().shape({key:l.Yj().required(),value:l.zM().required()})).transform(e=>Array.isArray(e)?e.filter(e=>!0===e.value):[]).min(1,"At least one supportive care option must be selected"),otherSupportiveCareSpecify:l.Yj().nullable().when("supportiveCare",{is:e=>e.some(e=>e.key===o.W.OTHER),then:e=>e.required("Please specify the other supportive care")})}),I=({onSubmit:e,onSkip:t})=>{let[i,l]=(0,n.useState)({}),[p,I]=(0,n.useState)({otherProcedure:!1,otherSupportiveCare:!1}),{params:b}=(0,u.KU)(),{mutate:f}=(0,s.jM)(),{data:E}=(0,d.iu)(b.id),[S,x]=(0,n.useState)(void 0),{init:v,ServerTime:O}=(0,c.useServerTime)();(0,n.useEffect)(()=>{if(E){let e=E.find(e=>!e.date_stopped);e&&x(e)}},[E]);let T=async t=>{console.log("Procedures Selected:",t.procedures),console.log("Supportive Care Selected:",t.supportiveCare);let i=O.getServerTimeString(),r=[{concept:o.W.PROCEDURES,value:o.W.PROCEDURES,obsDatetime:i,groupMembers:(t.procedures||[]).filter(e=>!0===e.value).map(e=>({concept:e.key,value:e.key===o.W.OTHER?t.otherProcedureSpecify:e.key,obsDatetime:i}))},{concept:o.W.SUPPORTIVE_CARE,value:o.W.SUPPORTIVE_CARE,obsDatetime:i,groupMembers:(t.supportiveCare||[]).filter(e=>!0===e.value).map(e=>({concept:e.key,value:e.key===o.W.OTHER?t.otherSupportiveCareSpecify:e.key,obsDatetime:i}))}],a={encounterType:o.fA.NON_PHARMACOLOGICAL,visit:S?.uuid,patient:b.id,encounterDatetime:i,obs:r};try{await f(a),e(t)}catch(e){console.error("Error submitting Non-Pharmacological form: ",e)}};return(0,r.jsxs)(a.PD,{validationSchema:A,initialValues:{procedures:[],supportiveCare:[],otherProcedureSpecify:"",otherSupportiveCareSpecify:""},onSubmit:T,children:[(0,r.jsx)(a.fP,{getValues:l}),(0,r.jsxs)(a.GE,{direction:"row",children:[(0,r.jsxs)(a.jD,{sx:{bgcolor:"white",padding:"2ch",mb:"2ch",width:"100%"},children:[(0,r.jsx)("h4",{children:"Procedures"}),(0,r.jsx)(a.Z3,{name:"procedures",allowFilter:!1,options:m,getValue:e=>I(t=>({...t,otherProcedure:e.some(e=>e.key===o.W.OTHER&&e.value)}))}),p.otherProcedure&&(0,r.jsx)(a.A8,{id:"otherProcedureSpecify",label:"Specify Other Procedure",name:"otherProcedureSpecify",placeholder:"Specify the procedure"})]}),(0,r.jsxs)(a.jD,{sx:{bgcolor:"white",padding:"2ch",mb:"2ch",width:"100%"},children:[(0,r.jsx)("h4",{children:"Supportive Care"}),(0,r.jsx)(a.Z3,{name:"supportiveCare",allowFilter:!1,options:h,getValue:e=>I(t=>({...t,otherSupportiveCare:e.some(e=>e.key===o.W.OTHER&&e.value)}))}),p.otherSupportiveCare&&(0,r.jsx)(a.A8,{id:"otherSupportiveCareSpecify",label:"Specify Other Supportive Care",name:"otherSupportiveCareSpecify",placeholder:"Specify the care"})]})]})]})}},46055:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var r=i(31658);let a=async e=>[{type:"image/x-icon",sizes:"305x298",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},54268:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>D});var r=i(60687),a=i(75018),n=i(42938),l=i(77391),o=i(43210),s=i(62085),u=i(30485),d=i(28274),c=i(63705),p=i(13923),m=i(28142),h=i(62116),A=i(61939),I=i(60931),b=i(62764),f=i(35009),E=i(41512),S=i(44504);let x={name:"",formulation:"",medication_dose:0,medication_dose_unit:"",medication_frequency:"",medication_duration:0,medication_duration_unit:""},v={medications:[x]},O=[{id:n.W.TABLET,label:"Tablet"},{id:n.W.VIAL,label:"Vial"},{id:n.W.INTRAVENOUS,label:"Intravenous"},{id:n.W.POWDER,label:"Powder"},{id:n.W.SOLUTION,label:"Solution"},{id:n.W.EYE_OINTMENT,label:"Eye Ointment"},{id:n.W.CREAM,label:"Cream"},{id:n.W.EYE_DROPS,label:"Eye Drops"},{id:n.W.OINTMENT,label:"Ointment"},{id:n.W.INHALER,label:"Inhaler"},{id:n.W.SUPPOSITORY,label:"Suppository"},{id:n.W.PESSARY,label:"Pessary"},{id:n.W.SUSPENSION,label:"Suspension"},{id:n.W.SHAMPOO,label:"Shampoo"},{id:n.W.EAR_DROPS,label:"Ear Drops"},{id:n.W.EYE_PASTE,label:"Eye Paste"}],T=[{id:"STAT",label:"STAT"},{id:n.W.ONCE_A_DAY,label:"24 Hourly (OD) - Once a day "},{id:n.W.TWICE_A_DAY,label:"12 Hourly (BID) - Twice a day"},{id:n.W.THREE_TIMES_A_DAY,label:"8 Hourly (TID) - Three times a day"},{id:n.W.FOUR_TIMES_A_DAY,label:"6 Hourly (QID) - Four times a day"},{id:n.W.SIX_TIMES_A_DAY,label:"4 Hourly (OD) - Six times a day "},{id:n.W.ONCE_A_WEEK,label:"Once a week"},{id:n.W.ONCE_A_MONTH,label:"Once a month"},{id:n.W.MORNING,label:"Morning"},{id:n.W.EVENING,label:"Evening"},{id:n.W.OTHER,label:"Other"}],N=u.Ik().shape({medications:u.YO().of(u.Ik().shape({name:u.Yj().required("Medication name is required"),formulation:u.Yj().required("Formulation is required"),medication_dose:u.ai().required("Dose is required").positive("Dose must be greater than 0"),medication_dose_unit:u.Yj().required("Dose unit is required"),medication_frequency:u.Yj().required("Frequency is required"),medication_duration:u.ai().required("Duration is required").positive("Duration must be greater than 0"),medication_duration_unit:u.Yj().required("Duration unit is required"),medication_date_last_taken:u.p6().nullable().required("Date of last taken is required"),medication_date_of_last_prescription:u.p6().nullable().required("Date of last prescription is required")}))}),_=["Milligrams (mg)","Micrograms (\xb5g)","Grams (g)","International Units (IU)","Milliliters (ml)","Millimoles (mmol)"],g=({onSubmit:e,onSkip:t,encounterType:i=n.fA.PRESCRIPTIONS,onSubmissionSuccess:l,medicationTitle:u="Prescribed Medication",medicationLabelTitle:g})=>{let{ServerTime:C}=(0,S.useServerTime)(),{mutate:R,isPending:y,isSuccess:W}=(0,h.jM)(),{medicationOptions:j,loadingDrugs:P}=(0,E.A)(),[D,U]=(0,o.useState)({}),[M,q]=(0,o.useState)({medications:[]}),{activeVisit:w,patientId:k}=(0,A.gd)(),F=(e,t)=>{U(i=>({...i,[e]:t}))};(0,o.useEffect)(()=>{W&&l()},[W]);let H=()=>{let e=C.getServerTimeString(),t=M.medications.map(t=>({concept:n.W.DRUG_GIVEN,value:t.name,obsDateTime:e,groupMembers:[{concept:n.W.MEDICATION_FORMULATION,value:t.formulation,obsDateTime:e},{concept:n.W.MEDICATION_DOSE,value:t.medication_dose,obsDateTime:e},{concept:n.W.MEDICATION_DOSE_UNIT,value:t.medication_dose_unit,obsDateTime:e},{concept:n.W.MEDICATION_FREQUENCY,value:t.medication_frequency,obsDateTime:e},{concept:n.W.MEDICATION_DURATION,value:t.medication_duration,obsDateTime:e},{concept:n.W.MEDICATION_DURATION_UNIT,value:t.medication_duration_unit,obsDateTime:e},{concept:n.W.DESCRIPTION,value:"current",obsDateTime:e}]}));R({encounterType:i,visit:w,patient:k,encounterDatetime:e,obs:t})},Y=[{id:"prescribed",title:u,content:(0,r.jsx)(b.Z,{medicationLabelTitle:g,encounterType:i})}];return(0,r.jsxs)(I.h,{loading:y||P,children:[(0,r.jsx)(f.M,{sections:Y}),(0,r.jsx)("br",{}),(0,r.jsx)(a.PD,{initialValues:v,validationSchema:N,onSubmit:e,enableReinitialize:!0,submitButton:!1,children:({values:e,setFieldValue:t})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.fP,{getValues:q}),(0,r.jsx)(s.ED,{name:"medications",children:({push:i,remove:l})=>(0,r.jsx)(c.A,{items:e.medications,setItems:e=>t("medications",e),newItem:x,renderFields:(e,i)=>(0,r.jsxs)(d.default,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[(0,r.jsx)(a.el,{name:`medications[${i}].name`,label:"Medication Name",options:j,getValue:e=>t(`medications[${i}].name`,e),multiple:!1}),(0,r.jsx)(a.el,{name:`medications[${i}].formulation`,label:"Formulation",options:O,getValue:e=>t(`medications[${i}].formulation`,e),sx:{flex:1},multiple:!1}),(0,r.jsx)(a.pj,{id:`medications[${i}].medication_dose`,label:"Dose",name:`medications[${i}].medication_dose`,unitName:`medications[${i}].medication_dose_unit`,unitOptions:_,placeholder:"e.g., 500",inputIcon:(0,r.jsx)(m.gaX,{})}),D[i]?(0,r.jsx)(a.A8,{id:`medications[${i}].medication_frequency`,name:`medications[${i}].medication_frequency`,label:"Specify frequency",sx:{flex:1}}):(0,r.jsx)(a.el,{name:`medications[${i}].medication_frequency`,label:"Frequency",options:T,getValue:e=>{"Other"===e&&F(i,!0),t(`medications[${i}].medication_frequency`,e)},multiple:!1}),M?.medications[i]?.medication_frequency!="STAT"&&(0,r.jsx)(a.pj,{id:`medications[${i}].medication_duration`,name:`medications[${i}].medication_duration`,unitName:`medications[${i}].medication_duration_unit`,label:"Duration",unitOptions:n.bH,placeholder:"e.g. 7",inputIcon:(0,r.jsx)(p.YmN,{}),sx:{flex:1}})]})})}),(0,r.jsx)(a.jD,{sx:{mt:"2ch"},children:(0,r.jsx)(a.O6,{sx:{m:.5},title:"Submit",type:"submit",onClick:H})})]})})]})};var C=i(43866),R=i(76990);n.W.GYNAE_BENCH,n.W.SURGICAL_BENCH,n.W.MEDICAL_BENCH,n.W.SHORT_STAY,n.W.ISOLATION,n.W.TRAUMA,n.W.RESUSCITATION,n.W.PRIORITY;let y=[{value:n.W.GYNAE_BENCH,label:n.W.GYNAE_BENCH},{value:n.W.SURGICAL_BENCH,label:n.W.SURGICAL_BENCH},{value:n.W.MEDICAL_BENCH,label:n.W.MEDICAL_BENCH},{value:n.W.SHORT_STAY,label:n.W.SHORT_STAY},{value:n.W.ISOLATION,label:n.W.ISOLATION},{value:n.W.TRAUMA,label:n.W.TRAUMA},{value:n.W.RESUSCITATION,label:n.W.RESUSCITATION},{value:n.W.PRIORITY,label:n.W.PRIORITY}],W=u.Ik().shape({careArea:u.Yj().required("Please select a patient care area.")}),j=({onSubmit:e,onSkip:t})=>{let[i,l]=(0,o.useState)({}),{params:s}=(0,A.KU)(),{mutate:u}=(0,h.jM)(),{data:d}=(0,R.iu)(s.id),[c,p]=(0,o.useState)(void 0),{init:m,ServerTime:I}=(0,S.useServerTime)();(0,o.useEffect)(()=>{if(d){let e=d.find(e=>!e.date_stopped);e&&p(e)}},[d]);let b=async t=>{let i=I.getServerTimeString(),r=[{concept:n.W.CARE_AREA,value:t.careArea,obsDatetime:i}],a={encounterType:n.fA.PATIENT_CARE_AREA,visit:c?.uuid,patient:s.id,encounterDatetime:i,obs:r};try{await u(a),e(t)}catch(e){console.error("Error submitting Patient Care Area: ",e)}};return(0,r.jsxs)(a.PD,{validationSchema:W,initialValues:{careArea:"",otherCareAreaSpecify:""},onSubmit:b,children:[(0,r.jsx)(a.fP,{getValues:l}),(0,r.jsx)(a.kI,{title:"Patient Care Area",children:(0,r.jsx)(a.jD,{sx:{bgcolor:"white",padding:"2ch",mb:"2ch",width:"100%"},children:(0,r.jsx)(a.b1,{row:!0,options:y,name:"careArea",label:"Select Patient Care Area"})})})]})},P=()=>{let[e,t]=(0,o.useState)(0),{navigateBackToProfile:i,navigateBack:n}=(0,A.cq)();return(0,o.useEffect)(()=>{console.log(`Active step is now: ${e}`)},[e]),(0,r.jsxs)(a.RG,{title:"Patient Management Plan",steps:[{id:1,label:"Non-Pharmacological"},{id:2,label:"Patient Care Area"},{id:3,label:"Medication"}],active:e,setActive:t,onBack:()=>i(),children:[(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(C.wt,{onSkip:()=>{},onSubmit:()=>t(1)})}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(j,{onSkip:()=>{},onSubmit:()=>t(2)})}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g,{onSubmissionSuccess:n,onSkip:()=>{},onSubmit:()=>{}})})]})},D=(0,l.A)(function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.TF,{}),(0,r.jsx)(a.MG,{children:(0,r.jsx)(P,{})})]})},[n.Ot.CLINICIAN,n.Ot.NURSE,n.Ot.ADMIN,n.Ot.STUDENT_CLINICIAN])},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},60931:(e,t,i)=>{"use strict";i.d(t,{h:()=>l});var r=i(60687),a=i(28274),n=i(71953);let l=({loading:e,children:t,height:i="100%"})=>(0,r.jsxs)(a.default,{sx:{position:"relative",width:"100%",height:i},children:[e&&(0,r.jsx)(a.default,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:1},children:(0,r.jsx)(n.A,{})}),(0,r.jsx)(a.default,{sx:{opacity:e?.5:1,pointerEvents:e?"none":"auto"},children:t})]})},60988:(e,t,i)=>{Promise.resolve().then(i.bind(i,54268))},62764:(e,t,i)=>{"use strict";i.d(t,{Z:()=>h});var r=i(60687),a=i(60931),n=i(19194),l=i(42938),o=i(48807),s=i(94482),u=i(99108),d=i(61939),c=i(62116),p=i(50772),m=i(43210);let h=({setRow:e,encounterType:t=l.fA.PRESCRIPTIONS,medicationLabelTitle:i,showPrintButton:h=!0})=>{let{patientId:A,activeVisitId:I}=(0,d.gd)(),{setZpl:b,setOpen:f}=(0,o.m)(),{selectedVisit:E}=(0,s.E)(),{data:S,isPending:x}=(0,c.$O)(A,`encounter_type=${t}&visit=${E?.uuid}`),[v,O]=(0,m.useState)([]),T=(e,t)=>e?.children?.find(e=>e.names&&e.names[0].name==t)?.value;return(0,m.useEffect)(()=>{let e=S?.filter(e=>e.visit_id==Number(I));if(!e||0==e.length)return void O([]);O(e[0]?.obs.filter(e=>e?.names&&e?.names[0].name==l.W.DRUG_GIVEN).map(e=>{let t=T(e,l.l8.MEDICATION_DURATION_UNIT),i=T(e,l.W.MEDICATION_DOSE),r=T(e,l.l8.DESCRIPTION),a=T(e,l.l8.MEDICATION_FORMULATION),n=T(e,l.l8.MEDICATION_DOSE_UNIT),o=T(e,l.l8.MEDICATION_FREQUENCY),s=T(e,l.l8.MEDICATION_DURATION)+" "+t,u=e.value_coded_uuid;return{medicationName:e.value,durationUnit:t,dose:i,doseUnits:n,frequency:o,duration:s,formulation:a,description:r,prescribedBy:e.created_by,medicationUUID:u}}).filter(e=>"current"==e.description))},[S]),(0,r.jsxs)(a.h,{loading:x,children:[h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.A,{onClick:()=>{let e=(0,u.B)(v,i);f(e),b(e)},variant:"contained",children:"Print Medications"}),(0,r.jsx)("br",{})]}),(0,r.jsx)(n.q,{getSelectedRow:e,columns:[{label:"Medication Name",field:"medicationName"},{label:"Dose",field:"dose"},{label:"Frequency",field:"frequency"},{label:"Duration",field:"duration"},{label:"Formulation",field:"formulation"},{label:"Prescriber",field:"prescribedBy"}],data:v})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},77391:(e,t,i)=>{"use strict";i.d(t,{A:()=>c});var r=i(60687),a=i(23641),n=i(61939),l=i(43210),o=i(41930),s=i(75018),u=i(30474),d=i(87748);function c(e,t){return function(i){let[s,u]=(0,l.useState)(!1),{navigateTo:c}=(0,n.cq)(),m=(0,o.R)(t,(0,d.O)());return s?m?(0,r.jsx)(e,{...i}):(0,r.jsx)(p,{}):(0,r.jsx)(a.OverlayLoader,{open:!s})}}let p=()=>(0,r.jsx)(s.jD,{sx:{width:"100%",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff"},children:(0,r.jsx)(u.default,{src:"/403.jpg",height:500,width:500,alt:"403"})})},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},82474:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>l.a,__next_app__:()=>c,pages:()=>d,routeModule:()=>p,tree:()=>u});var r=i(65239),a=i(48088),n=i(88170),l=i.n(n),o=i(30893),s={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>o[e]);i.d(t,s);let u={children:["",{children:["patient",{children:["[id]",{children:["patient-management-plan",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,83123)),"/Users/pk/App/hwis/aetc/app/patient/[id]/patient-management-plan/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(i.bind(i,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(i.bind(i,20800)),"/Users/pk/App/hwis/aetc/app/layout.tsx"],error:[()=>Promise.resolve().then(i.bind(i,52608)),"/Users/pk/App/hwis/aetc/app/error.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(i.t.bind(i,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(i.t.bind(i,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(i.bind(i,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/pk/App/hwis/aetc/app/patient/[id]/patient-management-plan/page.tsx"],c={require:i,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/patient/[id]/patient-management-plan/page",pathname:"/patient/[id]/patient-management-plan",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},83123:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});let r=(0,i(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/pk/App/hwis/aetc/app/patient/[id]/patient-management-plan/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/pk/App/hwis/aetc/app/patient/[id]/patient-management-plan/page.tsx","default")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")},99108:(e,t,i)=>{"use strict";function r({presentingComplaints:e,diagnosis:t,labOrders:i,dischargeNotes:r,dischargePlan:a,followUpPlan:n,homeCareInstructions:l}){let o=e=>Math.round(203*e/25.4),s=o(100),u=o(40),d=s-40,c=Math.floor(d/8),p=[{title:"Discharge Notes",content:r||"N/A"},{title:"Investigations",content:i.length?i.flatMap(e=>e.tests.map(e=>`${e.name}:${e.result||"pending"}`)).join(" ! "):"No investigations ordered"},{title:"Final Diagnosis",content:t?.length?t.map(e=>e.value).join(" ! "):"None"},{title:"Discharge Plan",content:a||"N/A"},{title:"Follow Up Plan",content:`${n}`||"N/A"},{title:"Home Care Instructions",content:l||"N/A"}],m=[];p.forEach((e,t)=>{m.push({text:e.title,isTitle:!0,sectionIndex:t}),(function(e){if(!e)return[];let t=e.split(" "),i=[],r="";for(let e of t){if(e.length>c){r&&(i.push(r),r="");for(let t=0;t<e.length;t+=c){let r=e.substring(t,t+c);i.push(r)}continue}let t=r?`${r} ${e}`:e;t.length<=c?r=t:(r&&i.push(r),r=e)}return r&&i.push(r),i})(e.content).forEach(e=>{m.push({text:e,isTitle:!1,sectionIndex:t})})});let h=[],A=[],I=70;for(let e=0;e<m.length;e++){let t=m[e],i=0;if(A.length>0){let e=A[A.length-1];t.sectionIndex!==e.sectionIndex&&(i=10)}let r=i+(t.isTitle?30:25);if(I+r>u-20){if(0===A.length){A.push(t),h.push(A),A=[],I=20;continue}h.push(A),A=[],I=20,e--;continue}A.push(t),I+=r}return A.length>0&&h.push(A),h.map((e,t)=>{let i=20,r=`^XA
^PW${s}
^LL${u}
^CF0,25`;0===t?(r+=`
^FO20,20^FDPatient Summary-QECH AETC^FS
^FO20,60^GB${d},3,3^FS`,i=70):i=20;let a=-1;for(let t of e)t.sectionIndex!==a&&(-1!==a&&(i+=10),a=t.sectionIndex),t.isTitle?(r+=`
^CF0,25
^FO20,${i}^FD${t.text}^FS`,i+=30):(r+=`
^CF0,20
^FO20,${i}^FD${t.text}^FS`,i+=25);return r+`
^XZ`}).join("\n")}function a(e,t="Medication Instructions"){let i=Math.floor(68.21428571428571),r=[],n=[],l=0,o=1;function s(e,i){let r=`^XA
^CF0,25
^FO30,30^${t}${i>1?` (Cont. ${i})`:""}^FS
^FO30,60^GB955,3,3^FS
`,a=68;for(let t of e){for(let e of t)r+=`^FO30,${a}^FD${e}^FS
`,a+=20;a+=10}return r+"^XZ"}return e.forEach(e=>{let t=function(e){let t=e.split(" "),r=[],a="";for(let e of t)(a+" "+e).trim().length<=i?a=(a+" "+e).trim():(r.push(a),a=e);return a&&r.push(a),r}(function(e,t){let i=[e.medicationName,`${e.dose} ${e.doseUnits}`,e.frequency,e.duration,e.formulation,`(${e.prescribedBy})`].filter(Boolean).map(e=>e.replace(/[\\^]/g,""));return`${t}. ${i.join(" | ")}`}(e,o)),a=20*t.length+10;l+a>323&&(r.push(s(n,r.length+1)),n=[],l=0),n.push(t),l+=a,o++}),n.length&&r.push(s(n,r.length+1)),r.join("\n")}i.d(t,{B:()=>a,U:()=>r})}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[4447,6724,346,1658,485,8142,1146],()=>i(82474));module.exports=r})();