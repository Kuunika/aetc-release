"use strict";exports.id=7332,exports.ids=[7332],exports.modules={7304:(e,i,a)=>{a.d(i,{C:()=>n});var t=a(43210),l=a(76831);let n=()=>{let{data:e,isLoading:i}=(0,l.X)("Service areas"),[a,n]=(0,t.useState)([]);return(0,t.useEffect)(()=>{if(e){let i=e.map(e=>({label:e.name,id:e.uuid}));n(i),i.find(e=>"Other"===e.label)}},[e]),{serviceAreaOptions:a,serviceAreaLoading:i,serviceAreas:e}}},29702:(e,i,a)=>{a.d(i,{a:()=>f});var t=a(60687),l=a(75018),n=a(43210),s=a(62085),o=a(30485),r=a(28274),c=a(63705),d=a(13923),m=a(28142),u=a(42938),p=a(62116),b=a(61939),h=a(60931),_=a(62764),E=a(35009),S=a(41512),A=a(44504);let I={name:"",formulation:"",medication_dose:0,medication_dose_unit:"",medication_frequency:"",medication_duration:0,medication_duration_unit:""},O={medications:[I]},x=[{id:u.W.TABLET,label:"Tablet"},{id:u.W.VIAL,label:"Vial"},{id:u.W.INTRAVENOUS,label:"Intravenous"},{id:u.W.POWDER,label:"Powder"},{id:u.W.SOLUTION,label:"Solution"},{id:u.W.EYE_OINTMENT,label:"Eye Ointment"},{id:u.W.CREAM,label:"Cream"},{id:u.W.EYE_DROPS,label:"Eye Drops"},{id:u.W.OINTMENT,label:"Ointment"},{id:u.W.INHALER,label:"Inhaler"},{id:u.W.SUPPOSITORY,label:"Suppository"},{id:u.W.PESSARY,label:"Pessary"},{id:u.W.SUSPENSION,label:"Suspension"},{id:u.W.SHAMPOO,label:"Shampoo"},{id:u.W.EAR_DROPS,label:"Ear Drops"},{id:u.W.EYE_PASTE,label:"Eye Paste"}],D=[{id:"STAT",label:"STAT"},{id:u.W.ONCE_A_DAY,label:"24 Hourly (OD) - Once a day "},{id:u.W.TWICE_A_DAY,label:"12 Hourly (BID) - Twice a day"},{id:u.W.THREE_TIMES_A_DAY,label:"8 Hourly (TID) - Three times a day"},{id:u.W.FOUR_TIMES_A_DAY,label:"6 Hourly (QID) - Four times a day"},{id:u.W.SIX_TIMES_A_DAY,label:"4 Hourly (OD) - Six times a day "},{id:u.W.ONCE_A_WEEK,label:"Once a week"},{id:u.W.ONCE_A_MONTH,label:"Once a month"},{id:u.W.MORNING,label:"Morning"},{id:u.W.EVENING,label:"Evening"},{id:u.W.OTHER,label:"Other"}],T=o.Ik().shape({medications:o.YO().of(o.Ik().shape({name:o.Yj().required("Medication name is required"),formulation:o.Yj().required("Formulation is required"),medication_dose:o.ai().required("Dose is required").positive("Dose must be greater than 0"),medication_dose_unit:o.Yj().required("Dose unit is required"),medication_frequency:o.Yj().required("Frequency is required"),medication_duration:o.ai().required("Duration is required").positive("Duration must be greater than 0"),medication_duration_unit:o.Yj().required("Duration unit is required"),medication_date_last_taken:o.p6().nullable().required("Date of last taken is required"),medication_date_of_last_prescription:o.p6().nullable().required("Date of last prescription is required")}))}),W=["Milligrams (mg)","Micrograms (\xb5g)","Grams (g)","International Units (IU)","Milliliters (ml)","Millimoles (mmol)"],N=({onSubmit:e,onSkip:i,encounterType:a=u.fA.DISPOSED_PRESCRIPTIONS,onSubmissionSuccess:o,medicationTitle:N="Prescribed Medication",medicationLabelTitle:f})=>{let{ServerTime:j}=(0,A.useServerTime)(),{mutate:g,isPending:C,isSuccess:R}=(0,p.jM)(),{medicationOptions:P,loadingDrugs:y}=(0,S.A)(),[M,L]=(0,n.useState)({}),[F,U]=(0,n.useState)({medications:[]}),{activeVisit:v,patientId:w}=(0,b.gd)(),Y=(e,i)=>{L(a=>({...a,[e]:i}))};(0,n.useEffect)(()=>{R&&o()},[R]);let H=()=>{let e=j.getServerTimeString(),i=F.medications.map(i=>({concept:u.W.DRUG_GIVEN,value:i.name,obsDateTime:e,groupMembers:[{concept:u.W.MEDICATION_FORMULATION,value:i.formulation,obsDateTime:e},{concept:u.W.MEDICATION_DOSE,value:i.medication_dose,obsDateTime:e},{concept:u.W.MEDICATION_DOSE_UNIT,value:i.medication_dose_unit,obsDateTime:e},{concept:u.W.MEDICATION_FREQUENCY,value:i.medication_frequency,obsDateTime:e},{concept:u.W.MEDICATION_DURATION,value:i.medication_duration,obsDateTime:e},{concept:u.W.MEDICATION_DURATION_UNIT,value:i.medication_duration_unit,obsDateTime:e},{concept:u.W.DESCRIPTION,value:"current",obsDateTime:e}]}));g({encounterType:a,visit:v,patient:w,encounterDatetime:e,obs:i})},q=[{id:"prescribed",title:N,content:(0,t.jsx)(_.Z,{medicationLabelTitle:f,encounterType:a})}];return(0,t.jsxs)(h.h,{loading:C||y,children:[(0,t.jsx)(E.M,{sections:q}),(0,t.jsx)("br",{}),(0,t.jsx)(l.PD,{initialValues:O,validationSchema:T,onSubmit:e,enableReinitialize:!0,submitButton:!1,children:({values:e,setFieldValue:i})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.fP,{getValues:U}),(0,t.jsx)(s.ED,{name:"medications",children:({push:a,remove:n})=>(0,t.jsx)(c.A,{items:e.medications,setItems:e=>i("medications",e),newItem:I,renderFields:(e,a)=>(0,t.jsxs)(r.default,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[(0,t.jsx)(l.el,{name:`medications[${a}].name`,label:"Medication Name",options:P,getValue:e=>i(`medications[${a}].name`,e),multiple:!1}),(0,t.jsx)(l.el,{name:`medications[${a}].formulation`,label:"Formulation",options:x,getValue:e=>i(`medications[${a}].formulation`,e),sx:{flex:1},multiple:!1}),(0,t.jsx)(l.pj,{id:`medications[${a}].medication_dose`,label:"Dose",name:`medications[${a}].medication_dose`,unitName:`medications[${a}].medication_dose_unit`,unitOptions:W,placeholder:"e.g., 500",inputIcon:(0,t.jsx)(m.gaX,{})}),M[a]?(0,t.jsx)(l.A8,{id:`medications[${a}].medication_frequency`,name:`medications[${a}].medication_frequency`,label:"Specify frequency",sx:{flex:1}}):(0,t.jsx)(l.el,{name:`medications[${a}].medication_frequency`,label:"Frequency",options:D,getValue:e=>{"Other"===e&&Y(a,!0),i(`medications[${a}].medication_frequency`,e)},multiple:!1}),F?.medications[a]?.medication_frequency!="STAT"&&(0,t.jsx)(l.pj,{id:`medications[${a}].medication_duration`,name:`medications[${a}].medication_duration`,unitName:`medications[${a}].medication_duration_unit`,label:"Duration",unitOptions:u.bH,placeholder:"e.g. 7",inputIcon:(0,t.jsx)(d.YmN,{}),sx:{flex:1}})]})})}),(0,t.jsx)(l.jD,{sx:{mt:"2ch"},children:(0,t.jsx)(l.O6,{sx:{m:.5},title:"Submit",type:"submit",onClick:H})})]})})]})},f=()=>(0,t.jsx)(N,{medicationLabelTitle:"Medication to Pharmacy",medicationTitle:"Medication to Pharmacy",onSubmissionSuccess:()=>{},encounterType:u.fA.DISPOSED_PRESCRIPTIONS,onSkip:()=>{},onSubmit:()=>{}})},67332:(e,i,a)=>{a.d(i,{Ay:()=>O,wv:()=>S});var t=a(60687),l=a(76180),n=a.n(l),s=a(43210),o=a(30859),r=a(75018),c=a(42938),d=a(61939),m=a(62116),u=a(76990),p=a(30485),b=a(35009),h=a(29702),_=a(44504),E=a(7304);let S={dischargeHome:{name:c.W.DISCHARGE_HOME,label:"Discharge home",groupMembersWithLabel:!0,type:"string",children:[{concept:c.W.DISCHARGE_PLAN,label:"Discharge Plan"},{concept:c.W.FOLLOWUP_PLAN,label:"Follow-Up Plan",children:[{concept:c.W.FOLLOWUP_DETAILS,label:"Follow-Up Facility"},{concept:c.W.SPECIALIST_CLINIC,label:"Clinics"}]},{concept:c.W.HOME_CARE_INSTRUCTIONS,label:"Home Care Instructions"},{concept:c.W.DISCHARGE_NOTES,label:"Discharge Notes"}]},deathOutcome:{name:c.W.DEATH,label:"Death",groupMembersWithLabel:!0,type:"string",children:[{concept:c.W.CAUSE_OF_DEATH,label:"Cause of Death"},{concept:c.W.FAMILY_INFORMED,label:"Family Informed"},{concept:c.W.RELATIONSHIP_TO_DECEASED,label:"Relationship to Deceased"},{concept:c.W.MORTUARY,label:"Mortuary"},{concept:c.W.LAST_OFFICE_CONDUCTED,label:"Last Office Conducted"},{concept:c.W.NAME_OF_HEALTH_WORKER_WHO_CONDUCTED_LAST_OFFICE,label:"Name of Health Worker Who Conducted Last Office"},{concept:c.W.DATE_OF_LAST_OFFICE,label:"Date of Last Office"}]},absconded:{name:c.W.ABSCONDED,label:"Absconded",groupMembersWithLabel:!0,type:"string",children:[{concept:c.W.LAST_SEEN_LOCATION,label:"Last Seen Location"},{concept:c.W.DATE_OF_ABSCONDING,label:"Date of Absconding"},{concept:c.W.TIME_OF_ABSCONDING,label:"Time of Absconding"}]},admission:{name:c.W.ADMISSION,groupMembersWithLabel:!0,label:"Admission",type:"string",children:[{concept:c.W.WARD,label:"Ward"},{concept:c.W.BED_NUMBER,label:"Bed number"},{concept:c.W.REASON_FOR_ADMISSION,label:"reason for admission"},{concept:c.W.SPECIALITY_DEPARTMENT,label:"Speciality Department"}]},awaitingSpeciaty:{name:c.W.AWAITING_SPECIALITY_REVIEW,label:"Awaiting specialty review",groupMembersWithLabel:!0,type:"string",children:[{concept:c.W.SPECIALITY_DEPARTMENT,label:"Speciality Department"},{concept:c.W.REASON_FOR_REQUEST,label:"Reason for Request"},{concept:c.W.DATE,label:"Date"}]},refusedTreatment:{name:c.W.REFUSED_HOSPITAL_TREATMENT,label:"Refused Hospital Treatment",type:"string",groupMembersWithLabel:!0,children:[{concept:c.W.REASON_FOR_REFUSAL,label:"Reason for refusal"},{concept:c.W.PLANS_TO_RETURN_FOR_TREATMENT,label:"Plans to return for treatment"},{concept:c.W.DATE_OF_REFUSAL,label:"Date of refusal"},{concept:c.W.WITNESS_NAME,label:"Witness name"}]},transferOut:{name:c.W.TRANSFER_OUT,label:" Transfer Out",groupMembersWithLabel:!0,children:[{concept:c.W.FACILITY_NAME,label:"Facility Name"},{concept:c.W.REASON_FOR_TRANSFER,label:"Reason for Transfer"}]}},A=p.Ik({specialistClinic:p.Yj().when("followUpPlan",{is:e=>e===c.W.YES,then:e=>e,otherwise:e=>e.optional()})}),I={dischargePlan:"",followUpPlan:"",homeCareInstructions:"",followUpDetails:"",dischargeNotes:"",specialistClinic:"",otherServiceArea:""};function O({openPatientSummary:e,setInitialNotes:i}){let{params:a}=(0,d.KU)(),{mutate:l}=(0,m.jM)(),[n,p]=(0,s.useState)(void 0),{data:E}=(0,u.iu)(a.id),{init:S,ServerTime:A}=(0,_.useServerTime)(),[I,O]=(0,s.useState)(null),D=(0,s.useRef)(null),T=async(t,s)=>{let o=A.getServerTimeString(),r=t.specialistClinic;t.specialistClinic===I&&t.otherServiceArea&&(r=t.otherServiceArea),i({dischargeNotes:t.dischargeNotes,dischargePlan:t.dischargePlan,followUpDetails:t.followUpDetails,followUpPlan:t.followUpPlan,clinic:s.find(e=>e.id===t.specialistClinic)?.label||t.specialistClinic,homeCareInstructions:t.homeCareInstructions});let d=[{concept:c.W.DISCHARGE_HOME,value:c.W.DISCHARGE_HOME,obsDatetime:o,groupMembers:[{concept:c.W.DISCHARGE_PLAN,value:t.dischargePlan,obsDatetime:o},{concept:c.W.FOLLOWUP_PLAN,value:t.followUpPlan,obsDatetime:o},{concept:c.W.HOME_CARE_INSTRUCTIONS,value:t.homeCareInstructions,obsDatetime:o},{concept:c.W.FOLLOWUP_DETAILS,value:t.followUpDetails,obsDatetime:o},{concept:c.W.DISCHARGE_NOTES,value:t.dischargeNotes,obsDatetime:o},{concept:c.W.SPECIALIST_CLINIC,value:r||"",obsDatetime:o}]}],m={encounterType:c.fA.DISPOSITION,visit:n?.uuid,patient:a.id,encounterDatetime:o,obs:d};try{await l(m),e()}catch(e){console.error("Error submitting Discharge Home information: ",e)}};(0,o.useReactToPrint)({contentRef:D});let W=[{id:"DischargeHome",title:(0,t.jsx)("h2",{children:"Discharge Home"}),content:(0,t.jsx)(x,{handleSubmit:T,setOtherId:O,otherId:I,contentRef:D})},{id:"medications",title:(0,t.jsx)("h2",{children:"Prescribe Medications"}),content:(0,t.jsx)(h.a,{})}];return(0,t.jsx)(r.Yr,{container:!0,spacing:2,children:(0,t.jsx)(r.Yr,{item:!0,xs:12,lg:12,children:(0,t.jsx)(b.M,{sections:W})})})}let x=({handleSubmit:e,contentRef:i,setOtherId:a,otherId:l})=>{let{data:o}=(0,d.WL)(),{serviceAreaOptions:m}=(0,E.C)(),[u,b]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(m){let e=m.find(e=>"Other"===e.label);a(e?e.id:null)}},[m]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.PD,{initialValues:I,validationSchema:(()=>{let e=A.clone();return l?e.shape({otherServiceArea:p.Yj().when("specialistClinic",{is:e=>e===l,then:e=>e.required("Other Service Area is required"),otherwise:e=>e.optional()})}):e})(),onSubmit:i=>e(i,m),submitButtonText:"Submit",children:({values:e,setFieldValue:a})=>((0,s.useEffect)(()=>{e.specialistClinic===l?b(!0):(b(!1),a("otherServiceArea",""))},[e.specialistClinic,l,a]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{ref:i,className:"jsx-7b66091306a8e529 printable-content",children:(0,t.jsxs)("div",{className:"jsx-7b66091306a8e529 print-only",children:[(0,t.jsx)(r.TF,{}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Discharge Plan:"})," ",e.dischargePlan]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Followup Plan:"})," ",e.followUpPlan]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Home care Instructions:"})," ",e.homeCareInstructions]}),e.followUpPlan===c.W.YES&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Follow up details:"})," ",e.followUpDetails]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Service Area:"})," ",e.specialistClinic===l?e.otherServiceArea:m.find(i=>i.id===e.specialistClinic)?.label||e.specialistClinic]})]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Discharge notes:"})," ",e.dischargeNotes]})]})}),(0,t.jsxs)(r.Yr,{container:!0,spacing:2,children:[(0,t.jsxs)(r.Yr,{item:!0,xs:12,md:6,children:[(0,t.jsx)(r.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(r.A8,{id:"dischargeNotes",name:"dischargeNotes",label:"Discharge Notes",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write discharge notes"})}),(0,t.jsx)(r.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(r.A8,{id:"dischargePlan",name:"dischargePlan",label:"Discharge Plan (apart from the medications)",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write the discharge plan"})}),(0,t.jsx)(r.Yr,{item:!0,xs:12,children:(0,t.jsx)(r.A8,{id:"homeCareInstructions",name:"homeCareInstructions",label:"Home Care Instructions",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write specific home care instructions"})})]}),(0,t.jsxs)(r.Yr,{item:!0,xs:12,md:6,children:[(0,t.jsx)(r.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(r.b1,{name:"followUpPlan",label:"Follow-Up Plan",options:[{value:c.W.YES,label:"Yes"},{value:c.W.NO,label:"No"}]})}),e.followUpPlan===c.W.YES&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(r.el,{name:"followUpDetails",label:"Follow-Up Facility",options:o?o.map(e=>({id:e.facility_name,label:e.facility_name})):[],multiple:!1})}),(0,t.jsxs)(r.Yr,{item:!0,xs:12,children:[(0,t.jsx)(r.el,{name:"specialistClinic",label:"Clinics (If applicable)",options:m,multiple:!1}),u&&(0,t.jsx)(r.A8,{id:"otherServiceArea",name:"otherServiceArea",label:"Other Service Area",sx:{mt:2,width:"100%"}})]})]})]})]})]}))}),(0,t.jsx)(n(),{id:"7b66091306a8e529",children:"@media print{.print-only.jsx-7b66091306a8e529{display:block!important}}.print-only.jsx-7b66091306a8e529{display:none}"})]})}}};