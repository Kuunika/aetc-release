"use strict";exports.id=5947,exports.ids=[5947],exports.modules={13811:(a,b,c)=>{c.d(b,{B:()=>l});var d=c(21124);c(38301);var e=c(80350),f=c(48936),g=c(66815),h=c(95745);let i={firstName:{name:"firstName",label:"First Name"},phoneNumber:{name:"phoneNumber",label:"Phone Number"},lastName:{name:"lastName",label:"Last Name"},dob:{name:"birthDate",label:"Estimated Age"},gender:{name:"gender",label:"Gender"},homeDistrict:{name:"homeDistrict",label:"Home District"},nationality:{name:"nationality",label:"Nationality"},homeTraditionalAuthority:{name:"homeTraditionalAuthority",label:"Home Traditional Authority"},homeVillage:{name:"homeVillage",label:"Home Village"}},j=f.Ik().shape({[i.firstName.name]:f.Yj().required().label(i.firstName.label),[i.lastName.name]:f.Yj().required().label(i.lastName.label),[i.dob.name]:f.Yj().label(i.dob.label),[i.gender.name]:f.Yj().required().label(i.gender.label),[i.homeDistrict.name]:f.Yj().label(i.homeDistrict.label),[i.homeTraditionalAuthority.name]:f.Yj().label(i.homeTraditionalAuthority.label),[i.homeVillage.name]:f.Yj().label(i.homeVillage.label)}),k=(0,g.f6)(i),l=({onSubmit:a,init:b,fullForm:c=!0})=>{let f={display:"flex","& > :first-of-type":{mr:"5px"}};return(0,d.jsx)(e.PD,{validationSchema:j,initialValues:{...k,...b},onSubmit:a,submitButton:!1,enableReinitialize:!0,children:(0,d.jsxs)(e.jD,{children:[(0,d.jsxs)(e.jD,{sx:{...f,alignItems:"end",py:"1ch"},children:[(0,d.jsx)(e.A8,{sx:{width:"100%",my:0},name:i.firstName.name,id:i.firstName.name,size:"small",label:i.firstName.label}),(0,d.jsx)(e.A8,{sx:{width:"100%",my:0,mr:"5px"},name:i.lastName.name,id:i.lastName.name,size:"small",label:i.lastName.label}),(0,d.jsx)(e.el,{width:"100%",inputSx:{m:0},name:i.gender.name,label:i.gender.label,multiple:!1,size:"small",applyPadding:!1,options:[{label:"Male",id:"M"},{label:"Female",id:"F"}]})]}),c&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(e.jD,{sx:{...f},children:[(0,d.jsx)(e.el,{width:"30%",name:i.gender.name,label:i.gender.label,multiple:!1,size:"small",options:[{label:"Male",id:"Male"},{label:"Female",id:"Female"}]}),(0,d.jsx)(e.A8,{sx:{width:"100%",my:0},name:i.dob.name,id:i.dob.name,size:"small",label:i.dob.label})]}),(0,d.jsxs)(e.jD,{display:"flex",children:[(0,d.jsx)(e.el,{sx:{mr:"0.5ch"},width:"45%",size:"small",name:i.homeDistrict.name,label:i.homeDistrict.label,multiple:!1,options:h.kJ.map(a=>({id:a.district_name,label:a.district_name}))}),(0,d.jsx)(e.el,{width:"100%",size:"small",name:i.homeTraditionalAuthority.name,label:i.homeTraditionalAuthority.label,multiple:!1,options:h.ZD})]}),(0,d.jsx)(e.jD,{children:(0,d.jsx)(e.el,{width:"100%",size:"small",name:i.homeVillage.name,label:i.homeVillage.label,multiple:!1,options:h.rJ})})]}),(0,d.jsx)(e.O6,{sx:{width:"100%",height:"5ch",borderRadius:"10px",mt:"1ch"},type:"submit",onClick:()=>{},title:"search"})]})})}},17448:(a,b,c)=>{c.d(b,{g:()=>k});var d=c(21124),e=c(38301),f=c(48457),g=c(34304),h=c(81637);function i(a){let{children:b,value:c,index:e,...f}=a;return(0,d.jsx)("div",{role:"tabpanel",hidden:c!==e,id:`simple-tabpanel-${e}`,"aria-labelledby":`simple-tab-${e}`,...f,children:c===e&&(0,d.jsx)(h.default,{children:b})})}function j(a){return{id:`simple-tab-${a}`,"aria-controls":`simple-tabpanel-${a}`}}function k({demographics:a,npid:b}){let[c,k]=e.useState(0);return(0,d.jsxs)(h.default,{sx:{width:"100%"},children:[(0,d.jsx)(h.default,{children:(0,d.jsxs)(f.A,{value:c,onChange:(a,b)=>{k(b)},"aria-label":"basic tabs example",centered:!0,children:[(0,d.jsx)(g.A,{label:"Demographics",...j(0)}),(0,d.jsx)(g.A,{label:"NPID",...j(1)})]})}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)(i,{value:c,index:0,children:a}),(0,d.jsx)(i,{value:c,index:1,children:b})]})}},63436:(a,b,c)=>{c.d(b,{V:()=>h});var d=c(21124),e=c(82283),f=c(80350),g=c(68096);let h=({title:a,link:b})=>{let{navigateTo:c}=(0,e.cq)(),h={fontFamily:"Inter",fontSize:"14px",fontWeight:400,lineHeight:"21px",letterSpacing:"0em",textAlign:"center",mx:"1ch"};return(0,d.jsxs)(f.jD,{sx:{display:"flex",justifyContent:"space-evenly",py:"1ch",borderBottom:"solid 1px #E6E6E6"},children:[(0,d.jsxs)(f.jD,{onClick:()=>c(b),sx:{display:"flex",cursor:"pointer"},children:[(0,d.jsx)(f.Th,{children:(0,d.jsx)(g.oWm,{})}),(0,d.jsx)(f.Th,{sx:h,children:"Go back"})]}),(0,d.jsx)(f.Th,{sx:h,children:a}),(0,d.jsxs)(f.jD,{sx:{display:"flex",alignItems:"center"},children:[(0,d.jsx)(g.M4e,{}),(0,d.jsx)(f.Th,{sx:h,children:"Need any help?"})]})]})}},83680:(a,b,c)=>{c.d(b,{c:()=>k});var d=c(21124);c(38301);var e=c(80350),f=c(48936),g=c(66815);let h={npid:{name:"npid",label:"NPID"}},i=f.Ik().shape({[h.npid.name]:f.Yj().required().label(h.npid.label)}),j=(0,g.f6)(h),k=({onSubmit:a,init:b})=>(0,d.jsx)(e.PD,{validationSchema:i,initialValues:{...j,...b},onSubmit:a,submitButton:!1,children:(0,d.jsxs)(e.jD,{children:[(0,d.jsx)(e.A8,{sx:{width:"100%",my:0},name:h.npid.name,id:h.npid.name,size:"small",label:h.npid.label}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)(e.O6,{sx:{width:"100%",height:"5ch",borderRadius:"10px"},type:"submit",onClick:()=>{},title:"search"})]})})},92934:(a,b,c)=>{c.d(b,{$:()=>$,Q:()=>_});var d=c(21124),e=c(41640),f=c(16316),g=c(66951),h=c(33772),i=c(38301),j=c(13811),k=c(83680),l=c(80350);c(24515);var m=c(15143),n=c(82283),o=c(68096),p=c(43520),q=c(50852),r=c(57549),s=c(95745),t=c(45701),u=c(90675),v=c(48936),w=c(81299);let x=v.Ik().shape({[s.W.REFERRED_FROM]:v.Yj().label("Referee Medical Facility"),[s.W.ADDITIONAL_NOTES]:v.Yj()}),y=({onSubmit:a,submitButton:b=!0,setContext:c=a=>{}})=>{let{data:e}=(0,n.WL)(),[f,g]=(0,i.useState)("yes"),[h,j]=(0,i.useState)("");return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(l.PD,{validationSchema:x,initialValues:{[s.W.REFERRED_FROM]:"",[s.W.ADDITIONAL_NOTES]:"yes"},onSubmit:a,submitButtonText:"submit",submitButton:b,children:[(0,d.jsx)(m.Ji,{setFormContext:c}),(0,d.jsx)(w.uQ,{children:"Health Facilities"}),(0,d.jsx)(l.el,{label:"Referral Medical Facility",name:s.W.REFERRED_FROM,getValue:j,multiple:!1,disabled:"no"==f,options:e?e.map(a=>({id:a.facility_name,label:a.facility_name})):[]}),""==h&&(0,d.jsx)(l.b1,{name:s.W.ADDITIONAL_NOTES,getValue:a=>{g(a)},label:"Is the facility you are looking for available?",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}]}),"no"==f&&(0,d.jsx)(l.A8,{name:s.W.REFERRED_FROM,label:"Other Facility",id:s.W.REFERRED_FROM})]})})};var z=c(81498),A=c(73240),B=c(49840),C=c(75744),D=c(66815),E=c(81637),F=c(79515),G=c(54573);let H=({patient:a,open:b,onClose:c})=>{let{navigateTo:e}=(0,n.cq)(),[f,g]=(0,i.useState)(0),[h,j]=(0,i.useState)({});return(0,d.jsx)(l.eV,{onClose:c,open:b,title:"Remote Patient",children:(0,d.jsx)(E.default,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,d.jsxs)(E.default,{sx:{width:{sm:"100%",lg:"40%"}},children:[0==f&&(0,d.jsx)(I,{patient:a,next:()=>g(1)}),1==f&&(0,d.jsx)(J,{setUpdatedPatient:j,person:a,next:()=>g(2)}),2==f&&(0,d.jsx)(K,{next:()=>g(3)}),3==f&&(0,d.jsx)(N,{next:()=>g(4)}),4==f&&(0,d.jsx)(O,{next:()=>g(5)}),5==f&&(0,d.jsx)(L,{next:()=>g(6)}),6==f&&(0,d.jsx)(M,{next:()=>g(7)}),7==f&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(C.Yc,{firstName:h.given_name,lastName:h.family_name,addresses:h?.addresses?h?.addresses:[],identifiers:h.identifiers}),(0,d.jsx)("br",{}),(0,d.jsx)(l.O6,{title:"Register More",sx:{mr:"1px"},onClick:()=>e("/registration/list")}),(0,d.jsx)(l.O6,{title:"Home",onClick:()=>e("/dashboard")})]})]})})})},I=({patient:a,next:b})=>{let{params:c}=(0,n.KU)(),[e,f]=(0,i.useState)({firstName:"",lastName:"",birthDate:"",gender:"",birthDateEstimated:""}),[h,j]=(0,i.useState)({nationality:"",district:"",village:"",traditionalAuthority:""}),[k,m]=(0,i.useState)({district:"",traditionalAuthority:"",village:"",closeLandMark:""}),{mutate:o,isPending:p,isSuccess:q,data:r}=(0,g.h1)();return(0,i.useEffect)(()=>{q&&b()},[q]),(0,i.useEffect)(()=>{(a=>{a&&f({firstName:a?.given_name,lastName:a?.family_name,birthDate:a?.birthdate,gender:a?.gender,birthDateEstimated:!!a?.birthdateEstimated})})(a),(a=>{a&&j({nationality:a?.addresses[0]?.country??"",district:a?.addresses[0]?.address1??"",village:a?.addresses[0]?.address2??"",traditionalAuthority:a?.addresses[0]?.county_district??""})})(a),(a=>{a&&m({district:a?.addresses[0]?.current_district??"",traditionalAuthority:a?.addresses[0]?.current_traditional_authority??"",village:a?.addresses[1]?.address1??"",closeLandMark:a?.addresses[1]?.address2??""})})(a)},[a]),(0,d.jsxs)(E.default,{children:[(0,d.jsxs)(P,{children:[(0,d.jsx)(F.default,{variant:"h5",children:"Demographics"}),(0,d.jsx)("br",{}),(0,d.jsx)(Q,{label:"First Name",value:e.firstName}),(0,d.jsx)(Q,{label:"Last Name",value:e.lastName}),(0,d.jsx)(Q,{label:"Gender",value:e.gender}),(0,d.jsx)(Q,{label:"Date of birth",value:e.birthDate})]}),(0,d.jsxs)(P,{children:[(0,d.jsx)(F.default,{variant:"h5",children:"Home Location"}),(0,d.jsx)("br",{}),(0,d.jsx)(Q,{label:"Country",value:h.nationality}),(0,d.jsx)(Q,{label:"Home District",value:h.district}),(0,d.jsx)(Q,{label:"Home Traditional Authority",value:h.traditionalAuthority}),(0,d.jsx)(Q,{label:"Home Village",value:h.village})]}),(0,d.jsxs)(P,{children:[(0,d.jsx)(F.default,{variant:"h5",children:"Current Location"}),(0,d.jsx)("br",{}),(0,d.jsx)(Q,{label:"Current District",value:k.district}),(0,d.jsx)(Q,{label:"Current Traditional Authority",value:k.traditionalAuthority}),(0,d.jsx)(Q,{label:"Current Village",value:k.village}),(0,d.jsx)(Q,{label:"Close Land Mark",value:k.closeLandMark})]}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"Merge",onClick:()=>{o({primary:{patient_id:c?.id},secondary:[{doc_id:a.uuid}]})}})]})},J=({next:a,person:b,setUpdatedPatient:c})=>{let{mutate:f,isPending:h,isSuccess:j,data:k}=(0,g.Wv)(),{mutate:m,isPending:o,isSuccess:p,data:q}=(0,g.Wv)(),{params:r}=(0,n.KU)(),[t,u]=(0,i.useState)({}),[v,w]=(0,i.useState)({}),[x,y]=(0,i.useState)(),[z,A]=(0,i.useState)(),[C,D]=(0,i.useState)(),[E,G]=(0,i.useState)([]);(0,i.useEffect)(()=>{j&&a()},[j]),(0,i.useEffect)(()=>{0!=Object.keys(t).length&&0!=Object.keys(v).length&&(()=>{let a=[{address1:t?.district,address2:t?.village,address3:v?.district,stateProvince:v?.traditionalAuthority,countyDistrict:t?.traditionalAuthority,cityVillage:t?.traditionalAuthority,country:t?.nationality,preferred:!0},{address1:v?.village,address2:v?.closeLandMark,countryDistrict:v?.district,cityVillage:v?.traditionalAuthority,preferred:!1}];m({id:r?.id,data:{addresses:a}})})()},[t,v]),(0,i.useEffect)(()=>{p&&(c(q?.patient),a())},[p]);let H=b.identifiers.find(a=>a?.identifier_type?.uuid==s.W.NATIONAL_ID_IDENTIFIER_TYPE)?.identifier;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.OverlayLoader,{open:h}),(0,d.jsxs)(P,{children:[(0,d.jsx)(F.default,{variant:"h5",children:"Edit Demographics"}),(0,d.jsx)("br",{}),(0,d.jsx)(B.H5,{setContext:y,submitButton:!1,initialValues:{identificationNumber:H,firstName:b.given_name,lastName:b.family_name,gender:b.gender,birthDate:b.birthdate,birthdateEstimated:!1},onSubmit:a=>{(a=>{let b={identifiers:a.identificationNumber?[{identifier:a.identificationNumber,identifierType:s.W.NATIONAL_ID_IDENTIFIER_TYPE,preferred:!0}]:[],names:[{givenName:a.firstName,familyName:a.lastName}],gender:a.gender,birthdateEstimated:a.birthdateEstimated,birthdate:a.birthDate};f({id:r?.id,data:b})})(a)}})]}),(0,d.jsxs)(P,{children:[(0,d.jsx)(F.default,{variant:"h5",children:"Home Location"}),(0,d.jsx)("br",{}),(0,d.jsx)(B.CB,{setContext:A,initialValues:{nationality:b?.addresses[0]?.country??"",district:b?.addresses[0]?.address1??"",village:b?.addresses[0]?.address2??"",traditionalAuthority:b?.addresses[0]?.county_district??""},onSubmit:u,submitButton:!1})]}),(0,d.jsxs)(P,{children:[(0,d.jsx)(F.default,{variant:"h5",children:"Current Location"}),(0,d.jsx)("br",{}),(0,d.jsx)(B.CB,{currentLocation:!0,setContext:D,initialValues:{district:b?.addresses[0]?.current_district??"",traditionalAuthority:b?.addresses[0]?.current_traditional_authority??"",village:b?.addresses[1]?.address1??"",closeLandMark:b?.addresses[1]?.address2??""},onSubmit:w,submitButton:!1})]}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:a,errors:b,isValid:c,touched:d,dirty:e}=x,{submitForm:f,errors:g,isValid:h,touched:i,dirty:j}=z,{submitForm:k,errors:l,isValid:m,touched:n,dirty:o}=C;a(),f(),k()}})]})},K=({next:a})=>{let{ServerTime:b}=(0,u.useServerTime)(),{activeVisit:c}=(0,n.gd)(),{params:f}=(0,n.KU)(),{mutate:g,isSuccess:h,isPending:j,isError:k}=(0,q.Fs)(),[m,o]=(0,i.useState)();return(0,i.useEffect)(()=>{h&&a()},[h]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(P,{children:[(0,d.jsx)(e.OverlayLoader,{open:j}),(0,d.jsx)(B._T,{submitButton:!1,setContext:o,initialValues:{},onSubmit:a=>{let d=b.getServerTimeString();g({encounterType:s.fA.SOCIAL_HISTORY,visit:c,patient:f.id,encounterDatetime:d,obs:(0,D.gX)(a,d)})}})]}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:a,errors:b,isValid:c,touched:d,dirty:e}=m;a()}})]})},L=({next:a})=>{let{ServerTime:b}=(0,u.useServerTime)(),[c,e]=(0,i.useState)(),{params:f}=(0,n.KU)(),{activeVisit:g}=(0,n.gd)(),{mutate:h,isSuccess:j,isPending:k,isError:m}=(0,q.Fs)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P,{children:(0,d.jsx)(y,{setContext:e,submitButton:!1,onSubmit:a=>{let c=b.getServerTimeString();h({encounterType:s.fA.REFERRAL,visit:g,patient:f.id,encounterDatetime:c,obs:(0,D.gX)(a,c)})}})}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:b,errors:d,isValid:e,touched:f,dirty:g}=c;b(),a()}})]})},M=({next:a})=>{let{ServerTime:b}=(0,u.useServerTime)(),[c,e]=(0,i.useState)(),{params:f}=(0,n.KU)(),{activeVisit:g}=(0,n.gd)(),{mutate:h,isSuccess:j,isPending:k,isError:m}=(0,q.Fs)();return(0,i.useEffect)(()=>{j&&a()},[j]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P,{children:(0,d.jsx)(B.OE,{initialValues:{},setContext:e,submitButton:!1,onSubmit:a=>{let c=b.getServerTimeString(),d=a[s.W.PAYMENT_OPTIONS].filter(a=>a.value).map(a=>({concept:s.W.PAYMENT_OPTIONS,value:a.key,obsDatetime:c}));h({encounterType:s.fA.FINANCING,visit:g,patient:f.id,encounterDatetime:c,obs:[...(0,D.gX)(a,c),...d]})}})}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:b,errors:d,isValid:e,touched:f,dirty:g}=c;b(),a()}})]})},N=({next:a})=>{let{ServerTime:b}=(0,u.useServerTime)(),[c,e]=(0,i.useState)(),[f,g]=(0,i.useState)(""),{patient:j}=(0,n.gd)(),{mutate:k,isPending:m,isSuccess:o,data:p,isError:q}=(0,h.AU)(),{mutate:r,isPending:s,isSuccess:t,isError:v,data:w}=(0,h.bJ)();return(0,i.useEffect)(()=>{t&&(b.getServerTimeString(),k({patient:j?.uuid,person:w?.uuid,nextOfKinRelationship:f}))},[t]),(0,i.useEffect)(()=>{o&&a()},[o]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P,{children:(0,d.jsx)(B.tc,{initialValues:{},setContext:e,submitButton:!1,onSubmit:a=>{r(a),g(a.relationship)}})}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:a,errors:b,isValid:d,touched:e,dirty:f}=c;a()}})]})},O=({next:a})=>{let{params:b}=(0,n.KU)(),[c,e]=(0,i.useState)(),{mutate:f,isPending:g,isSuccess:j,isError:k,data:m}=(0,h.bJ)(),{mutate:o,isPending:p,isSuccess:q,data:r,isError:t}=(0,h.AU)();return(0,i.useEffect)(()=>{j&&o({patient:b?.id,person:m?.uuid,nextOfKinRelationship:s.W.GUARDIAN})},[j]),(0,i.useEffect)(()=>{q&&a()},[q]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P,{children:(0,d.jsx)(B.tc,{isGuardian:!0,initialValues:{given_name:"",family_name:"",relationship:s.W.GUARDIAN},setContext:e,submitButton:!1,onSubmit:a=>{console.log({values:a}),f({nextOfKinFirstName:a.given_name,nextOfKinLastName:a.family_name})}})}),(0,d.jsx)(l.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:a,errors:b,isValid:d,touched:e,dirty:f}=c;a(),console.log(b)}})]})},P=({children:a})=>(0,d.jsx)(G.default,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",p:"1ch",flex:1,my:"1ch"},children:a}),Q=({label:a,value:b})=>(0,d.jsxs)(E.default,{sx:{display:"flex",alignItems:"flex-start",py:"0.5ch",mb:"0.5ch",borderBottom:"#D8D8D8 solid 1px"},children:[(0,d.jsx)(F.default,{width:"20ch",sx:{fontSize:"0.8rem"},children:a}),(0,d.jsx)(F.default,{fontWeight:"900",sx:{fontSize:"0.8rem",textTransform:"capitalize"},children:b})]});var R=c(68730),S=c(41893),T=c(33104);let U=({searchedPatient:a,searchResults:b,genericSearch:c})=>{let{navigateTo:e}=(0,n.cq)(),{params:g}=(0,n.KU)(),[h,j]=(0,i.useState)(!1),{setRegistrationType:k,setPatient:m,patient:o}=(0,i.useContext)(f.$0),[p,q]=(0,i.useState)(""),{setPatient:r}=(0,i.useContext)(f.$0),s=()=>{r(a),e(`/registration/${g.id}/new`)},t=(a,b)=>{m(a),j(!0),q(b)},u=b?.locals?.length==0&&b?.remotes?.length==0;return(0,d.jsxs)(l.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,d.jsx)(l.Th,{variant:"h5",children:"Search Results"}),u&&(0,d.jsxs)(l.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,d.jsx)("br",{}),(0,d.jsx)(l.Th,{variant:"body2",children:"No patient with similar demographics found"}),(0,d.jsx)("br",{}),!c&&(0,d.jsx)(l.O6,{sx:{mr:"0.2ch",borderRadius:"1px"},variant:"secondary",title:"add new record",onClick:s})]}),(0,d.jsx)("br",{}),!u&&(0,d.jsx)(l.jD,{sx:{width:"100%"},children:!c&&(0,d.jsx)(l.O6,{sx:{mr:"0.2ch",borderRadius:"1px"},variant:"secondary",title:"add new record",onClick:s})}),(0,d.jsx)("br",{}),(0,d.jsxs)(l.jD,{sx:{width:"100%",height:"50ch",overflow:"scroll"},children:[b?.locals?.map(a=>(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(V,{genericSearch:c,setOpen:a=>!c&&t(a,"local"),type:"Local",person:a},a?.uuid)})),b?.remotes?.map(a=>(0,d.jsx)(V,{genericSearch:c,setOpen:a=>!c&&t(a,"remote"),type:"Remote",person:a},a?.uuid))]}),"local"==p&&(0,d.jsx)(X,{type:p,patient:o||{},onClose:()=>j(!1),open:h}),"remote"==p&&(0,d.jsx)(H,{patient:o||{},onClose:()=>j(!1),open:h})]})},V=({person:a,type:b,setOpen:c,genericSearch:e})=>{let[f,g]=(0,i.useState)(!1),{navigateTo:h}=(0,n.cq)();if((0,i.useEffect)(()=>{g(!!a?.active_visit)},[a]),!a)return(0,d.jsx)(d.Fragment,{});let j=a?.identifiers?.find(a=>a?.identifier_type?.name=="National id");return(0,d.jsxs)(l.sc,{onClick:()=>{f||c(a)},sx:{display:"flex",padding:2,width:"100%",my:1,cursor:"pointer"},children:[(0,d.jsxs)(l.jD,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",mr:1},children:[(0,d.jsx)(l.jD,{sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#F5F5F5"},children:(0,d.jsx)(l.Th,{color:l.zQ.primary,variant:"h1",children:(0,d.jsx)(o.x$1,{})})}),(0,d.jsx)("br",{}),"Local"==b&&e&&(0,d.jsx)(C.jx,{title:"Print Barcode",icon:(0,d.jsx)(F.default,{mr:"1ch",children:(0,d.jsx)(o.SCC,{})}),variant:"primary",uuid:a?.uuid}),"Local"==b&&e&&(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(R.A,{onClick:()=>h(`/patient/${a.uuid}/profile`),sx:{mb:"1ch"},variant:"text",children:"view profile"})}),f&&!e&&(0,d.jsx)(T.R,{patientId:"",dialogTitle:"Close Patient Visit",dialogConfirmationMsg:"Are you sure you want to close this visit?",visitId:a?.active_visit?.uuid,buttonTitle:"Close Visit",onDelete:()=>g(!1)})]}),(0,d.jsxs)(l.jD,{children:[(0,d.jsxs)(l.jD,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,d.jsxs)(l.Th,{variant:"h5",children:[a?.given_name," ",a?.family_name]}),(0,d.jsx)(l.Th,{children:b})]}),(0,d.jsxs)(l.jD,{sx:{display:"flex"},children:[(0,d.jsx)(l.Th,{color:"GrayText",sx:{mr:1},children:"NPID:"}),(0,d.jsx)(l.Th,{color:"GrayText",children:j?.identifier})]}),(0,d.jsx)("br",{}),(0,d.jsxs)(l.jD,{sx:{display:"flex",mb:1},children:[(0,d.jsx)(W,{label:"Date of birth",value:a?.birthdate}),(0,d.jsx)(W,{label:"Gender",value:a?.gender})]}),(0,d.jsxs)(l.jD,{sx:{display:"flex"},children:[(0,d.jsx)(W,{label:"Home district",value:a&&a.addresses&&a?.addresses[0]?.address1}),(0,d.jsx)(W,{label:"Home traditional authority",value:a&&a.addresses&&a?.addresses[0]?.cityVillage}),(0,d.jsx)(W,{label:"Home village",value:a&&a.addresses&&a?.addresses[0]?.address2})]})]}),(0,d.jsx)(l.jD,{sx:{ml:"1ch"},children:f&&(0,d.jsx)(S.A,{color:"success",label:"Visit"})})]})},W=({label:a,value:b})=>(0,d.jsxs)(l.jD,{sx:{display:"flex",flexDirection:"column",mr:1},children:[(0,d.jsx)(l.Th,{variant:"subtitle2",color:"#C0C0C0",sx:{mr:.5},children:a}),(0,d.jsx)(l.Th,{variant:"subtitle2",color:"#585858",children:b?b.toString():""})]}),X=({patient:a,onClose:b,open:c,type:f="remote"})=>{let[h,j]=(0,i.useState)(f),{params:k}=(0,n.KU)(),{ServerTime:m}=(0,u.useServerTime)(),{data:o}=(0,q.$O)(k?.id),{data:v,isPending:w}=(0,q.$O)(a?.uuid),{mutate:x,isSuccess:y}=(0,r.FD)(),{data:z,isPending:B}=(0,g.B$)(a?.uuid),[C,D]=(0,i.useState)({}),[E,F]=(0,i.useState)(""),[G,H]=(0,i.useState)(!1),[I,J]=(0,i.useState)(!1),{mutateAsync:K,isPending:L,isSuccess:M,isError:N}=(0,q.jM)(),{mutateAsync:O,isPending:P,isSuccess:Q,isError:R}=(0,q.jM)(),{mutateAsync:S,isPending:T,isSuccess:U,isError:V}=(0,q.jM)(),{mutateAsync:W,isPending:X,isSuccess:$,isError:_,data:aa}=(0,g.h1)(),{mutateAsync:ab,isPending:ac,isSuccess:ad,isError:ae,data:af}=(0,g.h1)(),[ag,ah]=(0,i.useState)({}),[ai,aj]=(0,i.useState)({}),[ak,al]=(0,i.useState)({[s.W.REFERRED_FROM]:""});(0,i.useEffect)(()=>{D(a)},[a]),(0,i.useEffect)(()=>{ad&&j("")},[ad]),(0,i.useEffect)(()=>{let a=o?.find(a=>a.encounter_type.uuid==s.fA.SCREENING_ENCOUNTER);F((0,t.m)(a?.obs,s.W.IS_PATIENT_REFERRED))},[o]),(0,i.useEffect)(()=>{U&&J(!0)},[U]);let am=async()=>{let b=a?.uuid,c=k?.id,d=await W({primary:{patient_id:b},secondary:[{patient_id:c}]});await K({encounterType:s.fA.SOCIAL_HISTORY,visit:d?.active_visit?.uuid,patient:d?.uuid,encounterDatetime:m.getServerTimeString(),obs:ag?.obs?.map(a=>({concept:a.names[0].uuid,value:a.value,obsDatetime:m.getServerTimeString()}))}),await S({encounterType:s.fA.REFERRAL,visit:d?.active_visit?.uuid,patient:d?.uuid,encounterDatetime:m.getServerTimeString(),obs:[{concept:s.W.REFERRED_FROM,value:ak[s.W.REFERRED_FROM],obsDatetime:m.getServerTimeString()}]}),await O({encounterType:s.fA.FINANCING,visit:d?.active_visit?.uuid,patient:d?.uuid,encounterDatetime:m.getServerTimeString(),obs:ai?.obs?.map(a=>({concept:a.names[0].uuid,value:a.value,obsDatetime:m.getServerTimeString()}))})};(0,i.useEffect)(()=>{let a=v?.find(a=>a.encounter_type.uuid==s.fA.FINANCING),b=v?.find(a=>a.encounter_type.uuid==s.fA.SOCIAL_HISTORY);b&&ah(b),a&&aj(a)},[v]);let an=async a=>{await al(a),await am(),H(!1)};return(0,d.jsxs)(l.eV,{sx:{backgroundColor:"#F6F6F6"},onClose:b,open:c,title:"view patient",children:[(0,d.jsx)(e.OverlayLoader,{open:X||T||P||L||ac}),(0,d.jsx)(Z,{open:I}),(0,d.jsx)(l.Th,{variant:"h4",children:`${a.given_name} ${a.family_name}`}),(0,d.jsx)("br",{}),(0,d.jsx)(l.O6,{title:"Continue with Patient",onClick:()=>{if(E==s.W.YES)return void H(!0);am()}}),"remote"==h&&(0,d.jsx)(l.O6,{sx:{mx:"1px"},title:"Merge Patient",onClick:()=>{let b=a?.uuid;ab({primary:{patient_id:C.uuid},secondary:[{doc_id:b}]})}}),(0,d.jsx)(Y,{open:G,onClose:()=>H(!1),onSubmit:an}),(0,d.jsx)("br",{}),(0,d.jsx)(p.l,{disabled:"remote"==h,patient:a}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)(A.vY,{disabled:"remote"==h,patientId:a?.uuid,loading:B,relationships:z||[]}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsxs)(l.jD,{display:"flex",children:[(0,d.jsx)(A.oC,{disabled:"remote"==h,onSubmit:a=>{ah({obs:Object.keys(a).map(b=>({names:[{uuid:b}],concept:b,value:a[b],obsDatetime:m.getServerTimeString()}))})},loading:w,socialHistory:ag||{}}),(0,d.jsx)(A.c4,{disabled:"remote"==h,onSubmit:a=>{let b=a[s.W.PAYMENT_OPTIONS].filter(a=>a.value),c=b[0]?.key;a[s.W.PAYMENT_OPTIONS]=c;let d=JSON.parse(JSON.stringify(ai)),e={"c7bcc8bd-09d5-4f98-8d58-5179f749fd99":s.W.PAYMENT_OPTIONS,"b0ffce26-2d25-449e-871e-c702e44bb37e":s.W.INSURANCE_PROVIDER,"98b08fb2-f877-45b6-a95a-db89dffefb27":s.W.INSURANCE_NUMBER,"db2e6bba-7d04-4873-a0a2-ac7bd69dd7b1":s.W.INSURANCE_SCHEME,"3cdd53d9-35a5-47e5-909f-654e5bc7c9a8":s.W.INSURANCE_STATUS},f=d.obs.map(b=>{let c=a[e[b.names[0].uuid]];return{...b,value:c}});d.obs=f,aj(d)},loading:w,financing:ai||{}})]})]})},Y=({open:a,onClose:b,onSubmit:c})=>(0,d.jsx)(l.eV,{maxWidth:"sm",title:"Add Referral",open:a,onClose:b,children:(0,d.jsx)(y,{onSubmit:c})}),Z=({open:a})=>{let{navigateTo:b}=(0,n.cq)();return(0,d.jsx)(l.eV,{open:a,maxWidth:"sm",title:"",onClose:()=>{},children:(0,d.jsx)(z.n,{title:"Process Completed Successfully",primaryActionText:"Register More",secondaryActionText:"Go Home",onPrimaryAction:()=>{b("/registration/list")},onSecondaryAction:()=>{b("/dashboard")}})})},$=({patient:a,genericSearch:b=!1})=>{let{setSearchedPatient:c}=(0,i.useContext)(f.$0),[h,k]=(0,i.useState)({firstName:"",lastName:"",gender:""}),{refetch:l,isFetching:m,isSuccess:n,data:o,isError:p}=(0,g.L3)(h.firstName,h.lastName,h.gender),[q,r]=(0,i.useState)({});return(0,i.useEffect)(()=>{h.firstName&&l()},[h]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.B,{init:{firstName:a?.given_name,lastName:a?.family_name},onSubmit:b=>{r(b),k({firstName:b.firstName,lastName:b.lastName,gender:b.gender}),c({patient_id:a.patient_id,firstName:b.firstName,lastName:b.lastName,gender:b.gender})},fullForm:!1}),(0,d.jsx)("br",{}),(0,d.jsx)(e.OverlayLoader,{open:m}),(n||p)&&(0,d.jsx)(U,{genericSearch:b,searchResults:(a=>{let b=a?.remotes?.map(a=>({...a.person,identifiers:a.identifiers,patient_id:a.identifiers[0]?.identifier,given_name:a.person.names[0].given_name,family_name:a.person.names[0].family_name,addresses:a.addresses,uuid:a.identifiers[1]?.identifier}));return a?{remotes:b,locals:a.locals}:{remotes:[],locals:[]}})(o),searchedPatient:q})]})},_=({genericSearch:a=!0})=>{let[b,c]=(0,i.useState)(""),{refetch:f,isFetching:g,isSuccess:j,data:l,isError:m}=(0,h.Ov)(b);return(0,i.useEffect)(()=>{b&&f()},[b]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.OverlayLoader,{open:g}),(0,d.jsx)(k.c,{onSubmit:a=>c(a.npid)}),(j||m)&&(0,d.jsx)(U,{genericSearch:a,searchResults:l||{remotes:[],locals:[]},searchedPatient:l})]})}}};