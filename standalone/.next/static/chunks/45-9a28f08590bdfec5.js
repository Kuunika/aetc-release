"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45],{12729:(e,i,a)=>{a.d(i,{C:()=>n});var t=a(12115),l=a(38514);let n=()=>{let{data:e,isLoading:i}=(0,l.X)("Service areas"),[a,n]=(0,t.useState)([]);return(0,t.useEffect)(()=>{if(e){let i=e.map(e=>({label:e.name,id:e.uuid}));n(i),i.find(e=>"Other"===e.label)}},[e]),{serviceAreaOptions:a,serviceAreaLoading:i,serviceAreas:e}}},30045:(e,i,a)=>{a.d(i,{Ay:()=>O,wv:()=>S});var t=a(95155),l=a(88661),n=a.n(l),s=a(12115),o=a(94222),c=a(72478),r=a(263),d=a(87295),m=a(66637),u=a(5387),p=a(35068),b=a(80064),h=a(59445),_=a(25641),E=a(12729);let S={dischargeHome:{name:r.W.DISCHARGE_HOME,label:"Discharge home",groupMembersWithLabel:!0,type:"string",children:[{concept:r.W.DISCHARGE_PLAN,label:"Discharge Plan"},{concept:r.W.FOLLOWUP_PLAN,label:"Follow-Up Plan",children:[{concept:r.W.FOLLOWUP_DETAILS,label:"Follow-Up Facility"},{concept:r.W.SPECIALIST_CLINIC,label:"Clinics"}]},{concept:r.W.HOME_CARE_INSTRUCTIONS,label:"Home Care Instructions"},{concept:r.W.DISCHARGE_NOTES,label:"Discharge Notes"}]},deathOutcome:{name:r.W.DEATH,label:"Death",groupMembersWithLabel:!0,type:"string",children:[{concept:r.W.CAUSE_OF_DEATH,label:"Cause of Death"},{concept:r.W.FAMILY_INFORMED,label:"Family Informed"},{concept:r.W.RELATIONSHIP_TO_DECEASED,label:"Relationship to Deceased"},{concept:r.W.MORTUARY,label:"Mortuary"},{concept:r.W.LAST_OFFICE_CONDUCTED,label:"Last Office Conducted"},{concept:r.W.NAME_OF_HEALTH_WORKER_WHO_CONDUCTED_LAST_OFFICE,label:"Name of Health Worker Who Conducted Last Office"},{concept:r.W.DATE_OF_LAST_OFFICE,label:"Date of Last Office"}]},absconded:{name:r.W.ABSCONDED,label:"Absconded",groupMembersWithLabel:!0,type:"string",children:[{concept:r.W.LAST_SEEN_LOCATION,label:"Last Seen Location"},{concept:r.W.DATE_OF_ABSCONDING,label:"Date of Absconding"},{concept:r.W.TIME_OF_ABSCONDING,label:"Time of Absconding"}]},admission:{name:r.W.ADMISSION,groupMembersWithLabel:!0,label:"Admission",type:"string",children:[{concept:r.W.WARD,label:"Ward"},{concept:r.W.BED_NUMBER,label:"Bed number"},{concept:r.W.REASON_FOR_ADMISSION,label:"reason for admission"},{concept:r.W.SPECIALITY_DEPARTMENT,label:"Speciality Department"}]},awaitingSpeciaty:{name:r.W.AWAITING_SPECIALITY_REVIEW,label:"Awaiting specialty review",groupMembersWithLabel:!0,type:"string",children:[{concept:r.W.SPECIALITY_DEPARTMENT,label:"Speciality Department"},{concept:r.W.REASON_FOR_REQUEST,label:"Reason for Request"},{concept:r.W.DATE,label:"Date"}]},refusedTreatment:{name:r.W.REFUSED_HOSPITAL_TREATMENT,label:"Refused Hospital Treatment",type:"string",groupMembersWithLabel:!0,children:[{concept:r.W.REASON_FOR_REFUSAL,label:"Reason for refusal"},{concept:r.W.PLANS_TO_RETURN_FOR_TREATMENT,label:"Plans to return for treatment"},{concept:r.W.DATE_OF_REFUSAL,label:"Date of refusal"},{concept:r.W.WITNESS_NAME,label:"Witness name"}]},transferOut:{name:r.W.TRANSFER_OUT,label:" Transfer Out",groupMembersWithLabel:!0,children:[{concept:r.W.FACILITY_NAME,label:"Facility Name"},{concept:r.W.REASON_FOR_TRANSFER,label:"Reason for Transfer"}]}},A=p.Ik({specialistClinic:p.Yj().when("followUpPlan",{is:e=>e===r.W.YES,then:e=>e,otherwise:e=>e.optional()})}),I={dischargePlan:"",followUpPlan:"",homeCareInstructions:"",followUpDetails:"",dischargeNotes:"",specialistClinic:"",otherServiceArea:""};function O(e){let{openPatientSummary:i,setInitialNotes:a}=e,{params:l}=(0,d.KU)(),{mutate:n}=(0,m.jM)(),[p,E]=(0,s.useState)(void 0),{data:S}=(0,u.iu)(l.id),{init:A,ServerTime:I}=(0,_.useServerTime)(),[O,T]=(0,s.useState)(null),W=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(S){let e=S.find(e=>!e.date_stopped);e&&E(e)}},[S]);let x=async(e,t)=>{var s;let o=I.getServerTimeString(),c=e.specialistClinic;e.specialistClinic===O&&e.otherServiceArea&&(c=e.otherServiceArea),a({dischargeNotes:e.dischargeNotes,dischargePlan:e.dischargePlan,followUpDetails:e.followUpDetails,followUpPlan:e.followUpPlan,clinic:(null==(s=t.find(i=>i.id===e.specialistClinic))?void 0:s.label)||e.specialistClinic,homeCareInstructions:e.homeCareInstructions});let d=[{concept:r.W.DISCHARGE_HOME,value:r.W.DISCHARGE_HOME,obsDatetime:o,groupMembers:[{concept:r.W.DISCHARGE_PLAN,value:e.dischargePlan,obsDatetime:o},{concept:r.W.FOLLOWUP_PLAN,value:e.followUpPlan,obsDatetime:o},{concept:r.W.HOME_CARE_INSTRUCTIONS,value:e.homeCareInstructions,obsDatetime:o},{concept:r.W.FOLLOWUP_DETAILS,value:e.followUpDetails,obsDatetime:o},{concept:r.W.DISCHARGE_NOTES,value:e.dischargeNotes,obsDatetime:o},{concept:r.W.SPECIALIST_CLINIC,value:c||"",obsDatetime:o}]}],m={encounterType:r.fA.DISPOSITION,visit:null==p?void 0:p.uuid,patient:l.id,encounterDatetime:o,obs:d};try{await n(m),i()}catch(e){console.error("Error submitting Discharge Home information: ",e)}};(0,o.useReactToPrint)({contentRef:W});let N=[{id:"DischargeHome",title:(0,t.jsx)("h2",{children:"Discharge Home"}),content:(0,t.jsx)(D,{handleSubmit:x,setOtherId:T,otherId:O,contentRef:W})},{id:"medications",title:(0,t.jsx)("h2",{children:"Prescribe Medications"}),content:(0,t.jsx)(h.a,{})}];return(0,t.jsx)(c.Yr,{container:!0,spacing:2,children:(0,t.jsx)(c.Yr,{item:!0,xs:12,lg:12,children:(0,t.jsx)(b.M,{sections:N})})})}let D=e=>{let{handleSubmit:i,contentRef:a,setOtherId:l,otherId:o}=e,{data:m}=(0,d.WL)(),{serviceAreaOptions:u}=(0,E.C)(),[b,h]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(u){let e=u.find(e=>"Other"===e.label);l(e?e.id:null)}},[u]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.PD,{initialValues:I,validationSchema:(()=>{let e=A.clone();return o?e.shape({otherServiceArea:p.Yj().when("specialistClinic",{is:e=>e===o,then:e=>e.required("Other Service Area is required"),otherwise:e=>e.optional()})}):e})(),onSubmit:e=>i(e,u),submitButtonText:"Submit",children:e=>{var i;let{values:l,setFieldValue:n}=e;return(0,s.useEffect)(()=>{l.specialistClinic===o?h(!0):(h(!1),n("otherServiceArea",""))},[l.specialistClinic,o,n]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{ref:a,className:"jsx-7b66091306a8e529 printable-content",children:(0,t.jsxs)("div",{className:"jsx-7b66091306a8e529 print-only",children:[(0,t.jsx)(c.TF,{}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Discharge Plan:"})," ",l.dischargePlan]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Followup Plan:"})," ",l.followUpPlan]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Home care Instructions:"})," ",l.homeCareInstructions]}),l.followUpPlan===r.W.YES&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Follow up details:"})," ",l.followUpDetails]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Service Area:"})," ",l.specialistClinic===o?l.otherServiceArea:(null==(i=u.find(e=>e.id===l.specialistClinic))?void 0:i.label)||l.specialistClinic]})]}),(0,t.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,t.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Discharge notes:"})," ",l.dischargeNotes]})]})}),(0,t.jsxs)(c.Yr,{container:!0,spacing:2,children:[(0,t.jsxs)(c.Yr,{item:!0,xs:12,md:6,children:[(0,t.jsx)(c.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(c.A8,{id:"dischargeNotes",name:"dischargeNotes",label:"Discharge Notes",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write discharge notes"})}),(0,t.jsx)(c.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(c.A8,{id:"dischargePlan",name:"dischargePlan",label:"Discharge Plan (apart from the medications)",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write the discharge plan"})}),(0,t.jsx)(c.Yr,{item:!0,xs:12,children:(0,t.jsx)(c.A8,{id:"homeCareInstructions",name:"homeCareInstructions",label:"Home Care Instructions",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write specific home care instructions"})})]}),(0,t.jsxs)(c.Yr,{item:!0,xs:12,md:6,children:[(0,t.jsx)(c.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(c.b1,{name:"followUpPlan",label:"Follow-Up Plan",options:[{value:r.W.YES,label:"Yes"},{value:r.W.NO,label:"No"}]})}),l.followUpPlan===r.W.YES&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,t.jsx)(c.el,{name:"followUpDetails",label:"Follow-Up Facility",options:m?m.map(e=>({id:e.facility_name,label:e.facility_name})):[],multiple:!1})}),(0,t.jsxs)(c.Yr,{item:!0,xs:12,children:[(0,t.jsx)(c.el,{name:"specialistClinic",label:"Clinics (If applicable)",options:u,multiple:!1}),b&&(0,t.jsx)(c.A8,{id:"otherServiceArea",name:"otherServiceArea",label:"Other Service Area",sx:{mt:2,width:"100%"}})]})]})]})]})]})}}),(0,t.jsx)(n(),{id:"7b66091306a8e529",children:"@media print{.print-only.jsx-7b66091306a8e529{display:block!important}}.print-only.jsx-7b66091306a8e529{display:none}"})]})}},59445:(e,i,a)=>{a.d(i,{a:()=>f});var t=a(95155),l=a(72478),n=a(12115),s=a(95582),o=a(35068),c=a(94049),r=a(320),d=a(53206),m=a(31459),u=a(263),p=a(66637),b=a(87295),h=a(90702),_=a(60021),E=a(80064),S=a(34505),A=a(25641);let I={name:"",formulation:"",medication_dose:0,medication_dose_unit:"",medication_frequency:"",medication_duration:0,medication_duration_unit:""},O={medications:[I]},D=[{id:u.W.TABLET,label:"Tablet"},{id:u.W.VIAL,label:"Vial"},{id:u.W.INTRAVENOUS,label:"Intravenous"},{id:u.W.POWDER,label:"Powder"},{id:u.W.SOLUTION,label:"Solution"},{id:u.W.EYE_OINTMENT,label:"Eye Ointment"},{id:u.W.CREAM,label:"Cream"},{id:u.W.EYE_DROPS,label:"Eye Drops"},{id:u.W.OINTMENT,label:"Ointment"},{id:u.W.INHALER,label:"Inhaler"},{id:u.W.SUPPOSITORY,label:"Suppository"},{id:u.W.PESSARY,label:"Pessary"},{id:u.W.SUSPENSION,label:"Suspension"},{id:u.W.SHAMPOO,label:"Shampoo"},{id:u.W.EAR_DROPS,label:"Ear Drops"},{id:u.W.EYE_PASTE,label:"Eye Paste"}],T=[{id:"STAT",label:"STAT"},{id:u.W.ONCE_A_DAY,label:"24 Hourly (OD) - Once a day "},{id:u.W.TWICE_A_DAY,label:"12 Hourly (BID) - Twice a day"},{id:u.W.THREE_TIMES_A_DAY,label:"8 Hourly (TID) - Three times a day"},{id:u.W.FOUR_TIMES_A_DAY,label:"6 Hourly (QID) - Four times a day"},{id:u.W.SIX_TIMES_A_DAY,label:"4 Hourly (OD) - Six times a day "},{id:u.W.ONCE_A_WEEK,label:"Once a week"},{id:u.W.ONCE_A_MONTH,label:"Once a month"},{id:u.W.MORNING,label:"Morning"},{id:u.W.EVENING,label:"Evening"},{id:u.W.OTHER,label:"Other"}],W=o.Ik().shape({medications:o.YO().of(o.Ik().shape({name:o.Yj().required("Medication name is required"),formulation:o.Yj().required("Formulation is required"),medication_dose:o.ai().required("Dose is required").positive("Dose must be greater than 0"),medication_dose_unit:o.Yj().required("Dose unit is required"),medication_frequency:o.Yj().required("Frequency is required"),medication_duration:o.ai().required("Duration is required").positive("Duration must be greater than 0"),medication_duration_unit:o.Yj().required("Duration unit is required"),medication_date_last_taken:o.p6().nullable().required("Date of last taken is required"),medication_date_of_last_prescription:o.p6().nullable().required("Date of last prescription is required")}))}),x=["Milligrams (mg)","Micrograms (\xb5g)","Grams (g)","International Units (IU)","Milliliters (ml)","Millimoles (mmol)"],N=e=>{let{onSubmit:i,onSkip:a,encounterType:o=u.fA.DISPOSED_PRESCRIPTIONS,onSubmissionSuccess:N,medicationTitle:f="Prescribed Medication",medicationLabelTitle:j}=e,{ServerTime:g}=(0,A.useServerTime)(),{mutate:C,isPending:R,isSuccess:P}=(0,p.jM)(),{medicationOptions:y,loadingDrugs:M}=(0,S.A)(),[v,L]=(0,n.useState)({}),[F,U]=(0,n.useState)({medications:[]}),{activeVisit:w,patientId:Y}=(0,b.gd)();(0,n.useEffect)(()=>{P&&N()},[P]);let H=()=>{let e=g.getServerTimeString(),i=F.medications.map(i=>({concept:u.W.DRUG_GIVEN,value:i.name,obsDateTime:e,groupMembers:[{concept:u.W.MEDICATION_FORMULATION,value:i.formulation,obsDateTime:e},{concept:u.W.MEDICATION_DOSE,value:i.medication_dose,obsDateTime:e},{concept:u.W.MEDICATION_DOSE_UNIT,value:i.medication_dose_unit,obsDateTime:e},{concept:u.W.MEDICATION_FREQUENCY,value:i.medication_frequency,obsDateTime:e},{concept:u.W.MEDICATION_DURATION,value:i.medication_duration,obsDateTime:e},{concept:u.W.MEDICATION_DURATION_UNIT,value:i.medication_duration_unit,obsDateTime:e},{concept:u.W.DESCRIPTION,value:"current",obsDateTime:e}]}));C({encounterType:o,visit:w,patient:Y,encounterDatetime:e,obs:i})},q=[{id:"prescribed",title:f,content:(0,t.jsx)(_.Z,{medicationLabelTitle:j,encounterType:o})}];return(0,t.jsxs)(h.h,{loading:R||M,children:[(0,t.jsx)(E.M,{sections:q}),(0,t.jsx)("br",{}),(0,t.jsx)(l.PD,{initialValues:O,validationSchema:W,onSubmit:i,enableReinitialize:!0,submitButton:!1,children:e=>{let{values:i,setFieldValue:a}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.fP,{getValues:U}),(0,t.jsx)(s.ED,{name:"medications",children:e=>{let{push:n,remove:s}=e;return(0,t.jsx)(r.A,{items:i.medications,setItems:e=>a("medications",e),newItem:I,renderFields:(e,i)=>{var n;return(0,t.jsxs)(c.default,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[(0,t.jsx)(l.el,{name:"medications[".concat(i,"].name"),label:"Medication Name",options:y,getValue:e=>a("medications[".concat(i,"].name"),e),multiple:!1}),(0,t.jsx)(l.el,{name:"medications[".concat(i,"].formulation"),label:"Formulation",options:D,getValue:e=>a("medications[".concat(i,"].formulation"),e),sx:{flex:1},multiple:!1}),(0,t.jsx)(l.pj,{id:"medications[".concat(i,"].medication_dose"),label:"Dose",name:"medications[".concat(i,"].medication_dose"),unitName:"medications[".concat(i,"].medication_dose_unit"),unitOptions:x,placeholder:"e.g., 500",inputIcon:(0,t.jsx)(m.gaX,{})}),v[i]?(0,t.jsx)(l.A8,{id:"medications[".concat(i,"].medication_frequency"),name:"medications[".concat(i,"].medication_frequency"),label:"Specify frequency",sx:{flex:1}}):(0,t.jsx)(l.el,{name:"medications[".concat(i,"].medication_frequency"),label:"Frequency",options:T,getValue:e=>{"Other"===e&&L(e=>({...e,[i]:!0})),a("medications[".concat(i,"].medication_frequency"),e)},multiple:!1}),(null==F||null==(n=F.medications[i])?void 0:n.medication_frequency)!="STAT"&&(0,t.jsx)(l.pj,{id:"medications[".concat(i,"].medication_duration"),name:"medications[".concat(i,"].medication_duration"),unitName:"medications[".concat(i,"].medication_duration_unit"),label:"Duration",unitOptions:u.bH,placeholder:"e.g. 7",inputIcon:(0,t.jsx)(d.YmN,{}),sx:{flex:1}})]})}})}}),(0,t.jsx)(l.jD,{sx:{mt:"2ch"},children:(0,t.jsx)(l.O6,{sx:{m:.5},title:"Submit",type:"submit",onClick:H})})]})}})]})},f=()=>(0,t.jsx)(N,{medicationLabelTitle:"Medication to Pharmacy",medicationTitle:"Medication to Pharmacy",onSubmissionSuccess:()=>{},encounterType:u.fA.DISPOSED_PRESCRIPTIONS,onSkip:()=>{},onSubmit:()=>{}})}}]);