(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6442],{15377:(e,t,l)=>{"use strict";l.d(t,{OverlayLoader:()=>r});var n=l(95155);l(12115);var a=l(90418),s=l(89915);function r(e){let{open:t}=e;return(0,n.jsx)("div",{children:(0,n.jsx)(a.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:t,children:(0,n.jsx)(s.A,{color:"inherit"})})})}},16805:(e,t,l)=>{"use strict";l.d(t,{SE:()=>b,Nt:()=>p,Wd:()=>v});var n=l(95155),a=l(12115),s=l(84130),r=l.n(s),i=l(59487),c=l(78064),d=l(77060),o=l.n(d),u=l(23464),x=l(52269),h=l(9670),m=l(36269),f=l(21437);let j=e=>{let{getValue:t}=e,[l,s]=(0,a.useState)("http://localhost:3000"),{data:r,isLoading:i}=(0,f.Ay)();return(0,a.useEffect)(()=>{t(l)},[l]),(0,n.jsx)(m.x,{getValue:e=>{s(e)},label:"Select Printer",options:r?null==r?void 0:r.map(e=>({value:e.ip_address,label:e.name})):[]})},p=e=>{let{value:t,children:l,setTriggerFunc:s,printer:d,orderDate:o}=e,u=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=async()=>{let e=document.getElementById("barcode");e&&g("test",await c.mo(e),d)};s(()=>e)},[d]),(0,n.jsx)(i.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,n.jsx)("div",{id:"barcode",children:(0,n.jsxs)(i.jD,{sx:{pb:"8px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},ref:u,children:[l,(0,n.jsx)(r(),{width:6,height:120,margin:0,displayValue:!1,value:t})]})})})},g=async(e,t,l)=>{let n=t.toDataURL("image/png");try{let e=await o().encode(n);await u.A.post("".concat(l,"/print"),{zpl:"^XA^FO20,20".concat(e,"^XZ")})}catch(e){console.error("Error encoding image to ZPL:",e)}},v=e=>{let{presentingComplaints:t,vitals:l,date:s,arrivalTime:r,referredFrom:d,triageCategory:o,triagedBy:u}=e,[f,p]=(0,a.useState)(""),[v,b]=(0,a.useState)(""),A=async()=>{let e=document.getElementById("triage");e&&g("test",await c.mo(e),f)};return(0,n.jsxs)(x.default,{children:[(0,n.jsx)("div",{id:"triage",children:(0,n.jsx)(i.jD,{sx:{p:"5px",display:"flex",flexDirection:"column",alignItems:"center"},children:(0,n.jsxs)(x.default,{sx:{width:"100%"},children:[(0,n.jsxs)(h.default,{variant:"body2",mr:"1ch",children:["Arrival Date Time: ",r]}),(0,n.jsxs)(x.default,{sx:{display:"flex",width:"100%"},children:[(0,n.jsxs)(h.default,{variant:"body2",mr:"1ch",children:["Triage Date Time: ",s]}),(0,n.jsxs)(h.default,{variant:"body2",children:["Referred From: ",d]})]}),(0,n.jsxs)(x.default,{sx:{display:"flex"},children:[(0,n.jsxs)(h.default,{mr:"1ch",variant:"body1",children:["Category: ",o]}),(0,n.jsxs)(h.default,{variant:"body1",children:["Reason: ",v]})]}),(0,n.jsxs)(h.default,{sx:{mt:"1ch"},variant:"subtitle1",children:["Presenting Complaints: ",t," "]}),(0,n.jsx)(i.jD,{sx:{display:"flex",border:"dashed",my:"1ch"},children:l.map(e=>{let{name:t,value:l}=e;return(0,n.jsx)(y,{title:t,value:l},"".concat(l).concat(t))})}),(0,n.jsxs)(h.default,{variant:"body1",children:["Triaged By: ",u]})]})})}),(0,n.jsx)(m.x,{getValue:e=>b(e),label:"Reasons for triage category:",options:[{value:"Vitals above/below threshold",label:"Vitals above/below threshold"},{value:"Airway/Breathing compromised",label:"Airway/Breathing compromised"},{value:"Blood circulation compromised",label:"Blood circulation compromised"},{value:"Disability",label:"Disability"},{value:"Persistent pain and other concerns ",label:"Persistent pain and other concerns "}]}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(j,{getValue:e=>p(e)}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(i.O6,{onClick:A,title:"print"})]})},y=e=>{let{title:t,value:l}=e;return(0,n.jsxs)(i.jD,{sx:{mx:"0.5ch",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsx)(i.Th,{variant:"h6",textAlign:"center",children:t}),(0,n.jsx)(i.Th,{variant:"h6",children:l})]})},b=e=>{let{value:t,children:l,setTriggerFunc:s,printer:i,orderDate:d,test:o,fullName:u,gender:x,description:h}=e,m=(0,a.useRef)(null);return(0,a.useEffect)(()=>{s(async()=>{let e=document.getElementById("barcode");if(e){let t=await c.mo(e),l=document.createElement("canvas");l.width=700,l.height=160;let n=l.getContext("2d");if(n){n.fillStyle="#ffffff",n.fillRect(0,0,700,160);let e=t.width/t.height,a=700,s=700/e;s>160&&(a=(s=160)*e);let r=(700-a)/2,c=(160-s)/2;n.drawImage(t,0,0,t.width,t.height,r,c,a,s),g("test",l,i)}}})},[i,s]),(0,n.jsxs)("div",{id:"barcode",ref:m,style:{display:"flex",flexDirection:"column",paddingLeft:"5ch"},children:[(0,n.jsxs)("b",{style:{fontSize:"0.5rem",lineHeight:"1"},children:[u,"(",x,")~",h]}),(0,n.jsx)("b",{style:{fontSize:"0.5rem",lineHeight:"1"},children:d}),(0,n.jsx)(r(),{width:1,height:45,margin:0,displayValue:!1,value:t}),(0,n.jsx)("b",{style:{fontSize:"0.5rem"},children:o})]})}},31960:(e,t,l)=>{"use strict";l.d(t,{M:()=>S});var n=l(95155),a=l(70482),s=l(48576),r=l(59487),i=l(16805),c=l(9890),d=l(12115),o=l(52269),u=l(39347),x=l(29716),h=l(62966),m=l(12422),f=l(25949),j=l(72137),p=l(3967),g=l(33470),v=l(57236),y=l(78679),b=l(9670),A=l(36269),w=l(6314),I=l(21437);let S=()=>{let{data:e}=(0,I.Ay)(),t=(0,d.useRef)(null),{params:l}=(0,a.KU)(),{data:S}=(0,c.GN)(l.id),{data:C}=(0,s.RO)(null==l?void 0:l.id),[N,D]=(0,d.useState)(!1),[T,E]=(0,d.useState)({sampleType:"",ascension:"",tests:"",orderDate:"",requestingTechnician:"",description:""}),[F,O]=(0,d.useState)("http://localhost:3000"),[_,k]=(0,d.useState)(!1),[q,R]=(0,d.useState)([{name:"",value:"",testName:""}]),B=(0,d.useCallback)((e,t)=>{R(e.map(e=>({name:e.indicator.name,value:e.value,testName:t}))),k(!0)},[]),P=(0,d.useCallback)(()=>{k(!1)},[]),V=(0,d.useCallback)(e=>{t.current=e},[]),L=[{field:"specimen",headerName:"Specimen",flex:1,renderCell:e=>e.row.specimen.name},{field:"test",headerName:"Test(s)",flex:1,renderCell:e=>e.row.test.name},{field:"requesting_clinician",headerName:"Ordered By",flex:1},{field:"status",headerName:"Status",flex:1},{field:"accessionNumber",headerName:"Accession Number",flex:1,renderCell:e=>e.row.accession_number},{field:"action",headerName:"Action",flex:1,renderCell:e=>(0,n.jsx)(o.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.A,{disabled:!(e.row.test.result&&e.row.test.result.length>0),variant:"contained",onClick:()=>{B(e.row.test.result,e.row.test.name)},sx:{width:"48%",padding:"4px 8px"},children:"View"}),(0,n.jsxs)(x.A,{open:_,onClose:P,maxWidth:"sm",fullWidth:!0,children:[(0,n.jsxs)(h.A,{children:["Test results for ",q[0].testName]}),(0,n.jsx)(m.A,{children:(0,n.jsxs)(f.A,{children:[(0,n.jsx)(j.A,{children:(0,n.jsxs)(p.A,{children:[(0,n.jsx)(g.A,{children:"Measure"}),(0,n.jsx)(g.A,{children:"Result"})]})}),(0,n.jsx)(v.A,{children:q.map((e,t)=>(0,n.jsxs)(p.A,{children:[(0,n.jsx)(g.A,{children:e.name}),(0,n.jsx)(g.A,{children:e.value})]},t))})]})}),(0,n.jsx)(y.A,{children:(0,n.jsx)(u.A,{onClick:P,color:"primary",children:"Close"})})]}),(0,n.jsx)(r.O6,{title:"print",variant:"secondary",onClick:()=>{D(!0),E({sampleType:e.row.specimen.name,ascension:e.row.accession_number,orderDate:(0,w.kh)(e.row.order_date),tests:e.row.test.name,requestingTechnician:e.row.requesting_clinician,description:e.row.comment_to_fulfiller})},sx:{width:"48%",padding:"4px 8px"}})]})})}],W=(null==C?void 0:C.flatMap(e=>e.tests.map(t=>({...e,id:t.id,test:t,status:t.result?"Results Available":"Waiting for result(s)"}))))||[];return(0,n.jsxs)(n.Fragment,{children:[0===W.length?(0,n.jsx)(b.default,{children:"No lab orders added"}):(0,n.jsx)(r.WE,{height:"25ch",showTopBar:!1,rowHeight:25,rows:W,columns:L}),(0,n.jsx)(r.eV,{maxWidth:"sm",open:N,onClose:()=>D(!1),title:"Preview Barcode",children:(0,n.jsxs)(r.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsx)(i.SE,{printer:F,orderDate:T.orderDate,setTriggerFunc:V,value:T.ascension,test:"".concat(T.tests,"|").concat(T.ascension,"|").concat(T.requestingTechnician.split(" ")[1]),fullName:"".concat(null==S?void 0:S.given_name," ").concat(null==S?void 0:S.family_name),gender:null==S?void 0:S.gender,description:T.description,children:(0,n.jsx)(n.Fragment,{})}),(0,n.jsx)("br",{}),(0,n.jsx)(A.x,{getValue:e=>{O(e)},label:"Select Printer",options:e?null==e?void 0:e.map(e=>({value:e.ip_address,label:e.name})):[]}),(0,n.jsx)("br",{}),(0,n.jsx)(r.O6,{title:"Print Barcode",onClick:()=>{t.current&&"function"==typeof t.current&&(t.current(),D(!1))}})]})})]})}},36269:(e,t,l)=>{"use strict";l.d(t,{x:()=>d});var n=l(95155),a=l(99284),s=l(50095),r=l(77498),i=l(26403),c=l(12115);function d(e){let{label:t,options:l,getValue:d,defaultValue:o}=e,[u,x]=c.useState("");return(0,n.jsxs)(r.A,{size:"small",fullWidth:!0,children:[(0,n.jsx)(a.A,{id:"demo-select-small-label",children:t}),(0,n.jsx)(i.A,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:o,value:u,label:t,onChange:e=>{x(e.target.value),d&&d(e.target.value)},children:l.map(e=>(0,n.jsx)(s.A,{value:e.value,children:e.label},e.value))})]})}},39419:(e,t,l)=>{"use strict";l.d(t,{A:()=>u});var n=l(95155),a=l(15377),s=l(70482),r=l(12115),i=l(21184),c=l(59487),d=l(66766),o=l(20256);function u(e,t){return function(l){let[c,d]=(0,r.useState)(!1),{navigateTo:u}=(0,s.cq)();(0,r.useLayoutEffect)(()=>{if(localStorage)if(localStorage.getItem("accessToken")){let e=localStorage.getItem("loginTime");if(e){let t=parseInt(e);if(Math.floor((new Date().getTime()-t)%36e5/6e4)>60){d(!1),u("/"),localStorage.clear();return}}d(!0)}else d(!1),localStorage.clear(),u("/")},[]);let h=(0,i.R)(t,(0,o.O)());return c?h?(0,n.jsx)(e,{...l}):(0,n.jsx)(x,{}):(0,n.jsx)(a.OverlayLoader,{open:!c})}}let x=()=>(0,n.jsx)(c.jD,{sx:{width:"100%",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff"},children:(0,n.jsx)(d.default,{src:"/403.jpg",height:500,width:500,alt:"403"})})},48576:(e,t,l)=>{"use strict";l.d(t,{fS:()=>g,G5:()=>p,Xt:()=>f,Jl:()=>m,RO:()=>j});var n=l(23312),a=l(44919),s=l(83436);let r=e=>o(e),i=()=>o(n.W.INVESTIGATIONS),c=e=>(0,a.vt)(e,"/lab/orders"),d=e=>(0,a.UK)("/lab/orders?patient=".concat(e)),o=async e=>{let t=await (0,s.cr)(e);return(0,a.UK)("/concepts/".concat(null==t?void 0:t.data[0].uuid,"/set_members?paginate=false"))};var u=l(19373),x=l(26715),h=l(5041);let m=e=>{let t=async()=>r(e).then(e=>e.data.filter(e=>e.names.length>0&&e.names.some(e=>null==e?void 0:e.name)).map(e=>{var t;return{...e,name:null==(t=e.names.find(e=>null==e?void 0:e.name))?void 0:t.name}}).sort((e,t)=>e.name.localeCompare(t.name)));return(0,u.I)({queryKey:["testTypes",e],queryFn:t,enabled:!0})},f=()=>{let e=async()=>i().then(e=>e.data.sort((e,t)=>e.names[0].name.localeCompare(t.names[0].name)));return(0,u.I)({queryKey:["getSpecimenTypes"],queryFn:e,enabled:!0})},j=e=>{let t=async()=>d(e).then(e=>e.data);return(0,u.I)({queryKey:["patientsOrder",e],queryFn:t,enabled:!0})},p=e=>{let t=async()=>o(e).then(e=>e.data);return(0,u.I)({queryKey:["concept-setMembers",e],queryFn:t,enabled:!1})},g=e=>{let t=(0,x.jE)();return(0,h.n)({mutationFn:e=>c(e).then(e=>e.data),onSuccess:()=>{t.invalidateQueries({queryKey:["patientsOrder"]})}})}},85312:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>j});var n=l(95155),a=l(59487),s=l(23312),r=l(39419),i=l(12115),c=l(70482),d=l(33348),o=l(52269),u=l(39347),x=l(3815),h=l(3525);let m=()=>{let[e,t]=(0,i.useState)(0),{navigateBack:l}=(0,c.cq)(),{activeStep:r}=(0,i.useContext)(h.X2);return(0,i.useEffect)(()=>{t(r)},[r]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(a.RG,{setActive:t,title:"Consultation Plan",steps:[{id:12,label:"Differential Diagnosis"},{id:1,label:"Investigations"},{id:13,label:"Final Diagnosis"}],active:e,onBack:()=>l(),children:[(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.A,{conceptType:s.W.DIFFERENTIAL_DIAGNOSIS}),(0,n.jsx)(f,{onNext:()=>t(1)})]}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.$,{}),(0,n.jsx)(f,{onNext:()=>t(2),onPrevious:()=>t(0)})]}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.A,{conceptType:s.W.FINAL_DIAGNOSIS}),(0,n.jsx)(f,{onNext:()=>t(3),onPrevious:()=>t(1)})]})]})})},f=e=>{let{onPrevious:t,onNext:l}=e;return(0,n.jsxs)(o.default,{sx:{mt:"1ch"},children:[t&&(0,n.jsx)(u.A,{sx:{mr:"0.5ch"},size:"small",variant:"contained",color:"inherit",onClick:t,children:"Previous"}),l&&(0,n.jsx)(u.A,{size:"small",variant:"contained",onClick:l,children:"Next"})]})},j=(0,r.A)(function(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.TF,{}),(0,n.jsx)(a.MG,{children:(0,n.jsx)(m,{})})]})},[s.Ot.CLINICIAN,s.Ot.NURSE,s.Ot.ADMIN,s.Ot.STUDENT_CLINICIAN])},90658:(e,t,l)=>{Promise.resolve().then(l.bind(l,85312))}},e=>{var t=t=>e(e.s=t);e.O(0,[5639,16,9344,8250,2225,3740,8320,6987,2073,5062,4821,6448,7129,4536,5976,9487,8130,6044,3946,8441,1684,7358],()=>t(90658)),_N_E=e.O()}]);