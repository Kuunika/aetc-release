(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2378],{6706:(e,t,i)=>{Promise.resolve().then(i.bind(i,33910))},8155:(e,t,i)=>{"use strict";i.d(t,{c:()=>a});var n=i(95155);i(12115);var s=i(72478);let a=e=>{let{diagnoses:t}=e,i=[{field:"condition",headerName:"Diagnosis",flex:1},{field:"label",headerName:"Diagnosis Type ",flex:1,renderCell:()=>(0,n.jsx)("span",{children:"Differential Diagnosis"})},{field:"obsDatetime",headerName:"Date Recorded",flex:1,renderCell:e=>{let t=e.row.obsDatetime;return(0,n.jsx)("span",{children:t?new Date(t).toLocaleDateString():"N/A"})}}];return(0,n.jsx)(s.WE,{rows:t,columns:i,height:"400px",width:"100%",showTopBar:!1})}},33910:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});var n=i(95155),s=i(72478);i(12115);var a=i(263),r=i(36011),o=i(87295);function d(){let{params:e}=(0,o.KU)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.TF,{}),(0,n.jsxs)(s.MG,{children:[(0,n.jsx)(s.oq,{}),(0,n.jsx)(r.A,{conceptType:a.W.DIFFERENTIAL_DIAGNOSIS}),(0,n.jsx)(s.Dh,{size:"medium",sx:{fontSize:"12px",mr:"1px",mt:"1ch",float:"right"},title:"Proceed to Investigation",url:"/patient/".concat(null==e?void 0:e.id,"/investigations")})]})]})}},36011:(e,t,i)=>{"use strict";i.d(t,{A:()=>p});var n=i(95155),s=i(72478),a=i(12115),r=i(8155),o=i(25635),d=i(91871),l=i(66637),c=i(33115),u=i(87295),h=i(5387),f=i(263),x=i(25641),g=i(8282);let p=function(e){let{conceptType:t}=e,[i,p]=(0,a.useState)([]),{mutate:m,isSuccess:v,isError:y}=(0,l.jM)(),{params:D}=(0,u.KU)(),{data:j}=(0,h.GN)(D.id),[b,S]=(0,a.useState)(void 0),[w,N]=(0,a.useState)(!1),[A,I]=(0,a.useState)({}),[T,E]=(0,a.useState)(!1),{data:_}=(0,h.iu)(D.id),{data:C,refetch:O}=(0,l.$O)(D.id,"encounter_type=".concat(f.fA.OUTPATIENT_DIAGNOSIS)),{mutate:W}=(0,l.tI)(),{init:F,ServerTime:k}=(0,x.useServerTime)();return(0,a.useEffect)(()=>{if(_){let e=_.find(e=>!e.date_stopped);e&&S(e)}},[_]),(0,a.useEffect)(()=>{C&&p(C.flatMap(e=>e.obs.filter(e=>{var i;return(null==(i=e.names[0])?void 0:i.name)===t}).map(e=>{var t;return{id:e.obs_id.toString(),condition:null!=(t=e.value_text)?t:"",obsDatetime:e.obs_datetime||""}})))},[C,t]),(0,n.jsxs)(s.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(s.Yr,{item:!0,xs:12,children:(0,n.jsxs)(s.sc,{style:{padding:"20px"},children:[(0,n.jsx)(o.default,{variant:"subtitle1",style:{marginBottom:"10px",fontWeight:"500"},children:"Current Diagnosis"}),(0,n.jsx)("br",{}),(0,n.jsxs)("div",{style:{display:"flex",paddingBottom:"8px",borderBottom:"1px solid #ddd"},children:[(0,n.jsx)(o.default,{variant:"body2",style:{width:"40%",fontWeight:"500"},children:"Condition"}),(0,n.jsx)(o.default,{variant:"body2",style:{width:"25%",fontWeight:"500"},children:"Diagnosis Type"}),(0,n.jsx)(o.default,{variant:"body2",style:{width:"25%",fontWeight:"500"},children:"Date"}),(0,n.jsx)(o.default,{variant:"body2",style:{width:"10%",fontWeight:"500"},children:"Action"})]}),0===i.length?(0,n.jsx)(o.default,{variant:"body2",style:{padding:"16px",textAlign:"center",color:"gray"},children:"No Diagnosis Added"}):i.slice(-3).map(e=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",borderBottom:"1px solid #f0f0f0"},children:[(0,n.jsx)(o.default,{variant:"body2",style:{width:"40%"},children:e.condition}),(0,n.jsx)(o.default,{variant:"body2",style:{width:"25%",fontStyle:"italic"},children:t===f.W.DIFFERENTIAL_DIAGNOSIS?"Differential Diagnosis":"Final Diagnosis"}),(0,n.jsx)(o.default,{variant:"body2",style:{width:"25%"},children:new Date(e.obsDatetime).toLocaleDateString("en-GB")}),(0,n.jsx)(o.default,{variant:"body2",style:{width:"10%"},children:(0,n.jsx)(d.A,{onClick:()=>{var t;W(t=e.id,{onSuccess:()=>{p(e=>e.filter(e=>e.id!==t))},onError:()=>{console.error("Error deleting diagnosis")}})},size:"small",color:"error",variant:"text",children:"Delete"})})]},e.id)),(0,n.jsx)(o.default,{variant:"subtitle2",style:{color:"green",cursor:"pointer",marginTop:"30px"},onClick:()=>E(!T),children:T?"- Cancel New Diagnosis":"+ Add New Diagnosis"}),T&&(0,n.jsx)(g.default,{label:"Select Diagnosis",initialValue:"",onSelection:e=>{let i=k.getServerTimeString();e&&(null==b?void 0:b.uuid)?m({encounterType:f.fA.OUTPATIENT_DIAGNOSIS,visit:null==b?void 0:b.uuid,patient:D.id,encounterDatetime:i,obs:[{concept:t,value:"".concat(e.code," - ").concat(e.diagnosis),obsDatetime:i}]},{onSuccess:async()=>{await O()},onError:()=>{c.oR.error("Failed to submit diagnosis.")}}):c.oR.error("Visit information is missing, cannot add diagnosis.")},placeholder:"Start typing to search diagnoses..."})]})}),(0,n.jsx)(s.Yr,{item:!0,xs:12,children:(0,n.jsxs)(s.sc,{children:[(0,n.jsx)(o.default,{onClick:()=>N(!w),variant:"subtitle1",style:{cursor:"pointer",padding:"1ch",fontWeight:"500"},children:w?"Hide Previous Diagnosis":"Show Previous Diagnosis"}),w&&(0,n.jsx)(r.c,{diagnoses:i})]})})]})}}},e=>{e.O(0,[9503,16,9344,8250,2225,3740,2141,7861,2891,1412,4018,7774,2478,8441,1255,7358],()=>e(e.s=6706)),_N_E=e.O()}]);