(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8618],{6459:(e,t,i)=>{"use strict";i.d(t,{h:()=>r});var n=i(95155),a=i(52269),l=i(89915);let r=e=>{let{loading:t,children:i,height:r="100%"}=e;return(0,n.jsxs)(a.default,{sx:{position:"relative",width:"100%",height:r},children:[t&&(0,n.jsx)(a.default,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:1},children:(0,n.jsx)(l.A,{})}),(0,n.jsx)(a.default,{sx:{opacity:t?.5:1,pointerEvents:t?"none":"auto"},children:i})]})}},9802:(e,t,i)=>{"use strict";function n(e){let{presentingComplaints:t,diagnosis:i,labOrders:n,dischargeNotes:a,dischargePlan:l,followUpPlan:r,homeCareInstructions:s}=e,o=e=>Math.round(203*e/25.4),d=o(100),c=o(40),u=d-40,m=Math.floor(u/8),h=[{title:"Discharge Notes",content:a||"N/A"},{title:"Investigations",content:n.length?n.flatMap(e=>e.tests.map(e=>"".concat(e.name,":").concat(e.result||"pending"))).join(" ! "):"No investigations ordered"},{title:"Final Diagnosis",content:(null==i?void 0:i.length)?i.map(e=>e.value).join(" ! "):"None"},{title:"Discharge Plan",content:l||"N/A"},{title:"Follow Up Plan",content:"".concat(r)||"N/A"},{title:"Home Care Instructions",content:s||"N/A"}],p=[];h.forEach((e,t)=>{p.push({text:e.title,isTitle:!0,sectionIndex:t}),(function(e){if(!e)return[];let t=e.split(" "),i=[],n="";for(let e of t){if(e.length>m){n&&(i.push(n),n="");for(let t=0;t<e.length;t+=m){let n=e.substring(t,t+m);i.push(n)}continue}let t=n?"".concat(n," ").concat(e):e;t.length<=m?n=t:(n&&i.push(n),n=e)}return n&&i.push(n),i})(e.content).forEach(e=>{p.push({text:e,isTitle:!1,sectionIndex:t})})});let A=[],x=[],f=70;for(let e=0;e<p.length;e++){let t=p[e],i=0;if(x.length>0){let e=x[x.length-1];t.sectionIndex!==e.sectionIndex&&(i=10)}let n=i+(t.isTitle?30:25);if(f+n>c-20){if(0===x.length){x.push(t),A.push(x),x=[],f=20;continue}A.push(x),x=[],f=20,e--;continue}x.push(t),f+=n}return x.length>0&&A.push(x),A.map((e,t)=>{let i=20,n="^XA\n^PW".concat(d,"\n^LL").concat(c,"\n^CF0,25");0===t?(n+="\n^FO".concat(20,",").concat(20,"^FDPatient Summary-QECH AETC^FS\n^FO").concat(20,",").concat(60,"^GB").concat(u,",3,3^FS"),i=70):i=20;let a=-1;for(let t of e)t.sectionIndex!==a&&(-1!==a&&(i+=10),a=t.sectionIndex),t.isTitle?(n+="\n^CF0,25\n^FO".concat(20,",").concat(i,"^FD").concat(t.text,"^FS"),i+=30):(n+="\n^CF0,20\n^FO".concat(20,",").concat(i,"^FD").concat(t.text,"^FS"),i+=25);return n+"\n^XZ"}).join("\n")}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Medication Instructions",i=Math.floor(68.21428571428571),n=[],a=[],l=0,r=1;function s(e,i){let n=["^XA","^CF0,25","^FO".concat(30,",30^").concat(t).concat(i>1?" (Cont. ".concat(i,")"):"","^FS"),"^FO".concat(30,",").concat(60,"^GB").concat(955,",").concat(3,",").concat(3,"^FS")].join("\n")+"\n",a=68;for(let t of e){for(let e of t)n+="^FO".concat(30,",").concat(a,"^FD").concat(e,"^FS\n"),a+=20;a+=10}return n+"^XZ"}return e.forEach(e=>{let t=function(e){let t=e.split(" "),n=[],a="";for(let e of t)(a+" "+e).trim().length<=i?a=(a+" "+e).trim():(n.push(a),a=e);return a&&n.push(a),n}(function(e,t){let i=[e.medicationName,"".concat(e.dose," ").concat(e.doseUnits),e.frequency,e.duration,e.formulation,"(".concat(e.prescribedBy,")")].filter(Boolean).map(e=>e.replace(/[\\^]/g,""));return"".concat(t,". ").concat(i.join(" | "))}(e,r)),o=20*t.length+10;l+o>323&&(n.push(s(a,n.length+1)),a=[],l=0),a.push(t),l+=o,r++}),a.length&&n.push(s(a,n.length+1)),n.join("\n")}i.d(t,{B:()=>a,U:()=>n})},32442:(e,t,i)=>{Promise.resolve().then(i.bind(i,35686))},35686:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>z});var n=i(95155),a=i(12115),l=i(59487),r=i(37129),s=i(23312),o=i(70482),d=i(83436),c=i(9890),u=i(94518),m=i(49262),h=i(48455);let p=r.Ik({facilityName:r.Yj().required("Facility Name is required"),reason:r.Yj().required("Reason for Transfer is required")}),A={facilityName:"",reason:""};function x(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutate:r}=(0,d.jM)(),[p,A]=(0,a.useState)(void 0),{data:x}=(0,c.iu)(i.id),{ServerTime:E}=(0,m.useServerTime)();(0,a.useEffect)(()=>{if(x){let e=x.find(e=>!e.date_stopped);e&&A(e)}},[x]);let b=async e=>{let n=E.getServerTimeString(),a=[{concept:s.W.TRANSFER_OUT,value:s.W.TRANSFER_OUT,obsDatetime:n,groupMembers:[{concept:s.W.FACILITY_NAME,value:e.facilityName,obsDatetime:n},{concept:s.W.REASON_FOR_TRANSFER,value:e.reason,obsDatetime:n}]}],l={encounterType:s.fA.DISPOSITION,visit:null==p?void 0:p.uuid,patient:i.id,encounterDatetime:n,obs:a};try{await r(l),t()}catch(e){console.error("Error submitting Transfer information: ",e)}},S=[{id:"transferForm",title:(0,n.jsx)("h2",{children:"Transfer Out"}),content:(0,n.jsx)(f,{handleSubmit:b})},{id:"medication",title:(0,n.jsx)("h2",{children:"Medication"}),content:(0,n.jsx)(u.a,{})}];return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(h.M,{sections:S})})})}function f(e){let{handleSubmit:t}=e;return(0,n.jsx)(l.PD,{initialValues:A,validationSchema:p,onSubmit:t,submitButtonText:"Submit",children:(0,n.jsx)(l.sc,{sx:{p:3},children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"facilityName",name:"facilityName",label:"Facility Name",placeholder:"Enter Facility Name",sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"reason",name:"reason",label:"Reason for Transfer",placeholder:"Provide reason for transfer",rows:4,multiline:!0,sx:{width:"100%"}})})]})})})}var E=i(99724);let b=r.Ik({lastSeenLocation:r.Yj().required("Last Seen Location is required"),dateAbsconded:r.p6().required("Date of Absconding is required"),timeAbsconded:r.Yj().required("Time of Absconding is required")}),S={lastSeenLocation:"",dateAbsconded:"",timeAbsconded:""};function D(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutate:r}=(0,d.jM)(),[p,A]=(0,a.useState)(void 0),{data:x}=(0,c.iu)(i.id),{ServerTime:f}=(0,m.useServerTime)();(0,a.useEffect)(()=>{if(x){let e=x.find(e=>!e.date_stopped);e&&A(e)}},[x]);let E=async e=>{let n=f.getServerTimeString(),a=[{concept:s.W.ABSCONDED,value:s.W.ABSCONDED,obsDatetime:n,groupMembers:[{concept:s.W.LAST_SEEN_LOCATION,value:e.lastSeenLocation,obsDatetime:n},{concept:s.W.DATE_OF_ABSCONDING,value:e.dateAbsconded,obsDatetime:n},{concept:s.W.TIME_OF_ABSCONDING,value:e.timeAbsconded,obsDatetime:n}]}],l={encounterType:s.fA.DISPOSITION,visit:null==p?void 0:p.uuid,patient:i.id,encounterDatetime:n,obs:a};try{await r(l),t()}catch(e){console.error("Error submitting Absconded information: ",e)}},b=[{id:"abscondedForm",title:(0,n.jsx)("h2",{children:"Absconded Form"}),content:(0,n.jsx)(_,{handleSubmit:E})},{id:"medication",title:(0,n.jsx)("h2",{children:"Medication"}),content:(0,n.jsx)(u.a,{})}];return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(h.M,{sections:b})})})}function _(e){let{handleSubmit:t}=e;return(0,n.jsx)(l.PD,{initialValues:S,validationSchema:b,onSubmit:t,submitButtonText:"Submit",children:(0,n.jsx)(l.sc,{sx:{p:3},children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"lastSeenLocation",name:"lastSeenLocation",label:"Last Seen Location",placeholder:"Enter the last known location",sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.bZ,{name:"dateAbsconded",label:"Date of Absconding",sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.YZ,{name:"timeAbsconded",label:"Time of Absconding",sx:{width:"100%"}})})]})})})}function N(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutate:r}=(0,d.jM)(),{ServerTime:p}=(0,m.useServerTime)(),[A,x]=(0,a.useState)(void 0),{data:f}=(0,c.iu)(i.id);(0,a.useEffect)(()=>{if(f){let e=f.find(e=>!e.date_stopped);e&&x(e)}},[f]);let E=async e=>{let n=p.getServerTimeString(),a=[{concept:s.W.ADMISSION,value:s.W.ADMISSION,obsDatetime:n,groupMembers:[{concept:s.W.WARD,value:e.wardName,obsDatetime:n},{concept:s.W.BED_NUMBER,value:e.bedNumber,obsDatetime:n},{concept:s.W.REASON_FOR_ADMISSION,value:e.reasonForAdmission,obsDatetime:n},{concept:s.W.SPECIALITY_DEPARTMENT,value:e.specialtyInvolved,obsDatetime:n}]}],l={encounterType:s.fA.DISPOSITION,visit:null==A?void 0:A.uuid,patient:i.id,encounterDatetime:n,obs:a};try{await r(l),t()}catch(e){console.error("Error submitting Admission information: ",e)}},b=[{id:"admission",title:(0,n.jsx)("h2",{children:"Admission"}),content:(0,n.jsx)(O,{onSubmit:E})},{id:"medications",title:(0,n.jsx)("h2",{children:"Prescribe Medications"}),content:(0,n.jsx)(u.a,{})}];return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(h.M,{sections:b})})})}let I={wardName:"",bedNumber:"",reasonForAdmission:"",specialtyInvolved:""},j=r.Ik({wardName:r.Yj().required("Ward Name is required"),reasonForAdmission:r.Yj().required("Reason for Admission is required"),specialtyInvolved:r.Yj().required("Specialty Involved is required")}),T=[{id:s.W.ONE_A_LABOUR_WARD,label:"1A Labour ward"},{id:s.W.MAIN_LABOUR_WARD,label:"Main Labour ward"},{id:s.W.ANTENATAL_WARD,label:"Antenatal ward"},{id:s.W.POST_NATAL_WARD,label:"Post natal ward"},{id:s.W.GYNAECOLOGY_WARD_MAIN,label:"Gynaecology ward- Main"},{id:s.W.THREE_B_MALE_MEDICAL,label:"3B Male medical"},{id:s.W.THREE_B_HDU,label:"3B High Dependency Unit"},{id:s.W.MSF_WARD_GYNAECOLOGY,label:"MSF ward - Gynaecology"},{id:s.W.THREE_C_COMBINED_MALE_AND_FEMALE_MEDICAL,label:"3C Combined male and female medical"},{id:s.W.SIX_A_ORTHOPAEDIC_MALE,label:"6A Orthopaedic male"},{id:s.W.TWO_A_ONCOLOGY_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"2A Oncology Ward (General ward/High Dependency Unit)"},{id:s.W.TWO_B_RENAL_AND_DERMATOLOGY_WARD,label:"2B Renal and Dermatology Ward"},{id:s.W.SIX_A_FEMALE_ORTHOPAEDIC_WARD,label:"6A Female Orthopaedic Ward"},{id:s.W.FOUR_A_FEMALE_MEDICAL_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"4A Female Medical Ward (General ward/High Dependency Unit)"},{id:s.W.GYNECOLOGY_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"Gynecology Ward (General ward/High Dependency Unit)"},{id:s.W.LABOUR_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"Labour Ward (General ward/High Dependency Unit)"},{id:s.W.THREE_B_FEMALE_MEDICAL_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"3B Female Medical Ward (General ward/High Dependency Unit)"},{id:s.W.THREE_A_TB_WARD,label:"3A TB Ward"},{id:s.W.THREE_A_HDRU_HIGH_DEPENDENCY_RESPIRATORY_UNIT,label:"3A HDRU (High Dependency Respiratory Unit)"},{id:s.W.FIVE_A_MALE_SURGICAL_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"5A Male Surgical Ward (General ward/High Dependency Unit)"},{id:s.W.FIVE_B_FEMALE_SURGICAL_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"5B Female Surgical Ward (General ward/High Dependency Unit)"},{id:s.W.FIVE_B_ORTHOPAEDIC_WARD,label:"5B Orthopaedic Ward"},{id:s.W.FIVE_B_NEUROSURGICAL_WARD_GENERAL_WARD_HIGH_DEPENDENCY_UNIT,label:"5B Neurosurgical Ward (General ward/High Dependency Unit)"},{id:s.W.INTENSIVE_CARE_UNIT_ICU,label:"Intensive Care Unit (ICU)"},{id:s.W.THEATRE,label:"Theatre"},{id:s.W.ENT,label:"ENT"},{id:s.W.OPHTHALMOLOGY,label:"Ophthalmology"}],v=[{id:s.W.MEDICINE,label:"Medicine"},{id:s.W.GENERAL_SURGERY,label:"General Surgery"},{id:s.W.ORTHOPEDICS,label:"Orthopedics"},{id:s.W.NEUROSURGERY,label:"Neurosurgery"},{id:s.W.EAR_NOSE_AND_THROAT_ENT,label:"Ear, Nose, and Throat (ENT)"},{id:s.W.DENTAL_AND_MAXILLOFACIAL_SURGERY,label:"Dental and Maxillofacial Surgery"},{id:s.W.OPHTHALMOLOGY,label:"Ophthalmology"},{id:s.W.PSYCHIATRY,label:"Psychiatry"},{id:s.W.GYNAECOLOGY_AND_OBSTETRICS,label:"Gynecology and Obstetrics"},{id:s.W.CRITICAL_CARE,label:"Critical Care"},{id:s.W.ONCOLOGY,label:"Oncology"}];function O(e){let{onSubmit:t}=e,{gender:i}=(0,o.gd)(),[r,s]=(0,a.useState)(T);return(0,a.useEffect)(()=>{let e=["6A Female Orthopaedic Ward","4A Female Medical Ward (General ward/High Dependency Unit)","Gynecology Ward (General ward/High Dependency Unit)","Labour Ward (General ward/High Dependency Unit)","3B Female Medical Ward (General ward/High Dependency Unit)","5B Female Surgical Ward (General ward/High Dependency Unit)"];"Male"===i?s(T.filter(t=>!e.includes(t.label))):s(T)},[i]),(0,n.jsx)(l.PD,{initialValues:I,validationSchema:j,onSubmit:t,submitButtonText:"Submit",children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.Yr,{item:!0,xs:12,lg:6,children:(0,n.jsx)(l.el,{name:"wardName",label:"Ward Name",options:r,multiple:!1})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,lg:6,children:(0,n.jsx)(l.A8,{id:"bedNumber",name:"bedNumber",label:"Bed Number",placeholder:"Enter Bed Number",sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"reasonForAdmission",name:"reasonForAdmission",label:"Reason for Admission",placeholder:"Provide reason for admission",rows:4,multiline:!0,sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.el,{name:"specialtyInvolved",label:"Specialty Involved",options:v,multiple:!1})})]})})}let R=[{id:s.W.MEDICINE,label:"Medicine"},{id:s.W.GENERAL_SURGERY,label:"General Surgery"},{id:s.W.ORTHOPEDICS,label:"Orthopedics"},{id:s.W.NEUROSURGERY,label:"Neurosurgery"},{id:s.W.EAR_NOSE_AND_THROAT_ENT,label:"Ear, Nose, and Throat (ENT)"},{id:s.W.DENTAL_AND_MAXILLOFACIAL_SURGERY,label:"Dental and Maxillofacial Surgery"},{id:s.W.OPHTHALMOLOGY,label:"Ophthalmology"},{id:s.W.PSYCHIATRY,label:"Psychiatry"},{id:s.W.GYNAECOLOGY_AND_OBSTETRICS,label:"Gynecology and Obstetrics"},{id:s.W.CRITICAL_CARE,label:"Critical Care"},{id:s.W.ONCOLOGY,label:"Oncology"}],W=r.Ik({specialtyDepartment:r.Yj().required("Specialty Department is required"),reasonForReview:r.Yj().required("Reason for Review is required"),reviewDate:r.p6().required("Date Scheduled for Review is required")}),g={specialtyDepartment:"",reasonForReview:"",reviewDate:""};function y(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutateAsync:r}=(0,d.jM)(),[p,A]=(0,a.useState)(void 0),{data:x}=(0,c.iu)(i.id),{init:f,ServerTime:E}=(0,m.useServerTime)(),{navigateTo:b}=(0,o.cq)();(0,a.useEffect)(()=>{if(x){let e=x.find(e=>!e.date_stopped);e&&A(e)}},[x]);let S=async e=>{let t=E.getServerTimeString(),n=[{concept:s.W.AWAITING_SPECIALITY_REVIEW,value:s.W.AWAITING_SPECIALITY_REVIEW,obsDatetime:t,groupMembers:[{concept:s.W.SPECIALITY_DEPARTMENT,value:e.specialtyDepartment,obsDatetime:t},{concept:s.W.REASON_FOR_REQUEST,value:e.reasonForReview,obsDatetime:t},{concept:s.W.DATE,value:e.reviewDate,obsDatetime:t}]}],a={encounterType:s.fA.AWAITING_SPECIALTY,visit:null==p?void 0:p.uuid,patient:i.id,encounterDatetime:t,obs:n};try{await r(a),b("/awaiting-specialty")}catch(e){console.error("Error submitting Awaiting Speciality Review info:",e)}},D=[{id:"awaitingSpecialty",title:(0,n.jsx)("h2",{children:"Awaiting Specialty Review"}),content:(0,n.jsx)(C,{onSubmit:S})},{id:"medications",title:(0,n.jsx)("h2",{children:"Prescribe Medications"}),content:(0,n.jsx)(u.a,{})}];return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(h.M,{sections:D})})})}function C(e){let{onSubmit:t}=e;return(0,n.jsx)(l.sc,{sx:{p:3},children:(0,n.jsx)(l.PD,{initialValues:g,validationSchema:W,onSubmit:t,submitButtonText:"Submit",children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.el,{name:"specialtyDepartment",label:"Specialty Department",options:R,multiple:!1})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"reasonForReview",name:"reasonForReview",label:"Reason for Review",sx:{width:"100%"},multiline:!0,rows:4,placeholder:"Provide reason for review"})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.bZ,{name:"reviewDate",label:"Date Scheduled for Review",sx:{width:"100%"}})})]})})})}let F=[{id:s.W.QECH,label:"QECH"},{id:s.W.COM,label:"COM"},{id:s.W.MTHUNZI,label:"Mthunzi"},{id:s.W.OTHER,label:"Other (Specify)"}],Y=[{id:s.W.RELATIONSHIP_SPOUSE,label:"Spouse"},{id:s.W.RELATIONSHIP_PARENT,label:"Parent"},{id:s.W.RELATIONSHIP_SIBLING,label:"Sibling"},{id:s.W.RELATIONSHIP_UNCLE,label:"Uncle"},{id:s.W.RELATIONSHIP_COUSIN,label:"Cousin"},{id:s.W.RELATIONSHIP_OTHER,label:"Other"}],w=r.Ik({causeOfDeath:r.Yj().required("Cause of Death is required"),familyInformed:r.Yj().required("Please specify if family has been informed"),relationshipToDeceased:r.Yj().required("Relationship to Deceased is required"),mortuary:r.Yj().required("Mortuary is required"),lastOfficeConducted:r.Yj().required("Last office status is required"),healthWorkerName:r.Yj().required("Name of health worker is required"),lastOfficeDate:r.p6().required("Date and Time of Last Office is required")}),P={causeOfDeath:"",familyInformed:"",relationshipToDeceased:"",mortuary:"",lastOfficeConducted:"",healthWorkerName:"",lastOfficeDate:""};function L(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutate:r}=(0,d.jM)(),[p,A]=(0,a.useState)(void 0),{data:x}=(0,c.iu)(i.id),{ServerTime:f}=(0,m.useServerTime)();(0,a.useEffect)(()=>{if(x){let e=x.find(e=>!e.date_stopped);e&&A(e)}},[x]);let E=async e=>{let n=f.getServerTimeString(),a=[{concept:s.W.DEATH,value:s.W.DEATH,obsDatetime:n,groupMembers:[{concept:s.W.CAUSE_OF_DEATH,value:e.causeOfDeath,obsDatetime:n},{concept:s.W.FAMILY_INFORMED,value:e.familyInformed,obsDatetime:n},{concept:s.W.RELATIONSHIP_TO_DECEASED,value:e.relationshipToDeceased,obsDatetime:n},{concept:s.W.MORTUARY,value:e.mortuary,obsDatetime:n},{concept:s.W.LAST_OFFICE_CONDUCTED,value:e.lastOfficeConducted,obsDatetime:n},{concept:s.W.NAME_OF_HEALTH_WORKER_WHO_CONDUCTED_LAST_OFFICE,value:e.healthWorkerName,obsDatetime:n},{concept:s.W.DATE_OF_LAST_OFFICE,value:e.lastOfficeDate,obsDatetime:n}]}],l={encounterType:s.fA.DISPOSITION,visit:null==p?void 0:p.uuid,patient:i.id,encounterDatetime:n,obs:a};try{await r(l),t()}catch(e){console.error("Error submitting Death form information: ",e)}},b=[{id:"deathForm",title:(0,n.jsx)("h2",{children:"Death Form"}),content:(0,n.jsx)(M,{handleSubmit:E})},{id:"medication",title:(0,n.jsx)("h2",{children:"Medication"}),content:(0,n.jsx)(u.a,{})}];return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(h.M,{sections:b})})})}function M(e){let{handleSubmit:t}=e;return(0,n.jsx)(l.PD,{initialValues:P,validationSchema:w,onSubmit:t,submitButtonText:"Submit",children:(0,n.jsx)(l.sc,{sx:{p:3},children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"causeOfDeath",name:"causeOfDeath",label:"Cause of Death",placeholder:"Enter the cause of death",rows:4,multiline:!0,sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.b1,{name:"familyInformed",label:"Has the family been informed?",options:[{value:s.W.YES,label:"Yes"},{value:s.W.NO,label:"No"}]})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.el,{name:"relationshipToDeceased",label:"If yes, relationship to deceased",options:Y,sx:{width:"100%"},multiple:!1})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.el,{name:"mortuary",label:"Mortuary to take the deceased",options:F,sx:{width:"100%"},multiple:!1})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.b1,{name:"lastOfficeConducted",label:"Was the last office conducted?",options:[{value:s.W.YES,label:"Yes"},{value:s.W.NO,label:"No"}]})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.A8,{id:"healthWorkerName",name:"healthWorkerName",label:"Name of Health Worker who conducted the last office",placeholder:"Enter health worker's name",sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,md:6,children:(0,n.jsx)(l.bZ,{name:"lastOfficeDate",label:"Date of Last Office",sx:{width:"100%"}})})]})})})}let U=r.Ik({reasonForRefusal:r.Yj().required("Reason for refusal is required"),plansToReturn:r.Yj().required("Please select plans to return for treatment"),dateOfRefusal:r.p6().required("Date of refusal is required"),witnessName:r.Yj().required("Witness name is required")}),H={reasonForRefusal:"",plansToReturn:"",dateOfRefusal:"",witnessName:""};function G(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutate:r}=(0,d.jM)(),[p,A]=(0,a.useState)(void 0),{data:x}=(0,c.iu)(i.id),{ServerTime:f}=(0,m.useServerTime)();(0,a.useEffect)(()=>{if(x){let e=x.find(e=>!e.date_stopped);e&&A(e)}},[x]);let E=async e=>{let n=f.getServerTimeString(),a=[{concept:s.W.REFUSED_HOSPITAL_TREATMENT,value:s.W.REFUSED_HOSPITAL_TREATMENT,obsDatetime:n,groupMembers:[{concept:s.W.REASON_FOR_REFUSAL,value:e.reasonForRefusal,obsDatetime:n},{concept:s.W.PLANS_TO_RETURN_FOR_TREATMENT,value:e.plansToReturn,obsDatetime:n},{concept:s.W.DATE_OF_REFUSAL,value:e.dateOfRefusal,obsDatetime:n},{concept:s.W.WITNESS_NAME,value:e.witnessName,obsDatetime:n}]}],l={encounterType:s.fA.DISPOSITION,visit:null==p?void 0:p.uuid,patient:i.id,encounterDatetime:n,obs:a};try{await r(l),t()}catch(e){console.error("Error submitting Refused Treatment information: ",e)}},b=[{id:"refusedForm",title:(0,n.jsx)("h2",{children:"Refused Treatment Form"}),content:(0,n.jsx)(q,{handleSubmit:E})},{id:"medication",title:(0,n.jsx)("h2",{children:"Medication"}),content:(0,n.jsx)(u.a,{})}];return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(h.M,{sections:b})})})}function q(e){let{handleSubmit:t}=e;return(0,n.jsx)(l.PD,{initialValues:H,validationSchema:U,onSubmit:t,submitButtonText:"Submit",children:(0,n.jsx)(l.sc,{sx:{p:3},children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.A8,{id:"reasonForRefusal",name:"reasonForRefusal",label:"Reason for Refusal",placeholder:"Enter the reason for refusal",multiline:!0,rows:3,sx:{width:"100%"}}),(0,n.jsx)(l.b1,{name:"plansToReturn",label:"Plans to Return for Treatment",options:[{value:s.W.YES,label:"Yes"},{value:s.W.NO,label:"No"}],sx:{width:"100%"}}),(0,n.jsx)(l.bZ,{name:"dateOfRefusal",label:"Date of Refusal",width:"100%",sx:{my:"1rem"}}),(0,n.jsx)(l.A8,{id:"witnessName",name:"witnessName",label:"Witness Name",placeholder:"Enter name of witness",sx:{width:"100%"}})]})})})}var B=i(75363);let k=[{value:s.W.YES,label:"Yes"},{value:s.W.NO,label:"No"}],V=r.Ik({expectedDuration:r.ai().min(1,"Duration must be at least 1 hour").required("Expected Duration is required"),vitalSignsMonitoring:r.Yj().required("Vital Signs Monitoring option is required"),additionalNotes:r.Yj()}),K={expectedDuration:"",vitalSignsMonitoring:"",additionalNotes:""};function X(e){let{openPatientSummary:t}=e,{params:i}=(0,o.KU)(),{mutate:r}=(0,d.jM)(),[h,p]=(0,a.useState)(void 0),{data:A}=(0,c.iu)(i.id),{mutate:x,isSuccess:f}=(0,B.FD)(),{navigateTo:E}=(0,o.cq)(),{init:b,ServerTime:S}=(0,m.useServerTime)();(0,a.useEffect)(()=>{if(A){let e=A.find(e=>!e.date_stopped);e&&p(e)}},[A]);let D=async e=>{let n=S.getServerTimeString(),a=[{concept:s.W.SHORT_STAY,value:s.W.SHORT_STAY,obsDatetime:n,groupMembers:[{concept:s.W.EXPECTED_DURATION,value:e.expectedDuration,obsDatetime:n},{concept:s.W.VITAL_SIGNS,value:e.vitalSignsMonitoring,obsDatetime:n},{concept:s.W.SOAP_NOTES,value:e.additionalNotes,obsDatetime:n}]}],l={encounterType:s.fA.DISPOSITION,visit:null==h?void 0:h.uuid,patient:i.id,encounterDatetime:n,obs:a};try{await r(l),t()}catch(e){console.error("Error submitting Short Stay information: ",e)}};return(0,n.jsx)(l.Yr,{container:!0,spacing:2,children:(0,n.jsxs)(l.Yr,{item:!0,xs:12,lg:8,children:[(0,n.jsx)(u.a,{}),(0,n.jsxs)(l.sc,{sx:{p:3},children:[(0,n.jsx)("h2",{children:"2. Short Stay Form"}),(0,n.jsx)(l.PD,{initialValues:K,validationSchema:V,onSubmit:D,submitButtonText:"Submit",children:(0,n.jsxs)(l.Yr,{container:!0,spacing:2,children:[(0,n.jsx)(l.Yr,{item:!0,xs:12,lg:6,children:(0,n.jsx)(l.A8,{id:"expectedDuration",name:"expectedDuration",label:"Expected Duration (in hours)",placeholder:"e.g., 2",type:"number",sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,lg:6,children:(0,n.jsx)(l.b1,{name:"vitalSignsMonitoring",label:"Will include vital signs monitoring?",options:k,sx:{width:"100%"}})}),(0,n.jsx)(l.Yr,{item:!0,xs:12,children:(0,n.jsx)(l.A8,{id:"additionalNotes",name:"additionalNotes",label:"Additional Notes (SOAP/Continuation Sheets)",placeholder:"Enter additional notes or observations",rows:4,multiline:!0,sx:{width:"100%"}})})]})})]})]})})}var Q=i(66597);let Z=[{id:s.W.DISCHARGE_HOME,label:"Discharge home"},{id:s.W.ADMISSION,label:"Admission"},{id:s.W.AWAITING_SPECIALITY_REVIEW,label:"Awaiting specialty review"},{id:s.W.DEATH,label:"Death"},{id:s.W.ABSCONDED,label:"Absconded"},{id:s.W.REFUSED_HOSPITAL_TREATMENT,label:"Refused hospital treatment"},{id:s.W.TRANSFER_OUT,label:"Transfer Out"}],z=function(){let{navigateTo:e}=(0,o.cq)(),[t,i]=(0,a.useState)({dischargeNotes:"",dischargePlan:"",followUpDetails:"",followUpPlan:"",clinic:"",homeCareInstructions:""}),[r,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),m=()=>{d(!0)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.TF,{}),(0,n.jsx)(l.oq,{}),(0,n.jsxs)(l.Yr,{container:!0,spacing:2,mt:"2ch",sx:{ml:16},children:[(0,n.jsx)(Q.p,{initialNotes:t,onClose:()=>e("/dispositions"),open:r}),(0,n.jsx)(l.Yr,{item:!0,xs:12,lg:9,children:(0,n.jsxs)(l.sc,{elevation:0,sx:{p:"1ch"},children:[(0,n.jsx)("h2",{children:"Disposition"}),(0,n.jsxs)("select",{value:c||"",onChange:e=>u(e.target.value),style:{padding:"8px",width:"100%",marginBottom:"20px",fontSize:"16px"},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Select Disposition Option"}),Z.map(e=>(0,n.jsx)("option",{value:e.id,children:e.label},e.id))]}),(0,n.jsx)("div",{style:{marginTop:"20px"},children:(()=>{switch(c){case s.W.DISCHARGE_HOME:return(0,n.jsx)(E.Ay,{setInitialNotes:i,openPatientSummary:m});case s.W.AWAITING_SPECIALITY_REVIEW:return(0,n.jsx)(y,{openPatientSummary:m});case s.W.ADMISSION:return(0,n.jsx)(N,{openPatientSummary:m});case s.W.SHORT_STAY:return(0,n.jsx)(X,{openPatientSummary:m});case s.W.TRANSFER_OUT:return(0,n.jsx)(x,{openPatientSummary:m});case s.W.DEATH:return(0,n.jsx)(L,{openPatientSummary:m});case s.W.ABSCONDED:return(0,n.jsx)(D,{openPatientSummary:m});case s.W.REFUSED_HOSPITAL_TREATMENT:return(0,n.jsx)(G,{openPatientSummary:m});default:return null}})()})]})})]})]})}},36269:(e,t,i)=>{"use strict";i.d(t,{x:()=>d});var n=i(95155),a=i(99284),l=i(50095),r=i(77498),s=i(26403),o=i(12115);function d(e){let{label:t,options:i,getValue:d,defaultValue:c}=e,[u,m]=o.useState("");return(0,n.jsxs)(r.A,{size:"small",fullWidth:!0,children:[(0,n.jsx)(a.A,{id:"demo-select-small-label",children:t}),(0,n.jsx)(s.A,{labelId:"demo-simple-select-label",id:"demo-simple-select",defaultValue:c,value:u,label:t,onChange:e=>{m(e.target.value),d&&d(e.target.value)},children:i.map(e=>(0,n.jsx)(l.A,{value:e.value,children:e.label},e.value))})]})}},40700:(e,t,i)=>{"use strict";i.d(t,{Z:()=>p});var n=i(95155),a=i(6459),l=i(47292),r=i(23312),s=i(34801),o=i(1532),d=i(9802),c=i(70482),u=i(83436),m=i(39347),h=i(12115);let p=e=>{let{setRow:t,encounterType:i=r.fA.PRESCRIPTIONS,medicationLabelTitle:p,showPrintButton:A=!0}=e,{patientId:x,activeVisitId:f}=(0,c.gd)(),{setZpl:E,setOpen:b}=(0,s.m)(),{selectedVisit:S}=(0,o.E)(),{data:D,isPending:_}=(0,u.$O)(x,"encounter_type=".concat(i,"&visit=").concat(null==S?void 0:S.uuid)),[N,I]=(0,h.useState)([]),j=(e,t)=>{var i,n;return null==e||null==(n=e.children)||null==(i=n.find(e=>e.names&&e.names[0].name==t))?void 0:i.value};return(0,h.useEffect)(()=>{var e;let t=null==D?void 0:D.filter(e=>e.visit_id==Number(f));if(!t||0==t.length)return void I([]);I(null==(e=t[0])?void 0:e.obs.filter(e=>(null==e?void 0:e.names)&&(null==e?void 0:e.names[0].name)==r.W.DRUG_GIVEN).map(e=>{let t=j(e,r.l8.MEDICATION_DURATION_UNIT),i=j(e,r.W.MEDICATION_DOSE),n=j(e,r.l8.DESCRIPTION),a=j(e,r.l8.MEDICATION_FORMULATION),l=j(e,r.l8.MEDICATION_DOSE_UNIT),s=j(e,r.l8.MEDICATION_FREQUENCY),o=j(e,r.l8.MEDICATION_DURATION)+" "+t,d=e.value_coded_uuid;return{medicationName:e.value,durationUnit:t,dose:i,doseUnits:l,frequency:s,duration:o,formulation:a,description:n,prescribedBy:e.created_by,medicationUUID:d}}).filter(e=>"current"==e.description))},[D]),(0,n.jsxs)(a.h,{loading:_,children:[A&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.A,{onClick:()=>{let e=(0,d.B)(N,p);b(e),E(e)},variant:"contained",children:"Print Medications"}),(0,n.jsx)("br",{})]}),(0,n.jsx)(l.q,{getSelectedRow:t,columns:[{label:"Medication Name",field:"medicationName"},{label:"Dose",field:"dose"},{label:"Frequency",field:"frequency"},{label:"Duration",field:"duration"},{label:"Formulation",field:"formulation"},{label:"Prescriber",field:"prescribedBy"}],data:N})]})}},47292:(e,t,i)=>{"use strict";i.d(t,{q:()=>S});var n=i(95155);i(12115);var a=i(15876),l=i(25949),r=i(33470),s=i(3967),o=i(72137),d=i(57236),c=i(89915),u=i(26096),m=i(53494),h=i(35881);let p=(0,h.Ay)(a.A)(e=>{let{theme:t}=e;return{borderRadius:t.shape.borderRadius,overflow:"auto",maxHeight:"400px",minHeight:"95px",boxShadow:t.shadows[3],position:"relative"}}),A=(0,h.Ay)(l.A)(e=>{let{theme:t}=e;return{borderCollapse:"separate",borderSpacing:"0px 4px"}}),x=(0,h.Ay)(r.A)(e=>{let{theme:t}=e;return{fontWeight:500,padding:"12px 16px",borderBottom:"none",color:t.palette.text.primary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"200px"}}),f=(0,h.Ay)(x)(e=>{let{theme:t}=e;return{fontSize:"0.9rem",fontWeight:"bold",backgroundColor:t.palette.background.default,textTransform:"uppercase"}}),E=(0,h.Ay)(s.A)(e=>{let{theme:t}=e;return{backgroundColor:"#fff",borderRadius:"8px",transition:"background 0.2s ease-in-out","&:hover":{backgroundColor:t.palette.grey[100]},boxShadow:t.shadows[1]}}),b=(0,h.Ay)("div")(e=>{let{theme:t}=e;return{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:1}}),S=e=>{let{columns:t,data:i,actions:a=!1,getSelectedRow:l,loading:h=!1}=e;return(0,n.jsx)(p,{children:(0,n.jsxs)(A,{stickyHeader:!0,children:[(0,n.jsx)(o.A,{children:(0,n.jsxs)(s.A,{children:[t.map((e,t)=>(0,n.jsx)(f,{children:e.label},t)),a&&(0,n.jsx)(f,{children:"Actions"})]})}),(0,n.jsx)(d.A,{children:h?(0,n.jsx)(s.A,{children:(0,n.jsx)(r.A,{colSpan:t.length+ +!!a,children:(0,n.jsx)(b,{children:(0,n.jsx)(c.A,{})})})}):i.map((e,i)=>(0,n.jsxs)(E,{onClick:()=>l&&l(e),children:[t.map((t,i)=>(0,n.jsx)(u.A,{title:e[t.field],arrow:!0,children:(0,n.jsx)(x,{children:e[t.field]})},i)),a&&(0,n.jsxs)(x,{children:[(0,n.jsx)(m.default,{"aria-label":"edit",color:"primary",size:"small"}),(0,n.jsx)(m.default,{"aria-label":"delete",color:"secondary",size:"small"})]})]},i))})]})})}},48455:(e,t,i)=>{"use strict";i.d(t,{M:()=>c});var n=i(95155),a=i(12115),l=i(50532),r=i(90912),s=i(98358),o=i(9670),d=i(33881);function c(e){let{sections:t}=e,[i,c]=a.useState(!1),u=e=>(t,i)=>{c(!!i&&e)};return(0,n.jsx)("div",{children:t.map(e=>{let{id:t,title:a,content:c}=e;return(0,n.jsxs)(l.A,{expanded:i===t,onChange:u(t),children:[(0,n.jsx)(s.A,{expandIcon:(0,n.jsx)(d.Odn,{}),"aria-controls":"".concat(t,"-content"),id:"".concat(t,"-header"),children:(0,n.jsx)(o.default,{sx:{width:"33%",flexShrink:0,fontWeight:600},children:a})}),(0,n.jsx)(r.A,{children:c})]},t)})})}},48576:(e,t,i)=>{"use strict";i.d(t,{fS:()=>E,G5:()=>f,Xt:()=>A,Jl:()=>p,RO:()=>x});var n=i(23312),a=i(44919),l=i(83436);let r=e=>c(e),s=()=>c(n.W.INVESTIGATIONS),o=e=>(0,a.vt)(e,"/lab/orders"),d=e=>(0,a.UK)("/lab/orders?patient=".concat(e)),c=async e=>{let t=await (0,l.cr)(e);return(0,a.UK)("/concepts/".concat(null==t?void 0:t.data[0].uuid,"/set_members?paginate=false"))};var u=i(19373),m=i(26715),h=i(5041);let p=e=>{let t=async()=>r(e).then(e=>e.data.filter(e=>e.names.length>0&&e.names.some(e=>null==e?void 0:e.name)).map(e=>{var t;return{...e,name:null==(t=e.names.find(e=>null==e?void 0:e.name))?void 0:t.name}}).sort((e,t)=>e.name.localeCompare(t.name)));return(0,u.I)({queryKey:["testTypes",e],queryFn:t,enabled:!0})},A=()=>{let e=async()=>s().then(e=>e.data.sort((e,t)=>e.names[0].name.localeCompare(t.names[0].name)));return(0,u.I)({queryKey:["getSpecimenTypes"],queryFn:e,enabled:!0})},x=e=>{let t=async()=>d(e).then(e=>e.data);return(0,u.I)({queryKey:["patientsOrder",e],queryFn:t,enabled:!0})},f=e=>{let t=async()=>c(e).then(e=>e.data);return(0,u.I)({queryKey:["concept-setMembers",e],queryFn:t,enabled:!1})},E=e=>{let t=(0,m.jE)();return(0,h.n)({mutationFn:e=>o(e).then(e=>e.data),onSuccess:()=>{t.invalidateQueries({queryKey:["patientsOrder"]})}})}},50485:(e,t,i)=>{"use strict";i.d(t,{P:()=>r});var n=i(95155),a=i(36269),l=i(21437);let r=e=>{let{setPrinter:t}=e,{data:i,isLoading:r}=(0,l.Ay)();return(0,n.jsx)(a.x,{getValue:e=>{t(e)},label:"Select Printer",options:i?null==i?void 0:i.map(e=>({value:e.ip_address,label:e.name})):[]})}},66597:(e,t,i)=>{"use strict";i.d(t,{p:()=>D});var n=i(95155),a=i(59487),l=i(50485),r=i(23312),s=i(1532),o=i(53988),d=i(9802),c=i(70482),u=i(83436),m=i(48576),h=i(67569),p=i(80158),A=i(52269),x=i(9670),f=i(3951),E=i(39347),b=i(23464),S=i(12115);let D=e=>{let{onClose:t,open:i,initialNotes:D}=e,{params:_}=(0,c.KU)(),[N,I]=(0,S.useState)([]),[j,T]=(0,S.useState)([]),[v,O]=(0,S.useState)([]),[R,W]=(0,S.useState)(""),{selectedVisit:g}=(0,s.E)(),[y,C]=(0,S.useState)({dischargeNotes:"",dischargePlan:"",followUpDetails:"",followUpPlan:"",clinic:"",homeCareInstructions:""}),{data:F}=(0,u.$O)(null==_?void 0:_.id,"encounter_type=".concat(r.fA.PRESENTING_COMPLAINTS)),{data:Y}=(0,u.$O)(null==_?void 0:_.id,"encounter_type=".concat(r.fA.OUTPATIENT_DIAGNOSIS)),{data:w}=(0,u.$O)(null==_?void 0:_.id,"encounter_type=".concat(r.fA.DISPOSITION)),{data:P}=(0,m.RO)(null==_?void 0:_.id);(0,S.useEffect)(()=>{if(Y){var e,t;I(null==Y||null==(t=Y.filter(e=>e.visit_id==g.id)[0])||null==(e=t.obs)?void 0:e.filter(e=>e.names.find(e=>e.name===r.W.FINAL_DIAGNOSIS)))}},[Y,g]),(0,S.useEffect)(()=>{P&&O(P)},[P]),(0,S.useEffect)(()=>{if(F){var e;T(null==(e=F.filter(e=>e.visit_id==g.id)[0])?void 0:e.obs)}},[F,g]),(0,S.useEffect)(()=>{if(D)return void C(D);if(w){var e;let t=null==(e=w.filter(e=>e.visit_id==g.id)[0])?void 0:e.obs.find(e=>e.names.find(e=>e.name==r.W.DISCHARGE_HOME)),i=(0,o.m)(null==t?void 0:t.children,r.W.DISCHARGE_NOTES),n=(0,o.m)(null==t?void 0:t.children,r.W.DISCHARGE_PLAN),a=(0,o.m)(null==t?void 0:t.children,r.W.FOLLOWUP_DETAILS),l=(0,o.m)(null==t?void 0:t.children,r.W.FOLLOWUP_PLAN),s=(0,o.m)(null==t?void 0:t.children,r.W.SPECIALIST_CLINIC),d=(0,o.m)(null==t?void 0:t.children,r.W.HOME_CARE_INSTRUCTIONS);(async()=>{var e;let t=await (0,u.cr)(s);C({dischargeNotes:i,dischargePlan:n,followUpDetails:a,followUpPlan:l,clinic:null==t||null==(e=t.data[0])?void 0:e.short_name,homeCareInstructions:d})})()}},[w,g]);let L=async()=>{let e=(0,d.U)({presentingComplaints:j,diagnosis:N,labOrders:v,dischargeNotes:y.dischargeNotes,dischargePlan:y.dischargePlan,followUpPlan:"".concat(y.followUpDetails," | ").concat(y.clinic),homeCareInstructions:y.homeCareInstructions});await b.A.post("".concat(R,"/print"),{zpl:e}),t()};return(0,n.jsxs)(a.eV,{title:"Patient Summary-QECH AETC",onClose:()=>{},open:i,children:[(0,n.jsxs)(h.A,{spacing:3,children:[(0,n.jsx)(p.A,{}),(0,n.jsxs)(A.default,{children:[(0,n.jsx)(x.default,{variant:"h6",children:"Final Diagnosis"}),(0,n.jsx)(h.A,{spacing:1,mt:1,children:null==N?void 0:N.map((e,t)=>(0,n.jsx)(x.default,{children:e.value},"diagnosis-".concat(t)))})]}),(0,n.jsx)(p.A,{}),(0,n.jsxs)(A.default,{children:[(0,n.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Lab Investigations"}),(0,n.jsxs)(f.default,{container:!0,spacing:2,sx:{fontWeight:"bold",mb:1},children:[(0,n.jsx)(f.default,{item:!0,xs:4,children:"Specimen"}),(0,n.jsx)(f.default,{item:!0,xs:4,children:"Test"}),(0,n.jsx)(f.default,{item:!0,xs:4,children:"Result"})]}),v.map((e,t)=>{var i;return null==e||null==(i=e.tests)?void 0:i.map((i,a)=>{var l;return(0,n.jsxs)(f.default,{container:!0,spacing:2,children:[(0,n.jsx)(f.default,{item:!0,xs:4,children:(null==(l=e.specimen)?void 0:l.name)||"N/A"}),(0,n.jsx)(f.default,{item:!0,xs:4,children:i.name}),(0,n.jsx)(f.default,{item:!0,xs:4,children:i.result||"Pending"})]},"order-".concat(t,"-test-").concat(a))})})]}),(0,n.jsx)(p.A,{}),!!y.dischargeNotes&&(0,n.jsxs)(A.default,{children:[(0,n.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Discharge Notes"}),(0,n.jsx)(x.default,{children:y.dischargeNotes})]}),!!y.dischargePlan&&(0,n.jsxs)(A.default,{children:[(0,n.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Discharge Plan"}),(0,n.jsx)(x.default,{children:y.dischargePlan})]}),!!y.followUpPlan&&"Yes"==y.followUpPlan&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(A.default,{children:[(0,n.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Follow up Plan"}),(0,n.jsxs)(x.default,{children:[y.followUpDetails," ~ ",y.clinic]})]})}),!!y.homeCareInstructions&&(0,n.jsxs)(A.default,{children:[(0,n.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Home care instructions"}),(0,n.jsx)(x.default,{children:y.homeCareInstructions})]}),(0,n.jsx)(l.P,{setPrinter:W})]}),(0,n.jsx)("br",{}),(0,n.jsx)(E.A,{variant:"contained",onClick:L,children:"Print"}),(0,n.jsx)(E.A,{variant:"text",onClick:t,children:"Cancel"})]})}},75363:(e,t,i)=>{"use strict";i.d(t,{b2:()=>c,FD:()=>u,qv:()=>m});var n=i(49262),a=i(44919);let l="visits",r=e=>(0,a.vt)(e,l),s=(e,t)=>(0,a.hc)(e,t,l);var o=i(26715),d=i(5041);let c=()=>{let e=(0,o.jE)();return(0,d.n)({mutationFn:e=>r(e).then(e=>e.data),onSuccess:t=>{e.invalidateQueries({queryKey:["visits"]})}})},u=()=>{let{ServerTime:e}=(0,n.useServerTime)(),t=async t=>s(t,{stopDatetime:e.getServerTimeString()}).then(e=>e.data);return(0,d.n)({mutationFn:t})},m=e=>{let t=(0,o.jE)();return(0,d.n)({mutationFn:e=>s(e,{stopDatetime:"null"}).then(e=>e.data),onSuccess:()=>{t.invalidateQueries({queryKey:["patients",e,"visits"]})}})}},86517:(e,t,i)=>{"use strict";i.d(t,{X:()=>l});var n=i(83436),a=i(19373);let l=e=>{let t=async()=>{var t;let i=await (0,n.P$)(e);return(null==(t=i.data)?void 0:t.length)?i.data[0].set_members.map(e=>{var t,i;let{names:n}=e;return{name:(null==(t=n[0])?void 0:t.name)||"Unknown",uuid:(null==(i=n[0])?void 0:i.uuid)||"N/A"}}):[]};return(0,a.I)({queryKey:[e],queryFn:t,enabled:!!e})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5639,16,9344,8250,2225,3740,3349,6987,2073,5062,4821,6448,7129,5246,5976,9487,9724,8441,1684,7358],()=>t(32442)),_N_E=e.O()}]);