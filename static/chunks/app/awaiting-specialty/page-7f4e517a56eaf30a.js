(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7584],{15377:(e,t,a)=>{"use strict";a.d(t,{OverlayLoader:()=>n});var i=a(95155);a(12115);var l=a(90418),r=a(89915);function n(e){let{open:t}=e;return(0,i.jsx)("div",{children:(0,i.jsx)(l.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:t,children:(0,i.jsx)(r.A,{color:"inherit"})})})}},21022:(e,t,a)=>{"use strict";a.d(t,{VQ:()=>n,kC:()=>s,sL:()=>r,uQ:()=>c});var i=a(95155),l=a(59487);let r=e=>{let{children:t,id:a}=e;return(0,i.jsx)(l.Th,{id:a,sx:{fontFamily:"Inter",fontSize:24,fontWeight:700,lineHeight:"29px",letterSpacing:0,textAlign:"center"},children:t})},n=e=>{let{children:t}=e;return(0,i.jsx)(l.Th,{alignSelf:"center",sx:{fontFamily:"Inter",fontSize:14,fontWeight:400,lineHeight:"21px",letterSpacing:0,color:"#636363",width:"50ch",textAlign:"center",my:"2ch"},children:t})},s=e=>{let{children:t,sx:a}=e;return(0,i.jsx)(l.sc,{elevation:0,sx:{display:"flex",flexDirection:"column",justifyContent:"center",px:"5ch",py:"5ch",mb:"2ch",...a},children:t})},c=e=>{let{children:t}=e;return(0,i.jsx)(l.Th,{sx:{fontFamily:"Inter",fontSize:"16px",fontWeight:600,lineHeight:"24px",letterSpacing:"0em",textAlign:"center",my:"2ch"},children:t})}},30830:(e,t,a)=>{"use strict";a.d(t,{a:()=>r});var i=a(12115),l=a(33764);let r=(e,t)=>{let[a,l]=(0,i.useState)({page:0,pageSize:10}),[r,s]=(0,i.useState)(""),[c,o]=(0,i.useState)([]),[d,u]=(0,i.useState)(!1),[x,p]=(0,i.useState)(0),[h,f]=(0,i.useState)(0),[g,m]=(0,i.useState)(!1),j=(0,i.useCallback)(async()=>{let i;u(!0),g&&(i=new Date().toISOString().split("T")[0]);try{let l=await n(e,a.pageSize,r,a.page+1,i||"",t);o(l.data.data),p(l.data.total_pages),f(l.data.totalEntries)}catch(e){console.error("Error fetching patients:",e)}finally{u(!1)}},[e,a.pageSize,r,a.page,g]);return(0,i.useEffect)(()=>{j()},[j]),{loading:d,patients:c,paginationModel:a,setPaginationModel:l,searchText:r,setSearchText:s,totalPages:x,totalEntries:h,setOnSwitch:m,refetch:(0,i.useCallback)(()=>{j()},[j])}},n=async(e,t,a,i,r,n)=>{let s="category=".concat(e,"&page=").concat(i,"&page_size=").concat(t,"&search=").concat(a,"&date=").concat(r);return n&&(s="category=".concat(e,"&paginate=false&patient_care_area=").concat(encodeURIComponent(n))),await (0,l.P8)(s)}},39419:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var i=a(95155),l=a(15377),r=a(70482),n=a(12115),s=a(21184),c=a(59487),o=a(66766),d=a(20256);function u(e,t){return function(a){let[c,o]=(0,n.useState)(!1),{navigateTo:u}=(0,r.cq)();(0,n.useLayoutEffect)(()=>{if(localStorage)if(localStorage.getItem("accessToken")){let e=localStorage.getItem("loginTime");if(e){let t=parseInt(e);if(Math.floor((new Date().getTime()-t)%36e5/6e4)>60){o(!1),u("/"),localStorage.clear();return}}o(!0)}else o(!1),localStorage.clear(),u("/")},[]);let p=(0,s.R)(t,(0,d.O)());return c?p?(0,i.jsx)(e,{...a}):(0,i.jsx)(x,{}):(0,i.jsx)(l.OverlayLoader,{open:!c})}}let x=()=>(0,i.jsx)(c.jD,{sx:{width:"100%",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff"},children:(0,i.jsx)(o.default,{src:"/403.jpg",height:500,width:500,alt:"403"})})},40425:(e,t,a)=>{"use strict";a.d(t,{d:()=>l});var i=a(12115);function l(e,t){let[a,l]=(0,i.useState)(e);return(0,i.useEffect)(()=>{let a=setTimeout(()=>l(e),t);return()=>clearTimeout(a)},[e,t]),a}},47392:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var i=a(95155),l=a(59487),r=a(21022),n=a(99653),s=a(39419),c=a(23312),o=a(12115),d=a(70482),u=a(66587),x=a(50095),p=a(52269),h=a(53494),f=a(81063),g=a(9670),m=a(20071),j=a(39347),y=a(20837),v=a(77498),A=a(99284),C=a(26403),S=a(89547),w=a(6314),_=a(75363),b=a(30830),I=a(16232),E=a(26096),D=a(35695),k=a(55253),N=a(40425);let T=()=>{let[e,t]=(0,o.useState)(!1),[a,r]=(0,o.useState)(""),[n,s]=(0,o.useState)(""),[u,T]=(0,o.useState)(""),[P,F]=(0,o.useState)(!1),[R,V]=(0,o.useState)({specialty:[],patientCareArea:[],recordedBy:[]}),[W,O]=(0,o.useState)({specialties:[],patientCareAreas:[],recordedByOptions:[]}),{navigateTo:L}=(0,d.cq)(),{gender:M}=(0,d.gd)(),{mutate:q,isSuccess:Q}=(0,_.FD)(),Y=1===R.patientCareArea.length?R.patientCareArea[0]:void 0,{paginationModel:J,patients:U,searchText:G,setSearchText:H,setPaginationModel:K,loading:X,totalPages:Z,refetch:$}=(0,b.a)("awaiting_speciality",Y),[ee,et]=(0,o.useState)(""),ea=(0,N.d)(ee,500);(0,D.useRouter)(),(0,o.useEffect)(()=>{if(U&&U.length>0){let e=Array.from(new Set(U.map(e=>e.department).filter(Boolean))),t=Array.from(new Set(U.map(e=>e.patient_care_area).filter(Boolean))),a=Array.from(new Set(U.map(e=>e.last_encounter_creator).filter(Boolean)));O({specialties:e.sort(),patientCareAreas:t.sort(),recordedByOptions:a.sort()})}},[U]);let ei=o.useMemo(()=>U?U.filter(e=>{let t=0===R.specialty.length||R.specialty.includes(e.department),a=0===R.patientCareArea.length||R.patientCareArea.includes(e.patient_care_area),i=0===R.recordedBy.length||R.recordedBy.includes(e.last_encounter_creator);return t&&a&&i}):[],[U,R]),el=e=>t=>{let a=t.target.value;V(t=>({...t,[e]:"string"==typeof a?a.split(","):a}))},er=(e,t)=>{V(a=>({...a,[e]:a[e].filter(e=>e!==t)}))},en=R.specialty.length>0||R.patientCareArea.length>0||R.recordedBy.length>0;(0,o.useEffect)(()=>{H(ea)},[ea]),(0,o.useEffect)(()=>{$()},[]),(0,o.useEffect)(()=>{let e=()=>{$()};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[]),(0,o.useEffect)(()=>{Q&&($(),console.log("Visit closed successfully, refreshing data..."))},[Q,$]);let es=[{field:"triage_result",headerName:"Triage Cat",renderCell:e=>(0,i.jsx)(p.default,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},children:(0,i.jsx)(p.default,{sx:{width:20,height:20,borderRadius:"50%",backgroundColor:"red"==e.value||"Emergency"==e.value?"#B42318":"yellow"==e.value||"Priority"==e.value?"#EDE207":"green"==e.value||"Queue"==e.value?"#016302":"transparent"}})})},{field:"given_name",headerName:"First Name",flex:1},{field:"family_name",headerName:"Last Name",flex:1},{field:"gender",headerName:"Gender"},{field:"waiting",headerName:"Aggregated Time",flex:1,renderCell:e=>(0,i.jsx)(l.VJ,{arrival_time:e.row.arrival_time})},{field:"last_encounter_creator",headerName:"Recorded By",flex:1},{field:"patient_care_area",flex:1,headerName:"Patient Care Area"},{field:"department",headerName:"Specialty",flex:1},{field:"action",headerName:"Actions",flex:1.2,renderCell:e=>(0,i.jsxs)(p.default,{display:"flex",gap:1,children:[(0,i.jsx)(z,{patient:e.row,onVisitClosed:$}),(0,i.jsx)(E.A,{title:"Initiate CPR",arrow:!0,children:(0,i.jsx)(h.default,{onClick:()=>{r(e.row.id),t(!0),s(e.row.visit_uuid)},"aria-label":"initiate CPR",color:"error",children:(0,i.jsx)(k.szJ,{})})})]})}],ec=null==ei?void 0:ei.map(e=>({id:e.id,visitNumber:e.aetc_visit_number,firstName:e.given_name,lastName:e.family_name,gender:e.gender,arrivalTime:e.patient_arrival_time,arrivalDateTime:e.arrival_time,actor:(0,i.jsx)(l.uT,{encounterType:c.fA.AWAITING_SPECIALTY,patientId:e.id}),aggregate:(0,i.jsx)(l.VJ,{arrival_time:e.arrival_time}),waitingTime:(0,i.jsx)(l.VJ,{arrival_time:null==e?void 0:e.latest_encounter_time}),actionName:"Recorded By",action:(0,i.jsx)(B,{patient:e,setDeleted:e=>T(e),triage:e.triage_result,visitId:e.visit_uuid,id:e.uuid,showCPR:"red"===e.triage_result,onCPR:()=>{r(e.id),t(!0),s(e.visit_uuid)},onVisitClosed:$}),age:"".concat((0,w.Cb)(e.birthdate),"yrs"),triageResult:e.triage_result}));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(f.default,{sx:{p:2,mb:2},children:[(0,i.jsxs)(p.default,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[(0,i.jsxs)(p.default,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,i.jsx)(k.YsJ,{}),(0,i.jsx)(g.default,{variant:"h6",children:"Filters"}),en&&(0,i.jsx)(m.A,{label:"".concat(R.specialty.length+R.patientCareArea.length+R.recordedBy.length," active"),size:"small",color:"primary"})]}),(0,i.jsxs)(p.default,{sx:{display:"flex",gap:1},children:[en&&(0,i.jsx)(j.A,{startIcon:(0,i.jsx)(k.QCr,{}),onClick:()=>{V({specialty:[],patientCareArea:[],recordedBy:[]})},size:"small",variant:"outlined",color:"secondary",children:"Clear All"}),(0,i.jsxs)(j.A,{startIcon:P?(0,i.jsx)(k.Ucs,{}):(0,i.jsx)(k.Vr3,{}),onClick:()=>F(!P),size:"small",variant:"outlined",children:[P?"Hide":"Show"," Filters"]})]})]}),(0,i.jsx)(y.A,{in:P,children:(0,i.jsxs)(p.default,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:2},children:[(0,i.jsxs)(v.A,{sx:{minWidth:200},children:[(0,i.jsx)(A.A,{children:"Specialty"}),(0,i.jsx)(C.A,{multiple:!0,value:R.specialty,onChange:el("specialty"),input:(0,i.jsx)(S.A,{label:"Specialty"}),renderValue:e=>(0,i.jsx)(p.default,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,i.jsx)(m.A,{label:e,size:"small",onDelete:()=>er("specialty",e),onMouseDown:e=>{e.stopPropagation()}},e))}),children:W.specialties.map(e=>(0,i.jsx)(x.A,{value:e,children:e},e))})]}),(0,i.jsxs)(v.A,{sx:{minWidth:200},children:[(0,i.jsx)(A.A,{children:"Patient Care Area"}),(0,i.jsx)(C.A,{multiple:!0,value:R.patientCareArea,onChange:el("patientCareArea"),input:(0,i.jsx)(S.A,{label:"Patient Care Area"}),renderValue:e=>(0,i.jsx)(p.default,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,i.jsx)(m.A,{label:e,size:"small",onDelete:()=>er("patientCareArea",e),onMouseDown:e=>{e.stopPropagation()}},e))}),children:W.patientCareAreas.map(e=>(0,i.jsx)(x.A,{value:e,children:e},e))})]}),(0,i.jsxs)(v.A,{sx:{minWidth:200},children:[(0,i.jsx)(A.A,{children:"Recorded By"}),(0,i.jsx)(C.A,{multiple:!0,value:R.recordedBy,onChange:el("recordedBy"),input:(0,i.jsx)(S.A,{label:"Recorded By"}),renderValue:e=>(0,i.jsx)(p.default,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>(0,i.jsx)(m.A,{label:e,size:"small",onDelete:()=>er("recordedBy",e),onMouseDown:e=>{e.stopPropagation()}},e))}),children:W.recordedByOptions.map(e=>(0,i.jsx)(x.A,{value:e,children:e},e))})]})]})}),en&&(0,i.jsxs)(p.default,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[(0,i.jsx)(g.default,{variant:"body2",sx:{mr:1,alignSelf:"center"},children:"Active filters:"}),R.specialty.map(e=>(0,i.jsx)(m.A,{label:"Specialty: ".concat(e),onDelete:()=>er("specialty",e),size:"small",color:"primary",variant:"outlined"},"specialty-".concat(e))),R.patientCareArea.map(e=>(0,i.jsx)(m.A,{label:"Care Area: ".concat(e),onDelete:()=>er("patientCareArea",e),size:"small",color:"primary",variant:"outlined"},"area-".concat(e))),R.recordedBy.map(e=>(0,i.jsx)(m.A,{label:"Recorded By: ".concat(e),onDelete:()=>er("recordedBy",e),size:"small",color:"primary",variant:"outlined"},"recorded-".concat(e)))]})]}),(0,i.jsx)(l.vP,{columns:es,data:(null==ei?void 0:ei.length)?{data:ei.map(e=>({id:e.uuid,...e})),page:J.page,per_page:J.pageSize,total_pages:Z,totalEntries:ei.length}:{data:[],page:1,per_page:10,total_pages:0,totalEntries:0},searchText:ee,setSearchString:et,setPaginationModel:K,paginationModel:J,loading:X,formatForMobileView:ec||[],onRowClick:e=>L("/patient/".concat(e.id,"/profile"))}),(0,i.jsx)(I.w8,{patientuuid:a,visituuid:n,open:e,onClose:()=>t(!1)})]})},z=e=>{var t;let{patient:a,onVisitClosed:l}=e,{navigateTo:r}=(0,d.cq)(),[n,s]=o.useState(null),{mutate:c,isSuccess:f}=(0,_.FD)(),{gender:g}=(0,d.gd)();return(0,o.useEffect)(()=>{f&&l()},[f,l]),(0,i.jsxs)(p.default,{display:"flex",gap:1,children:[(0,i.jsx)(E.A,{title:"View Profile",arrow:!0,children:(0,i.jsx)(h.default,{onClick:()=>r("/patient/".concat(a.id,"/profile")),"aria-label":"view profile",sx:{color:"green"},children:(0,i.jsx)(k.gSK,{})})}),(0,i.jsx)(E.A,{title:"Dispose",arrow:!0,children:(0,i.jsx)(h.default,{onClick:()=>r("/patient/".concat(a.id,"/disposition")),"aria-label":"Dispose",sx:{color:"grey"},children:(0,i.jsx)(k.dhv,{})})}),(0,i.jsx)(E.A,{title:"Template Forms",arrow:!0,children:(0,i.jsx)(h.default,{onClick:e=>{s(e.currentTarget)},"aria-label":"template forms",sx:{color:"#015E85"},children:(0,i.jsx)(k.t69,{})})}),(0,i.jsxs)(u.A,{id:"basic-menu",anchorEl:n,open:!!n,onClose:()=>{s(null)},children:[(0,i.jsx)(x.A,{onClick:()=>r("/patient/".concat(a.id,"/medicalInpatient")),children:"Medical Inpatient"}),(0,i.jsx)(x.A,{onClick:()=>r("/patient/".concat(a.id,"/surgicalNotes")),children:"Surgical Notes"}),(null==(t=a.gender)?void 0:t.toLowerCase())==="female"&&(0,i.jsx)(x.A,{onClick:()=>r("/patient/".concat(a.id,"/gyneacology")),children:"Gyneacology Ward Admission"})]})]})},B=e=>{let{id:t,visitId:a,triage:r,setDeleted:n,patient:s,showCPR:c,onCPR:f,onVisitClosed:g}=e,{navigateTo:m}=(0,d.cq)(),[j,y]=o.useState(null),{mutate:v,isSuccess:A}=(0,_.FD)();(0,o.useEffect)(()=>{A&&g()},[A,g]);let C=()=>{y(null)};return(0,i.jsxs)(p.default,{sx:{display:"flex",flexDirection:"column",flex:"1"},children:[(0,i.jsx)(l.jD,{sx:{borderRadius:"2px",width:"100%",height:"5ch",backgroundColor:"red"==r?"#B42318":"yellow"==r?"#ede207":"green"==r?"#016302":"",marginY:1}}),(0,i.jsxs)(p.default,{sx:{display:"flex",gap:1,justifyContent:"center"},children:[(0,i.jsx)(E.A,{title:"Close Visit",arrow:!0,children:(0,i.jsx)(h.default,{onClick:()=>{s.visit_uuid?v(s.visit_uuid):console.warn("No active visit UUID found for this patient.")},"aria-label":"close visit",size:"small",sx:{color:"#015E85"},children:(0,i.jsx)(k.axc,{})})}),(0,i.jsx)(E.A,{title:"Template Forms",arrow:!0,children:(0,i.jsx)(h.default,{onClick:e=>{y(e.currentTarget)},"aria-label":"template forms",size:"small",sx:{color:"#015E85"},children:(0,i.jsx)(k.t69,{})})}),(0,i.jsx)(E.A,{title:"View Profile",arrow:!0,children:(0,i.jsx)(h.default,{onClick:()=>m("/patient/".concat(s.id,"/profile")),"aria-label":"view profile",size:"small",sx:{color:"#015E85"},children:(0,i.jsx)(k.gSK,{})})}),c&&(0,i.jsx)(E.A,{title:"Initiate CPR",arrow:!0,children:(0,i.jsx)(h.default,{onClick:f,"aria-label":"initiate CPR",size:"small",color:"error",children:(0,i.jsx)(k.szJ,{})})})]}),(0,i.jsxs)(u.A,{id:"card-action-menu",anchorEl:j,open:!!j,onClose:C,children:[(0,i.jsx)(x.A,{onClick:()=>{m("/patient/".concat(t,"/medicalInpatient")),C()},children:"Medical Inpatient"}),(0,i.jsx)(x.A,{onClick:()=>{m("/patient/".concat(t,"/surgicalNotes")),C()},children:"Surgical Notes"}),(0,i.jsx)(x.A,{onClick:()=>{m("/patient/".concat(t,"/gyneacology")),C()},children:"Gyneacology Ward Admission"})]})]})},P=(0,s.A)(function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.V,{title:"Patients waiting for specialty",link:"/dashboard"}),(0,i.jsxs)(l.Yr,{container:!0,children:[(0,i.jsx)(l.Yr,{xs:0,lg:0,item:!0}),(0,i.jsxs)(l.Yr,{xs:12,lg:12,sx:{display:"flex",flexDirection:"column",mx:"2ch"},item:!0,children:[(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(r.sL,{children:"Patients waiting for specialty"}),(0,i.jsx)(r.VQ,{children:"This is a list of all patients that are waiting for specialty"}),(0,i.jsx)(r.kC,{sx:{p:0},children:(0,i.jsx)(T,{})})]}),(0,i.jsx)(l.Yr,{lg:0,item:!0})]})]})},[c.Ot.CLINICIAN,c.Ot.NURSE,c.Ot.ADMIN,c.Ot.STUDENT_CLINICIAN])},53326:(e,t,a)=>{Promise.resolve().then(a.bind(a,47392))},75363:(e,t,a)=>{"use strict";a.d(t,{b2:()=>d,FD:()=>u,qv:()=>x});var i=a(49262),l=a(44919);let r="visits",n=e=>(0,l.vt)(e,r),s=(e,t)=>(0,l.hc)(e,t,r);var c=a(26715),o=a(5041);let d=()=>{let e=(0,c.jE)();return(0,o.n)({mutationFn:e=>n(e).then(e=>e.data),onSuccess:t=>{e.invalidateQueries({queryKey:["visits"]})}})},u=()=>{let{ServerTime:e}=(0,i.useServerTime)(),t=async t=>s(t,{stopDatetime:e.getServerTimeString()}).then(e=>e.data);return(0,o.n)({mutationFn:t})},x=e=>{let t=(0,c.jE)();return(0,o.n)({mutationFn:e=>s(e,{stopDatetime:"null"}).then(e=>e.data),onSuccess:()=>{t.invalidateQueries({queryKey:["patients",e,"visits"]})}})}},99653:(e,t,a)=>{"use strict";a.d(t,{V:()=>s});var i=a(95155),l=a(70482),r=a(59487),n=a(33881);let s=e=>{let{title:t,link:a}=e,{navigateTo:s}=(0,l.cq)(),c={fontFamily:"Inter",fontSize:"14px",fontWeight:400,lineHeight:"21px",letterSpacing:"0em",textAlign:"center",mx:"1ch"};return(0,i.jsxs)(r.jD,{sx:{display:"flex",justifyContent:"space-evenly",py:"1ch",borderBottom:"solid 1px #E6E6E6"},children:[(0,i.jsxs)(r.jD,{onClick:()=>s(a),sx:{display:"flex",cursor:"pointer"},children:[(0,i.jsx)(r.Th,{children:(0,i.jsx)(n.oWm,{})}),(0,i.jsx)(r.Th,{sx:c,children:"Go back"})]}),(0,i.jsx)(r.Th,{sx:c,children:t}),(0,i.jsxs)(r.jD,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(n.M4e,{}),(0,i.jsx)(r.Th,{sx:c,children:"Need any help?"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5639,16,9344,8250,2225,3740,8320,3349,6987,2073,5062,4821,6448,7129,5976,9487,8130,342,6232,8441,1684,7358],()=>t(53326)),_N_E=e.O()}]);