"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5008],{4638:(e,a,n)=>{n.d(a,{P:()=>r});var t=n(95155),i=n(15966),l=n(50494);let r=e=>{let{setPrinter:a}=e,{data:n,isLoading:r}=(0,l.Ay)();return(0,t.jsx)(i.x,{getValue:e=>{a(e)},label:"Select Printer",options:n?null==n?void 0:n.map(e=>({value:e.ip_address,label:e.name})):[]})}},10157:(e,a,n)=>{function t(e){let{presentingComplaints:a,diagnosis:n,labOrders:t,dischargeNotes:i,dischargePlan:l,followUpPlan:r,homeCareInstructions:s}=e,o=e=>Math.round(203*e/25.4),d=o(100),c=o(40),u=d-40,m=Math.floor(u/8),h=[{title:"Discharge Notes",content:i||"N/A"},{title:"Investigations",content:t.length?t.flatMap(e=>e.tests.map(e=>"".concat(e.name,":").concat(e.result||"pending"))).join(" ! "):"No investigations ordered"},{title:"Final Diagnosis",content:(null==n?void 0:n.length)?n.map(e=>e.value).join(" ! "):"None"},{title:"Discharge Plan",content:l||"N/A"},{title:"Follow Up Plan",content:"".concat(r)||"N/A"},{title:"Home Care Instructions",content:s||"N/A"}],b=[];h.forEach((e,a)=>{b.push({text:e.title,isTitle:!0,sectionIndex:a}),(function(e){if(!e)return[];let a=e.split(" "),n=[],t="";for(let e of a){if(e.length>m){t&&(n.push(t),t="");for(let a=0;a<e.length;a+=m){let t=e.substring(a,a+m);n.push(t)}continue}let a=t?"".concat(t," ").concat(e):e;a.length<=m?t=a:(t&&n.push(t),t=e)}return t&&n.push(t),n})(e.content).forEach(e=>{b.push({text:e,isTitle:!1,sectionIndex:a})})});let p=[],x=[],f=70;for(let e=0;e<b.length;e++){let a=b[e],n=0;if(x.length>0){let e=x[x.length-1];a.sectionIndex!==e.sectionIndex&&(n=10)}let t=n+(a.isTitle?30:25);if(f+t>c-20){if(0===x.length){x.push(a),p.push(x),x=[],f=20;continue}p.push(x),x=[],f=20,e--;continue}x.push(a),f+=t}return x.length>0&&p.push(x),p.map((e,a)=>{let n=20,t="^XA\n^PW".concat(d,"\n^LL").concat(c,"\n^CF0,25");0===a?(t+="\n^FO".concat(20,",").concat(20,"^FDPatient Summary-QECH AETC^FS\n^FO").concat(20,",").concat(60,"^GB").concat(u,",3,3^FS"),n=70):n=20;let i=-1;for(let a of e)a.sectionIndex!==i&&(-1!==i&&(n+=10),i=a.sectionIndex),a.isTitle?(t+="\n^CF0,25\n^FO".concat(20,",").concat(n,"^FD").concat(a.text,"^FS"),n+=30):(t+="\n^CF0,20\n^FO".concat(20,",").concat(n,"^FD").concat(a.text,"^FS"),n+=25);return t+"\n^XZ"}).join("\n")}function i(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Medication Instructions",n=Math.floor(68.21428571428571),t=[],i=[],l=0,r=1;function s(e,n){let t=["^XA\n^CF0,25","^FO".concat(30,",30^").concat(a).concat(n>1?" (Cont. ".concat(n,")"):"","^FS"),"^FO".concat(30,",").concat(60,"^GB").concat(955,",").concat(3,",").concat(3,"^FS")].join("\n")+"\n",i=68;for(let a of e){for(let e of a)t+="^FO".concat(30,",").concat(i,"^FD").concat(e,"^FS\n"),i+=20;i+=10}return t+"^XZ"}return e.forEach(e=>{let a=function(e){let a=e.split(" "),t=[],i="";for(let e of a)(i+" "+e).trim().length<=n?i=(i+" "+e).trim():(t.push(i),i=e);return i&&t.push(i),t}(function(e,a){let n=[e.medicationName,"".concat(e.dose," ").concat(e.doseUnits),e.frequency,e.duration,e.formulation,"(".concat(e.prescribedBy,")")].filter(Boolean).map(e=>e.replace(/[\\^]/g,""));return"".concat(a,". ").concat(n.join(" | "))}(e,r)),o=20*a.length+10;l+o>323&&(t.push(s(i,t.length+1)),i=[],l=0),i.push(a),l+=o,r++}),i.length&&t.push(s(i,t.length+1)),t.join("\n")}n.d(a,{B:()=>i,U:()=>t})},15008:(e,a,n)=>{n.d(a,{H5:()=>y.H,OE:()=>k,CB:()=>_,tc:()=>B,_T:()=>D,XU:()=>j});var t=n(95155),i=n(72478),l=n(2300),r=n(5387),s=n(87295),o=n(26301),d=n(99354),c=n(57430),u=n(91871),m=n(53756),h=n(86973),b=n(12115),p=n(51349),x=n(51267),f=n(98579),v=n(9877),g=n(263);let j=e=>{var a,n,j;let{sx:y}=e,{params:S}=(0,s.KU)(),{navigateTo:A}=(0,s.cq)(),{data:I,isLoading:E}=(0,r.GN)(S.id),[C,_]=(0,b.useState)(null),P=!!C,[O,T]=(0,b.useState)(!1),{hasActiveVisit:D,closedVisitId:w,openClosedVisit:F}=(0,s.gd)(),{mutateAsync:k}=(0,f.qv)(S.id),U=()=>{_(null)};return E?(0,t.jsx)(d.E7,{}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{children:"\n          .first_letter {\n              background-color: #e6e6e6;\n              padding: 20px;\n              margin-right: 20px;\n              font-size: 24px;\n              border-radius: 4px;\n              color: #636363 !important;\n          }\n          .p_name_image {\n              font-size: 24px;\n              color: #00190e;\n              display: flex;\n              font-weight: 700;\n              overflow: hidden;\n          }\n          .p_name {\n              max-width: 210px;\n              margin-left: 20px;\n              height: 25px;\n          }\n          .p_dash_header {\n              display: flex;\n              justify-content: space-between;\n              padding: 20px;\n              border-bottom: solid #cccccc 1px;\n          }\n          .p_title {\n              font-weight: 700;\n              font-size: 24px;\n              color: #00190e;\n          }\n              .initialsBox {\n              min-width: 85px;\n              height: 90px;\n              left: 31px;\n              top: 122px;\n              align-items: center;\n              border-radius: 10px;\n              align-items: center;\n              display: flex;\n              justify-content: center;\n              margin-top: 10px;\n          }\n          .maleColor {\n              background: #5983ba;\n          }\n          .femaleColor {\n              background: #876d9b;\n          }\n              .vertical-dots {\n            display: flex;\n            flex-direction: column;\n            align-items: end;\n            gap: 3px;\n          }\n\n          .dot {\n            width: 5px;\n            height: 5px;\n            border-radius: 50%;\n            background-color: #333;\n          }\n        "}),(0,t.jsxs)(l.default,{style:{backgroundColor:"#ffffff",padding:"1ch"},children:[(0,t.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},children:[(0,t.jsx)(u.A,{id:"basic-button","aria-controls":P?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":P?"true":void 0,onClick:e=>{_(e.currentTarget)},size:"small",style:{minWidth:"30px"},children:(0,t.jsxs)("div",{className:"vertical-dots",children:[(0,t.jsx)("div",{className:"dot"}),(0,t.jsx)("div",{className:"dot"}),(0,t.jsx)("div",{className:"dot"})]})}),(0,t.jsxs)(m.A,{id:"basic-menu",anchorEl:C,open:P,onClose:U,MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,t.jsx)(h.A,{onClick:()=>{U(),A("/patient/".concat(S.id,"/view"))},style:{borderBottom:"1px solid #ccc",padding:"10px"},children:"Update demographics"}),(0,t.jsx)(h.A,{onClick:U,style:{borderBottom:"1px solid #ccc",padding:"10px"},children:"Update outcome"}),(0,t.jsx)(h.A,{onClick:U,style:{borderBottom:"1px solid #ccc",padding:"10px"},children:"Print visit summary"}),(0,t.jsx)(h.A,{onClick:U,style:{borderBottom:"1px solid #ccc",padding:"10px"},children:"Print patient identifier"}),!D&&(0,v.O)().some(e=>[g.Ot.ADMIN,g.Ot.CLINICIAN].includes(e))&&(0,t.jsx)(h.A,{onClick:()=>{U(),(0,x.iE)({title:"Visit reactivation",text:"Are you sure you want to reactive the most recent closed visit for this patient?",icon:"warning",confirmButtonText:"Yes",onConfirm:async()=>{await k(w)&&F()}})},style:{borderBottom:"1px solid #ccc",padding:"10px"},children:"Reactivate Most Recent Visit"}),(0,t.jsx)(h.A,{onClick:()=>{U(),T(!0)},style:{borderBottom:"1px solid #ccc",padding:"10px"},children:"Print patient summary"}),(0,t.jsx)(h.A,{onClick:()=>A("/patient/".concat(S.id,"/view")),sx:{color:"blue",cursor:"pointer"},children:"see more"})]})]}),(0,t.jsxs)(i.jD,{sx:{display:"flex",alignItems:"center"},children:[(0,t.jsx)(i.jD,{sx:{background:"#E6E6E6",height:"5ch",display:"flex",alignItems:"center",justifyContent:"center",mr:"1ch",mt:"2ch",ml:"1ch"},children:(0,t.jsx)("div",{className:"p_name_image",children:(0,t.jsx)("div",{className:(null==I?void 0:I.gender)=="Male"?"initialsBox maleColor":"initialsBox femaleColor",children:(0,t.jsx)(c.A,{style:{fontSize:"90px",color:"#fff"}})})})}),(0,t.jsx)(i.jD,{children:(0,t.jsx)(i.Th,{variant:"h5",fontWeight:"700",children:(null==I?void 0:I.given_name)+" "+(null==I?void 0:I.family_name)})})]}),(0,t.jsx)("br",{}),(0,t.jsxs)("div",{style:{marginLeft:"1ch"},children:[(0,t.jsx)(N,{label:"MRN:",value:function(e){let a=e.filter(e=>e.identifier_type&&"National id"===e.identifier_type.name).map(e=>e.identifier);return a[a.length-1]}(null==I?void 0:I.identifiers)}),(0,t.jsx)(N,{label:"Gender:",value:null==I?void 0:I.gender}),(0,t.jsx)(N,{label:"Age:",value:"  ".concat((null==I?void 0:I.birthdate)&&(0,o.Cb)(null==I?void 0:I.birthdate)," yrs (").concat((0,o.k)(null==I?void 0:I.birthdate),")")}),(0,t.jsx)(N,{label:"Address:",value:(null==I||null==(a=I.addresses[0])?void 0:a.address1)+" ,"+(null==I||null==(n=I.addresses[0])?void 0:n.address2)+", "+(null==I||null==(j=I.addresses[0])?void 0:j.city_village)})]})]}),(0,t.jsx)(p.p,{onClose:()=>T(!1),open:O})]})},N=e=>{let{label:a,value:n}=e;return(0,t.jsxs)(i.jD,{sx:{display:"flex",mb:"0.5ch",mt:"1ch",color:"#737373"},children:[(0,t.jsx)("div",{style:{fontSize:"0.9rem",minWidth:"85px"},children:a}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",fontWeight:"700"},children:n})]})};n(66637),n(98672);var y=n(68100),S=n(44287),A=n(20828),I=n(96935),E=n(35068);let C=E.Ik().shape({district:E.Yj(),traditionalAuthority:E.Yj(),village:E.Yj(),nationality:E.Yj()}),_=e=>{let{onSubmit:a,initialValues:n,currentLocation:l=!1,onFormValueChange:r=()=>{},submitButton:s=!0,setContext:o=e=>{}}=e,{villages:d,districts:c,traditionalAuthorities:u}=(0,b.useContext)(I.d),[m,h]=(0,b.useState)({village:"",traditionalAuthority:"",district:""}),[p,x]=(0,b.useState)({});return(0,b.useEffect)(()=>{var e,a,t;let i=null==(e=c.find(e=>e.name==n.district))?void 0:e.district_id,l=null==(a=u.find(e=>e.name==n.traditionalAuthority))?void 0:a.traditional_authority_id;h({village:null==(t=d.find(e=>e.name==n.village))?void 0:t.village_id,traditionalAuthority:l,district:i})},[]),(0,b.useEffect)(()=>{x(n)},[m]),(0,t.jsxs)(i.PD,{submitButtonText:"update",enableReinitialize:!0,initialValues:p,validationSchema:C,onSubmit:a,getFormValues:r,submitButton:s,children:[!l&&(0,t.jsx)(i.el,{name:"nationality",label:"Nationality",multiple:!1,options:A.X.map(e=>({id:e.nationality,label:e.nationality}))}),(0,t.jsx)(S.Ji,{setFormContext:o}),(0,t.jsx)(i.el,{name:"district",label:"District",multiple:!1,getValue:e=>{let a=c.find(a=>a.name==e);a&&h(e=>({...e,district:a.district_id.toString()}))},options:c?c.map(e=>({id:e.name,label:e.name})):[]}),(0,t.jsx)(i.el,{name:"traditionalAuthority",label:"Traditional Authority ",multiple:!1,getValue:e=>{let a=u.find(a=>a.name==e);a&&h(e=>({...e,traditionalAuthority:a.traditional_authority_id.toString()}))},options:u?u.filter(e=>e.district_id.toString()==m.district).map(e=>({id:e.name,label:e.name})):[]}),(0,t.jsx)(i.el,{name:"village",label:"Village",multiple:!1,options:d?d.filter(e=>e.traditional_authority_id.toString()==m.traditionalAuthority).map(e=>({id:e.name,label:e.name})):[]}),l&&(0,t.jsx)(i.A8,{sx:{width:"100%"},name:"closeLandMark",id:"closeLandMark",label:"Close Land Mark"})]})};var P=n(12409);let O={maritalStatus:{name:g.W.MARITAL_STATUS,label:"Marital Status"},occupation:{name:g.W.OCCUPATION,label:"Occupation"},religion:{name:g.W.RELIGION,label:"Religion"},religionSpecify:{name:g.W.ADDITIONAL_NOTES,label:"Specify"},highestEducation:{name:g.W.HIGHEST_EDUCATION,label:"Highest Education"},methodOfTransportation:{name:g.W.METHOD_OF_TRANSPORTATION,label:"Method Of Transportation"}},T=E.Ik().shape({[O.maritalStatus.name]:E.Yj().required().label(O.maritalStatus.label),[O.occupation.name]:E.Yj().required().label(O.occupation.label),[O.religion.name]:E.Yj().required().label(O.religion.label),[O.religionSpecify.name]:E.Yj().label(O.religionSpecify.label),[O.highestEducation.name]:E.Yj().required().label(O.highestEducation.label),[O.methodOfTransportation.name]:E.Yj().required().label(O.methodOfTransportation.label)}),D=e=>{let{initialValues:a,onSubmit:n,submitButton:l=!0,setContext:r=e=>{}}=e,[s,o]=(0,b.useState)("");return(0,t.jsxs)(i.PD,{onSubmit:n,initialValues:a,validationSchema:T,submitButtonText:"Update",submitButton:l,children:[(0,t.jsx)(S.Ji,{setFormContext:r}),(0,t.jsx)(P.uQ,{children:"Marital Status"}),(0,t.jsx)(i.b1,{row:!0,name:O.maritalStatus.name,label:O.maritalStatus.label,options:[{label:"Single",value:"single"},{label:"Married",value:"married"},{label:"Separated",value:"separated"},{label:"Widowed",value:"widow/widower"},{label:"Divorced",value:"divorced"},{label:"Unknown",value:"unknown"}]}),(0,t.jsx)(P.uQ,{children:"Religion"}),(0,t.jsx)(i.pK,{getValue:e=>o(e),name:O.religion.name,selectItems:[{name:"Christianity",value:"Christianity"},{name:"Muslim",value:"Muslim"},{name:"Buddhism",value:"Buddhism"},{name:"Rastafarian",value:"Rastafarian"},{name:"Atheist",value:"Atheist"},{name:"Traditional",value:"Traditional"},{name:"Other",value:"Other"}],label:O.religion.label,id:O.religion.name}),"Other"==s&&(0,t.jsx)(i.A8,{name:O.religionSpecify.name,label:O.religionSpecify.label,id:O.religionSpecify.name}),(0,t.jsx)(P.uQ,{children:"Occupation"}),(0,t.jsx)(i.b1,{row:!0,name:O.occupation.name,label:"",options:[{label:"Working",value:"working"},{label:"Business",value:"business"},{label:"Unemployed",value:"unemployed"},{label:"Self Employed",value:"selfemployed"},{label:"Student",value:"student"},{label:"House Wife",value:"housewife"},{label:"Unknown",value:"unknown"}]}),(0,t.jsx)(P.uQ,{children:"Transportation"}),(0,t.jsx)(i.pK,{name:O.methodOfTransportation.name,selectItems:[{name:"Walking",value:"walking"},{name:"Ambulance",value:"ambulance"},{name:"Taxi",value:"Taxi"},{name:"Minibus",value:"Minibus"},{name:"Motorcycle",value:"motorcycle"},{name:"Hired Car",value:"hired car"},{name:"Private transport",value:"private_transport"},{name:"Police vehicle",value:"police_vehicle"},{name:"Company vehicle",value:"other_public_company_vehicle"},{name:"Bicycle",value:"bicycle"},{name:"Helicopter",value:"helicopter"}],label:O.methodOfTransportation.label,id:O.methodOfTransportation.name}),(0,t.jsx)(P.uQ,{children:"Highest Education"}),(0,t.jsx)(i.pK,{name:O.highestEducation.name,selectItems:[{name:"Primary",value:"primary"},{name:"Secondary",value:"secondary"},{name:"Tertiary",value:"tertiary"},{name:"None",value:"none"},{name:"Unknown",value:"unknown"}],label:O.highestEducation.label,id:O.highestEducation.name})]})},w={paymentOption:{name:g.W.PAYMENT_OPTIONS,label:"Payment Option"},insuranceProvider:{name:g.W.INSURANCE_PROVIDER,label:"Insurance Provider"},insuranceIdNo:{name:g.W.INSURANCE_NUMBER,label:"Insurance Id Number"},insuranceSchema:{name:g.W.INSURANCE_SCHEME,label:"Insurance Scheme"},status:{name:g.W.INSURANCE_STATUS,label:"Insurance Status"}},F=E.Ik().shape({[w.paymentOption.name]:E.YO().label(w.paymentOption.label),[w.insuranceProvider.name]:E.Yj().label(w.insuranceProvider.label),[w.insuranceIdNo.name]:E.Yj().label(w.insuranceIdNo.label),[w.insuranceSchema.name]:E.Yj().label(w.insuranceSchema.label)}),k=e=>{let{onSubmit:a,initialValues:n,setContext:l=()=>{},submitButton:r}=e,[s,o]=(0,b.useState)("");return(0,b.useEffect)(()=>{let e=n[g.W.PAYMENT_OPTIONS];Array.isArray(e)&&e.find(e=>"insurance"==e)&&o("insurance")},[n]),(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(i.PD,{validationSchema:F,initialValues:n,onSubmit:a,submitButtonText:"Update",submitButton:r,children:[(0,t.jsx)(P.uQ,{children:"Payment Options"}),(0,t.jsx)(S.Ji,{setFormContext:l}),(0,t.jsx)(i.Z3,{getValue:e=>{if(!Array.isArray(e))return;let a=null==e?void 0:e.find(e=>(null==e?void 0:e.key)=="insurance"&&(null==e?void 0:e.value));a?o(null==a?void 0:a.key):o("")},name:w.paymentOption.name,options:[{label:"Non-paying",value:"non-paying"},{label:"Cash",value:"cash"},{label:"Staff",value:"staff"},{label:"Insurance",value:"insurance"}]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.pK,{label:w.insuranceProvider.label,id:w.insuranceProvider.name,name:w.insuranceProvider.name,selectItems:[{name:"Masm",value:"masm"},{name:"Escom",value:"Escom"},{name:"Reserve Bank",value:"Reserve Bank"},{name:"Liberty",value:"Liberty"},{name:"Unimed",value:"Unimed"},{name:"Medhealth",value:"Medhealth"},{name:"CIC Malawi",value:"CIC Malawi"},{name:"MRA",value:"MRA"}]}),(0,t.jsx)(i.A8,{name:w.insuranceIdNo.name,id:w.insuranceIdNo.name,label:w.insuranceIdNo.label}),(0,t.jsx)(i.pK,{label:w.insuranceSchema.label,id:w.insuranceSchema.name,name:w.insuranceSchema.name,selectItems:[{name:"VVIP",value:"VVIP"},{name:"VIP",value:"VIP"},{name:"EXEC",value:"EXEC"},{name:"ECO",value:"ECO"}]}),(0,t.jsx)(i.b1,{name:w.status.name,label:w.status.label,options:[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}]})]})]})})},U=[{name:"Parent",value:g.W.PARENT},{name:"Uncle",value:g.W.UNCLE_AUNTIE},{name:"Auntie",value:g.W.AUNTIE},{name:"Spouse",value:g.W.SPOUSE},{name:"Siblings",value:g.W.SIBLING}],M=E.Ik().shape({given_name:E.Yj().required().label("First Name"),family_name:E.Yj().required().label("Last Name"),relationship:E.Yj().required().label("Relationship")}),B=e=>{let{onSubmit:a,initialValues:n,isGuardian:l,setContext:r=()=>{},submitButton:s}=e;return(0,t.jsxs)(i.PD,{submitButton:s,enableReinitialize:!0,submitButtonText:"Update",validationSchema:M,initialValues:n,onSubmit:a,children:[(0,t.jsx)(S.Ji,{setFormContext:r}),(0,t.jsx)(P.uQ,{children:l?"Guardian information":"Next of kin Information"}),(0,t.jsxs)(i.jD,{display:"flex",flexDirection:"column",children:[(0,t.jsx)(i.A8,{name:"given_name",id:"given_name",label:"First Name"}),(0,t.jsx)(i.A8,{name:"family_name",id:"family_name",label:"Last Name"}),!l&&(0,t.jsx)(i.pK,{name:"relationship",id:"relationship",label:"Relationship",selectItems:U}),(0,t.jsx)(i.A8,{name:"phoneNumber",id:"phoneNumber",label:"Phone Number"})]})]})}},51349:(e,a,n)=>{n.d(a,{p:()=>N});var t=n(95155),i=n(72478),l=n(4638),r=n(263),s=n(7047),o=n(24507),d=n(10157),c=n(87295),u=n(66637),m=n(45294),h=n(80777),b=n(21067),p=n(94049),x=n(25635),f=n(33077),v=n(91871),g=n(95125),j=n(12115);let N=e=>{let{onClose:a,open:n,initialNotes:N}=e,{params:y}=(0,c.KU)(),[S,A]=(0,j.useState)([]),[I,E]=(0,j.useState)([]),[C,_]=(0,j.useState)([]),[P,O]=(0,j.useState)(""),{selectedVisit:T}=(0,s.E)(),[D,w]=(0,j.useState)({dischargeNotes:"",dischargePlan:"",followUpDetails:"",followUpPlan:"",clinic:"",homeCareInstructions:""}),{data:F}=(0,u.$O)(null==y?void 0:y.id,"encounter_type=".concat(r.fA.PRESENTING_COMPLAINTS)),{data:k}=(0,u.$O)(null==y?void 0:y.id,"encounter_type=".concat(r.fA.OUTPATIENT_DIAGNOSIS)),{data:U}=(0,u.$O)(null==y?void 0:y.id,"encounter_type=".concat(r.fA.DISPOSITION)),{data:M}=(0,m.RO)(null==y?void 0:y.id);(0,j.useEffect)(()=>{if(k){var e,a;A(null==k||null==(a=k.filter(e=>e.visit_id==T.id)[0])||null==(e=a.obs)?void 0:e.filter(e=>e.names.find(e=>e.name===r.W.FINAL_DIAGNOSIS)))}},[k,T]),(0,j.useEffect)(()=>{M&&_(M)},[M]),(0,j.useEffect)(()=>{if(F){var e;E(null==(e=F.filter(e=>e.visit_id==T.id)[0])?void 0:e.obs)}},[F,T]),(0,j.useEffect)(()=>{if(N)return void w(N);if(U){var e;let a=null==(e=U.filter(e=>e.visit_id==T.id)[0])?void 0:e.obs.find(e=>e.names.find(e=>e.name==r.W.DISCHARGE_HOME)),n=(0,o.m)(null==a?void 0:a.children,r.W.DISCHARGE_NOTES),t=(0,o.m)(null==a?void 0:a.children,r.W.DISCHARGE_PLAN),i=(0,o.m)(null==a?void 0:a.children,r.W.FOLLOWUP_DETAILS),l=(0,o.m)(null==a?void 0:a.children,r.W.FOLLOWUP_PLAN),s=(0,o.m)(null==a?void 0:a.children,r.W.SPECIALIST_CLINIC),d=(0,o.m)(null==a?void 0:a.children,r.W.HOME_CARE_INSTRUCTIONS);(async()=>{var e;let a=await (0,u.cr)(s);w({dischargeNotes:n,dischargePlan:t,followUpDetails:i,followUpPlan:l,clinic:null==a||null==(e=a.data[0])?void 0:e.short_name,homeCareInstructions:d})})()}},[U,T]);let B=async()=>{let e=(0,d.U)({presentingComplaints:I,diagnosis:S,labOrders:C,dischargeNotes:D.dischargeNotes,dischargePlan:D.dischargePlan,followUpPlan:"".concat(D.followUpDetails," | ").concat(D.clinic),homeCareInstructions:D.homeCareInstructions});await g.A.post("".concat(P,"/print"),{zpl:e}),a()};return(0,t.jsxs)(i.eV,{title:"Patient Summary-QECH AETC",onClose:()=>{},open:n,children:[(0,t.jsxs)(h.A,{spacing:3,children:[(0,t.jsx)(b.A,{}),(0,t.jsxs)(p.default,{children:[(0,t.jsx)(x.default,{variant:"h6",children:"Final Diagnosis"}),(0,t.jsx)(h.A,{spacing:1,mt:1,children:null==S?void 0:S.map((e,a)=>(0,t.jsx)(x.default,{children:e.value},"diagnosis-".concat(a)))})]}),(0,t.jsx)(b.A,{}),(0,t.jsxs)(p.default,{children:[(0,t.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Lab Investigations"}),(0,t.jsxs)(f.default,{container:!0,spacing:2,sx:{fontWeight:"bold",mb:1},children:[(0,t.jsx)(f.default,{item:!0,xs:4,children:"Specimen"}),(0,t.jsx)(f.default,{item:!0,xs:4,children:"Test"}),(0,t.jsx)(f.default,{item:!0,xs:4,children:"Result"})]}),C.map((e,a)=>{var n;return null==e||null==(n=e.tests)?void 0:n.map((n,i)=>{var l;return(0,t.jsxs)(f.default,{container:!0,spacing:2,children:[(0,t.jsx)(f.default,{item:!0,xs:4,children:(null==(l=e.specimen)?void 0:l.name)||"N/A"}),(0,t.jsx)(f.default,{item:!0,xs:4,children:n.name}),(0,t.jsx)(f.default,{item:!0,xs:4,children:n.result||"Pending"})]},"order-".concat(a,"-test-").concat(i))})})]}),(0,t.jsx)(b.A,{}),!!D.dischargeNotes&&(0,t.jsxs)(p.default,{children:[(0,t.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Discharge Notes"}),(0,t.jsx)(x.default,{children:D.dischargeNotes})]}),!!D.dischargePlan&&(0,t.jsxs)(p.default,{children:[(0,t.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Discharge Plan"}),(0,t.jsx)(x.default,{children:D.dischargePlan})]}),!!D.followUpPlan&&"Yes"==D.followUpPlan&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(p.default,{children:[(0,t.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Follow up Plan"}),(0,t.jsxs)(x.default,{children:[D.followUpDetails," ~ ",D.clinic]})]})}),!!D.homeCareInstructions&&(0,t.jsxs)(p.default,{children:[(0,t.jsx)(x.default,{variant:"h6",gutterBottom:!0,children:"Home care instructions"}),(0,t.jsx)(x.default,{children:D.homeCareInstructions})]}),(0,t.jsx)(l.P,{setPrinter:O})]}),(0,t.jsx)("br",{}),(0,t.jsx)(v.A,{variant:"contained",onClick:B,children:"Print"}),(0,t.jsx)(v.A,{variant:"text",onClick:a,children:"Cancel"})]})}},68100:(e,a,n)=>{n.d(a,{H:()=>u});var t=n(95155),i=n(26301),l=n(12115),r=n(72478),s=n(35068),o=n(44287);let d={identificationNumber:{name:"identificationNumber",label:"National Identification Number"},firstName:{name:"firstName",label:"First Name"},phoneNumber:{name:"phoneNumber",label:"Phone Number"},lastName:{name:"lastName",label:"Last Name"},dob:{name:"birthDate",label:"Date of Birth"},gender:{name:"gender",label:"Gender"},birthDateEstimated:{name:"birthdateEstimated",label:"Birthdate Estimated"},age:{name:"age",label:"Estimated Age"}},c=s.Ik().shape({[d.identificationNumber.name]:s.Yj().label(d.identificationNumber.label),[d.firstName.name]:s.Yj().required().label(d.firstName.label),[d.phoneNumber.name]:s.Yj().matches(/^((\\+[1-9]{1,4}[ \\-]*)|(\\([0-9]{2,3}\\)[ \\-]*)|([0-9]{2,4})[ \\-]*)*?[0-9]{3,4}?[ \\-]*[0-9]{3,4}?$/,"phone number not valid").min(10).label(d.phoneNumber.label),[d.lastName.name]:s.Yj().required().label(d.lastName.label),[d.dob.name]:s.p6().when(d.birthDateEstimated.name,{is:e=>"true"==e,then:()=>s.p6().required()}).test("valid-age","Age must be at least 14 years and not in the future",function(e){if(!e)return!0;let a=new Date(e),n=new Date,t=n.getFullYear()-a.getFullYear(),i=n.getMonth()-a.getMonth();return(i<0||0===i&&n.getDate()<a.getDate())&&t--,t>=14&&t>=0}),[d.gender.name]:s.Yj().required().label(d.gender.label)}),u=e=>{var a;let{initialValues:n,onSubmit:s,onFormValueChange:u=()=>{},submitButton:m=!0,setContext:h=e=>{}}=e,[b,p]=(0,l.useState)({});return(0,t.jsxs)(r.PD,{validationSchema:c,initialValues:n,onSubmit:s,submitButtonText:"update",getFormValues:u,enableReinitialize:!0,submitButton:m,children:[(0,t.jsx)(o.Ji,{setFormContext:h}),(0,t.jsxs)(r.jD,{sx:{display:"flex",flexDirection:"column"},children:[(0,t.jsx)(r.fP,{getValues:p}),(0,t.jsx)(r.A8,{name:d.identificationNumber.name,id:d.identificationNumber.name,label:d.identificationNumber.label}),(0,t.jsx)(r.A8,{name:d.firstName.name,id:d.firstName.name,label:d.firstName.label}),(0,t.jsx)(r.A8,{name:d.lastName.name,id:d.lastName.name,label:d.lastName.label}),(0,t.jsx)(r.b1,{name:d.gender.name,label:d.gender.label,options:[{label:"Male",value:"Male"},{label:"Female",value:"Female"}]}),(0,t.jsx)(r.b1,{name:d.birthDateEstimated.name,label:d.birthDateEstimated.label,options:[{label:"Yes",value:!0},{label:"No",value:!1}]}),(0,t.jsx)(r.A8,{sx:{display:"true"==b[d.birthDateEstimated.name]?"flex":"none"},name:d.age.name,id:d.age.name,label:d.age.label}),b[d.age.name]>0&&"true"==b[d.birthDateEstimated.name]&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),(0,t.jsxs)(r.Th,{variant:"body1",children:["Estimated birth date  ",(0,t.jsx)("b",{children:null==(a=(0,i.wZ)(b[d.age.name]))?void 0:a.readable})]}),(0,t.jsx)("br",{})]}),(0,t.jsx)(r.bZ,{sx:{display:!1==b[d.birthDateEstimated.name]||"false"==b[d.birthDateEstimated.name]?"flex":"none",width:"100%"},width:"100%",label:d.dob.label,name:d.dob.name}),(0,t.jsx)(r.A8,{name:d.phoneNumber.name,id:d.phoneNumber.name,label:d.phoneNumber.label})]})]})}},99354:(e,a,n)=>{n.d(a,{E7:()=>r});var t=n(95155);n(12115);var i=n(20699),l=n(80777);n(72478);let r=e=>{let{height:a=400}=e;return(0,t.jsx)(l.A,{width:"100%",mt:2,children:(0,t.jsx)(i.A,{variant:"rectangular",width:"100%",height:a})})}}}]);