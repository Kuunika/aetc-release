(()=>{var e={};e.id=6442,e.ids=[6442],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4436:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(60687),n=r(75018),i=r(42938),a=r(77391),l=r(43210),o=r(61939),d=r(88806),c=r(28274),u=r(50772),p=r(47541),x=r(53185);let h=()=>{let[e,t]=(0,l.useState)(0),{navigateBack:r}=(0,o.cq)(),{activeStep:a}=(0,l.useContext)(x.X2);return(0,l.useEffect)(()=>{t(a)},[a]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(n.RG,{setActive:t,title:"Consultation Plan",steps:[{id:12,label:"Differential Diagnosis"},{id:1,label:"Investigations"},{id:13,label:"Final Diagnosis"}],active:e,onBack:()=>r(),children:[(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A,{conceptType:i.W.DIFFERENTIAL_DIAGNOSIS}),(0,s.jsx)(m,{onNext:()=>t(1)})]}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.$,{}),(0,s.jsx)(m,{onNext:()=>t(2),onPrevious:()=>t(0)})]}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.A,{conceptType:i.W.FINAL_DIAGNOSIS}),(0,s.jsx)(m,{onNext:()=>t(3),onPrevious:()=>t(1)})]})]})})},m=({onPrevious:e,onNext:t})=>(0,s.jsxs)(c.default,{sx:{mt:"1ch"},children:[e&&(0,s.jsx)(u.A,{sx:{mr:"0.5ch"},size:"small",variant:"contained",color:"inherit",onClick:e,children:"Previous"}),t&&(0,s.jsx)(u.A,{size:"small",variant:"contained",onClick:t,children:"Next"})]}),f=(0,a.A)(function(){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.TF,{}),(0,s.jsx)(n.MG,{children:(0,s.jsx)(h,{})})]})},[i.Ot.CLINICIAN,i.Ot.NURSE,i.Ot.ADMIN,i.Ot.STUDENT_CLINICIAN])},7854:(e,t,r)=>{Promise.resolve().then(r.bind(r,28321))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},11997:e=>{"use strict";e.exports=require("punycode")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28321:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/pk/App/hwis/aetc/app/patient/[id]/consultation/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/pk/App/hwis/aetc/app/patient/[id]/consultation/page.tsx","default")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},42533:(e,t,r)=>{"use strict";r.d(t,{fS:()=>g,G5:()=>j,Xt:()=>m,Jl:()=>h,RO:()=>f});var s=r(42938),n=r(60579),i=r(62116);let a=e=>c(e),l=()=>c(s.W.INVESTIGATIONS),o=e=>(0,n.vt)(e,"/lab/orders"),d=e=>(0,n.UK)(`/lab/orders?patient=${e}`),c=async e=>{let t=await (0,i.cr)(e);return(0,n.UK)(`/concepts/${t?.data[0].uuid}/set_members?paginate=false`)};var u=r(29494),p=r(8693),x=r(54050);let h=e=>{let t=async()=>a(e).then(e=>e.data.filter(e=>e.names.length>0&&e.names.some(e=>e?.name)).map(e=>({...e,name:e.names.find(e=>e?.name)?.name})).sort((e,t)=>e.name.localeCompare(t.name)));return(0,u.I)({queryKey:["testTypes",e],queryFn:t,enabled:!0})},m=()=>{let e=async()=>l().then(e=>e.data.sort((e,t)=>e.names[0].name.localeCompare(t.names[0].name)));return(0,u.I)({queryKey:["getSpecimenTypes"],queryFn:e,enabled:!0})},f=e=>{let t=async()=>d(e).then(e=>e.data);return(0,u.I)({queryKey:["patientsOrder",e],queryFn:t,enabled:!0})},j=e=>{let t=async()=>c(e).then(e=>e.data);return(0,u.I)({queryKey:["concept-setMembers",e],queryFn:t,enabled:!1})},g=e=>{let t=(0,p.jE)();return(0,x.n)({mutationFn:e=>o(e).then(e=>e.data),onSuccess:()=>{t.invalidateQueries({queryKey:["patientsOrder"]})}})}},50727:(e,t,r)=>{"use strict";r.d(t,{SE:()=>v,Nt:()=>j,Wd:()=>y});var s=r(60687),n=r(43210),i=r(76166),a=r.n(i),l=r(75018),o=r(52773),d=r(89086),c=r.n(d),u=r(51060),p=r(28274),x=r(78590),h=r(69587),m=r(12755);let f=({getValue:e})=>{let[t,r]=(0,n.useState)("http://localhost:3000"),{data:i,isLoading:a}=(0,m.Ay)();return(0,n.useEffect)(()=>{e(t)},[t]),(0,s.jsx)(h.x,{getValue:e=>{r(e)},label:"Select Printer",options:i?i?.map(e=>({value:e.ip_address,label:e.name})):[]})},j=({value:e,children:t,setTriggerFunc:r,printer:i,orderDate:d})=>{let c=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=async()=>{let e=document.getElementById("barcode");e&&g("test",await o.mo(e),i)};r(()=>e)},[i]),(0,s.jsx)(l.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,s.jsx)("div",{id:"barcode",children:(0,s.jsxs)(l.jD,{sx:{pb:"8px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},ref:c,children:[t,(0,s.jsx)(a(),{width:6,height:120,margin:0,displayValue:!1,value:e})]})})})},g=async(e,t,r)=>{let s=t.toDataURL("image/png");try{let e=await c().encode(s),t=`^XA^FO20,20${e}^XZ`;await u.A.post(`${r}/print`,{zpl:t})}catch(e){console.error("Error encoding image to ZPL:",e)}},y=({presentingComplaints:e,vitals:t,date:r,arrivalTime:i,referredFrom:a,triageCategory:d,triagedBy:c})=>{let[u,m]=(0,n.useState)(""),[j,y]=(0,n.useState)(""),v=async()=>{let e=document.getElementById("triage");e&&g("test",await o.mo(e),u)};return(0,s.jsxs)(p.default,{children:[(0,s.jsx)("div",{id:"triage",children:(0,s.jsx)(l.jD,{sx:{p:"5px",display:"flex",flexDirection:"column",alignItems:"center"},children:(0,s.jsxs)(p.default,{sx:{width:"100%"},children:[(0,s.jsxs)(x.default,{variant:"body2",mr:"1ch",children:["Arrival Date Time: ",i]}),(0,s.jsxs)(p.default,{sx:{display:"flex",width:"100%"},children:[(0,s.jsxs)(x.default,{variant:"body2",mr:"1ch",children:["Triage Date Time: ",r]}),(0,s.jsxs)(x.default,{variant:"body2",children:["Referred From: ",a]})]}),(0,s.jsxs)(p.default,{sx:{display:"flex"},children:[(0,s.jsxs)(x.default,{mr:"1ch",variant:"body1",children:["Category: ",d]}),(0,s.jsxs)(x.default,{variant:"body1",children:["Reason: ",j]})]}),(0,s.jsxs)(x.default,{sx:{mt:"1ch"},variant:"subtitle1",children:["Presenting Complaints: ",e," "]}),(0,s.jsx)(l.jD,{sx:{display:"flex",border:"dashed",my:"1ch"},children:t.map(({name:e,value:t})=>(0,s.jsx)(b,{title:e,value:t},`${t}${e}`))}),(0,s.jsxs)(x.default,{variant:"body1",children:["Triaged By: ",c]})]})})}),(0,s.jsx)(h.x,{getValue:e=>y(e),label:"Reasons for triage category:",options:[{value:"Vitals above/below threshold",label:"Vitals above/below threshold"},{value:"Airway/Breathing compromised",label:"Airway/Breathing compromised"},{value:"Blood circulation compromised",label:"Blood circulation compromised"},{value:"Disability",label:"Disability"},{value:"Persistent pain and other concerns ",label:"Persistent pain and other concerns "}]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(f,{getValue:e=>m(e)}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(l.O6,{onClick:v,title:"print"})]})},b=({title:e,value:t})=>(0,s.jsxs)(l.jD,{sx:{mx:"0.5ch",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)(l.Th,{variant:"h6",textAlign:"center",children:e}),(0,s.jsx)(l.Th,{variant:"h6",children:t})]}),v=({value:e,children:t,setTriggerFunc:r,printer:i,orderDate:l,test:d,fullName:c,gender:u,description:p})=>{let x=(0,n.useRef)(null);return(0,n.useEffect)(()=>{r(async()=>{let e=document.getElementById("barcode");if(e){let t=await o.mo(e),r=document.createElement("canvas");r.width=700,r.height=160;let s=r.getContext("2d");if(s){s.fillStyle="#ffffff",s.fillRect(0,0,700,160);let e=t.width/t.height,n=700,a=700/e;a>160&&(n=(a=160)*e);let l=(700-n)/2,o=(160-a)/2;s.drawImage(t,0,0,t.width,t.height,l,o,n,a),g("test",r,i)}}})},[i,r]),(0,s.jsxs)("div",{id:"barcode",ref:x,style:{display:"flex",flexDirection:"column",paddingLeft:"5ch"},children:[(0,s.jsxs)("b",{style:{fontSize:"0.5rem",lineHeight:"1"},children:[c,"(",u,")~",p]}),(0,s.jsx)("b",{style:{fontSize:"0.5rem",lineHeight:"1"},children:l}),(0,s.jsx)(a(),{width:1,height:45,margin:0,displayValue:!1,value:e}),(0,s.jsx)("b",{style:{fontSize:"0.5rem"},children:d})]})}},51040:(e,t,r)=>{"use strict";r.d(t,{M:()=>C});var s=r(60687),n=r(61939),i=r(42533),a=r(75018),l=r(50727),o=r(76990),d=r(43210),c=r(28274),u=r(50772),p=r(71072),x=r(51110),h=r(20981),m=r(68730),f=r(69612),j=r(7850),g=r(2351),y=r(27621),b=r(47121),v=r(78590),w=r(69587),A=r(88794),q=r(12755);let C=()=>{let{data:e}=(0,q.Ay)(),t=(0,d.useRef)(null),{params:r}=(0,n.KU)(),{data:C}=(0,o.GN)(r.id),{data:I}=(0,i.RO)(r?.id),[N,S]=(0,d.useState)(!1),[D,P]=(0,d.useState)({sampleType:"",ascension:"",tests:"",orderDate:"",requestingTechnician:"",description:""}),[_,k]=(0,d.useState)("http://localhost:3000"),[T,E]=(0,d.useState)(!1),[F,O]=(0,d.useState)([{name:"",value:"",testName:""}]),R=(0,d.useCallback)((e,t)=>{O(e.map(e=>({name:e.indicator.name,value:e.value,testName:t}))),E(!0)},[]),B=(0,d.useCallback)(()=>{E(!1)},[]),G=(0,d.useCallback)(e=>{t.current=e},[]),U=[{field:"specimen",headerName:"Specimen",flex:1,renderCell:e=>e.row.specimen.name},{field:"test",headerName:"Test(s)",flex:1,renderCell:e=>e.row.test.name},{field:"requesting_clinician",headerName:"Ordered By",flex:1},{field:"status",headerName:"Status",flex:1},{field:"accessionNumber",headerName:"Accession Number",flex:1,renderCell:e=>e.row.accession_number},{field:"action",headerName:"Action",flex:1,renderCell:e=>(0,s.jsx)(c.default,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.A,{disabled:!(e.row.test.result&&e.row.test.result.length>0),variant:"contained",onClick:()=>{R(e.row.test.result,e.row.test.name)},sx:{width:"48%",padding:"4px 8px"},children:"View"}),(0,s.jsxs)(p.A,{open:T,onClose:B,maxWidth:"sm",fullWidth:!0,children:[(0,s.jsxs)(x.A,{children:["Test results for ",F[0].testName]}),(0,s.jsx)(h.A,{children:(0,s.jsxs)(m.A,{children:[(0,s.jsx)(f.A,{children:(0,s.jsxs)(j.A,{children:[(0,s.jsx)(g.A,{children:"Measure"}),(0,s.jsx)(g.A,{children:"Result"})]})}),(0,s.jsx)(y.A,{children:F.map((e,t)=>(0,s.jsxs)(j.A,{children:[(0,s.jsx)(g.A,{children:e.name}),(0,s.jsx)(g.A,{children:e.value})]},t))})]})}),(0,s.jsx)(b.A,{children:(0,s.jsx)(u.A,{onClick:B,color:"primary",children:"Close"})})]}),(0,s.jsx)(a.O6,{title:"print",variant:"secondary",onClick:()=>{S(!0),P({sampleType:e.row.specimen.name,ascension:e.row.accession_number,orderDate:(0,A.kh)(e.row.order_date),tests:e.row.test.name,requestingTechnician:e.row.requesting_clinician,description:e.row.comment_to_fulfiller})},sx:{width:"48%",padding:"4px 8px"}})]})})}],$=I?.flatMap(e=>e.tests.map(t=>({...e,id:t.id,test:t,status:t.result?"Results Available":"Waiting for result(s)"})))||[];return(0,s.jsxs)(s.Fragment,{children:[0===$.length?(0,s.jsx)(v.default,{children:"No lab orders added"}):(0,s.jsx)(a.WE,{height:"25ch",showTopBar:!1,rowHeight:25,rows:$,columns:U}),(0,s.jsx)(a.eV,{maxWidth:"sm",open:N,onClose:()=>S(!1),title:"Preview Barcode",children:(0,s.jsxs)(a.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)(l.SE,{printer:_,orderDate:D.orderDate,setTriggerFunc:G,value:D.ascension,test:`${D.tests}|${D.ascension}|${D.requestingTechnician.split(" ")[1]}`,fullName:`${C?.given_name} ${C?.family_name}`,gender:C?.gender,description:D.description,children:(0,s.jsx)(s.Fragment,{})}),(0,s.jsx)("br",{}),(0,s.jsx)(w.x,{getValue:e=>{k(e)},label:"Select Printer",options:e?e?.map(e=>({value:e.ip_address,label:e.name})):[]}),(0,s.jsx)("br",{}),(0,s.jsx)(a.O6,{title:"Print Barcode",onClick:()=>{t.current&&"function"==typeof t.current&&(t.current(),S(!1))}})]})})]})}},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70902:(e,t,r)=>{Promise.resolve().then(r.bind(r,4436))},74075:e=>{"use strict";e.exports=require("zlib")},77391:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var s=r(60687),n=r(23641),i=r(61939),a=r(43210),l=r(41930),o=r(75018),d=r(30474),c=r(87748);function u(e,t){return function(r){let[o,d]=(0,a.useState)(!1),{navigateTo:u}=(0,i.cq)(),x=(0,l.R)(t,(0,c.O)());return o?x?(0,s.jsx)(e,{...r}):(0,s.jsx)(p,{}):(0,s.jsx)(n.OverlayLoader,{open:!o})}}let p=()=>(0,s.jsx)(o.jD,{sx:{width:"100%",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff"},children:(0,s.jsx)(d.default,{src:"/403.jpg",height:500,width:500,alt:"403"})})},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},82334:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(65239),n=r(48088),i=r(88170),a=r.n(i),l=r(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["patient",{children:["[id]",{children:["consultation",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,28321)),"/Users/pk/App/hwis/aetc/app/patient/[id]/consultation/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,20800)),"/Users/pk/App/hwis/aetc/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,52608)),"/Users/pk/App/hwis/aetc/app/error.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/pk/App/hwis/aetc/app/patient/[id]/consultation/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/patient/[id]/consultation/page",pathname:"/patient/[id]/consultation",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},83997:e=>{"use strict";e.exports=require("tty")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,6724,346,1658,485,7567,7549,1146,4431,2781,2594],()=>r(82334));module.exports=s})();