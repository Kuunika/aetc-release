"use strict";exports.id=1272,exports.ids=[1272],exports.modules={18345:(e,t,i)=>{i.d(t,{c:()=>c});var s=i(60687);i(43210);var a=i(75018),r=i(30485),l=i(55330);let n={npid:{name:"npid",label:"NPID"}},d=r.Ik().shape({[n.npid.name]:r.Yj().required().label(n.npid.label)}),o=(0,l.f6)(n),c=({onSubmit:e,init:t})=>(0,s.jsx)(a.PD,{validationSchema:d,initialValues:{...o,...t},onSubmit:e,submitButton:!1,children:(0,s.jsxs)(a.jD,{children:[(0,s.jsx)(a.A8,{sx:{width:"100%",my:0},name:n.npid.name,id:n.npid.name,size:"small",label:n.npid.label}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(a.O6,{sx:{width:"100%",height:"5ch",borderRadius:"10px"},type:"submit",onClick:()=>{},title:"search"})]})})},28706:(e,t,i)=>{i.d(t,{B:()=>u});var s=i(60687);i(43210);var a=i(75018),r=i(30485),l=i(55330),n=i(42938);let d={firstName:{name:"firstName",label:"First Name"},phoneNumber:{name:"phoneNumber",label:"Phone Number"},lastName:{name:"lastName",label:"Last Name"},dob:{name:"birthDate",label:"Estimated Age"},gender:{name:"gender",label:"Gender"},homeDistrict:{name:"homeDistrict",label:"Home District"},nationality:{name:"nationality",label:"Nationality"},homeTraditionalAuthority:{name:"homeTraditionalAuthority",label:"Home Traditional Authority"},homeVillage:{name:"homeVillage",label:"Home Village"}},o=r.Ik().shape({[d.firstName.name]:r.Yj().required().label(d.firstName.label),[d.lastName.name]:r.Yj().required().label(d.lastName.label),[d.dob.name]:r.Yj().label(d.dob.label),[d.gender.name]:r.Yj().required().label(d.gender.label),[d.homeDistrict.name]:r.Yj().label(d.homeDistrict.label),[d.homeTraditionalAuthority.name]:r.Yj().label(d.homeTraditionalAuthority.label),[d.homeVillage.name]:r.Yj().label(d.homeVillage.label)}),c=(0,l.f6)(d),u=({onSubmit:e,init:t,fullForm:i=!0})=>{let r={display:"flex","& > :first-of-type":{mr:"5px"}};return(0,s.jsx)(a.PD,{validationSchema:o,initialValues:{...c,...t},onSubmit:e,submitButton:!1,enableReinitialize:!0,children:(0,s.jsxs)(a.jD,{children:[(0,s.jsxs)(a.jD,{sx:{...r,alignItems:"end",py:"1ch"},children:[(0,s.jsx)(a.A8,{sx:{width:"100%",my:0},name:d.firstName.name,id:d.firstName.name,size:"small",label:d.firstName.label}),(0,s.jsx)(a.A8,{sx:{width:"100%",my:0,mr:"5px"},name:d.lastName.name,id:d.lastName.name,size:"small",label:d.lastName.label}),(0,s.jsx)(a.el,{width:"100%",inputSx:{m:0},name:d.gender.name,label:d.gender.label,multiple:!1,size:"small",applyPadding:!1,options:[{label:"Male",id:"M"},{label:"Female",id:"F"}]})]}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.jD,{sx:{...r},children:[(0,s.jsx)(a.el,{width:"30%",name:d.gender.name,label:d.gender.label,multiple:!1,size:"small",options:[{label:"Male",id:"Male"},{label:"Female",id:"Female"}]}),(0,s.jsx)(a.A8,{sx:{width:"100%",my:0},name:d.dob.name,id:d.dob.name,size:"small",label:d.dob.label})]}),(0,s.jsxs)(a.jD,{display:"flex",children:[(0,s.jsx)(a.el,{sx:{mr:"0.5ch"},width:"45%",size:"small",name:d.homeDistrict.name,label:d.homeDistrict.label,multiple:!1,options:n.kJ.map(e=>({id:e.district_name,label:e.district_name}))}),(0,s.jsx)(a.el,{width:"100%",size:"small",name:d.homeTraditionalAuthority.name,label:d.homeTraditionalAuthority.label,multiple:!1,options:n.ZD})]}),(0,s.jsx)(a.jD,{children:(0,s.jsx)(a.el,{width:"100%",size:"small",name:d.homeVillage.name,label:d.homeVillage.label,multiple:!1,options:n.rJ})})]}),(0,s.jsx)(a.O6,{sx:{width:"100%",height:"5ch",borderRadius:"10px",mt:"1ch"},type:"submit",onClick:()=>{},title:"search"})]})})}},59703:(e,t,i)=>{i.d(t,{g:()=>c});var s=i(60687),a=i(43210),r=i(60716),l=i(82202),n=i(28274);function d(e){let{children:t,value:i,index:a,...r}=e;return(0,s.jsx)("div",{role:"tabpanel",hidden:i!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...r,children:i===a&&(0,s.jsx)(n.default,{children:t})})}function o(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}function c({demographics:e,npid:t}){let[i,c]=a.useState(0);return(0,s.jsxs)(n.default,{sx:{width:"100%"},children:[(0,s.jsx)(n.default,{children:(0,s.jsxs)(r.A,{value:i,onChange:(e,t)=>{c(t)},"aria-label":"basic tabs example",centered:!0,children:[(0,s.jsx)(l.A,{label:"Demographics",...o(0)}),(0,s.jsx)(l.A,{label:"NPID",...o(1)})]})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(d,{value:i,index:0,children:e}),(0,s.jsx)(d,{value:i,index:1,children:t})]})}},85121:(e,t,i)=>{i.d(t,{V:()=>n});var s=i(60687),a=i(61939),r=i(75018),l=i(89061);let n=({title:e,link:t})=>{let{navigateTo:i}=(0,a.cq)(),n={fontFamily:"Inter",fontSize:"14px",fontWeight:400,lineHeight:"21px",letterSpacing:"0em",textAlign:"center",mx:"1ch"};return(0,s.jsxs)(r.jD,{sx:{display:"flex",justifyContent:"space-evenly",py:"1ch",borderBottom:"solid 1px #E6E6E6"},children:[(0,s.jsxs)(r.jD,{onClick:()=>i(t),sx:{display:"flex",cursor:"pointer"},children:[(0,s.jsx)(r.Th,{children:(0,s.jsx)(l.oWm,{})}),(0,s.jsx)(r.Th,{sx:n,children:"Go back"})]}),(0,s.jsx)(r.Th,{sx:n,children:e}),(0,s.jsxs)(r.jD,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(l.M4e,{}),(0,s.jsx)(r.Th,{sx:n,children:"Need any help?"})]})]})}},96982:(e,t,i)=>{i.d(t,{$:()=>Z,Q:()=>ee});var s=i(60687),a=i(23641),r=i(53185);let l=e=>{let t=e?.remotes?.map(e=>({...e.person,identifiers:e.identifiers,patient_id:e.identifiers[0]?.identifier,given_name:e.person.names[0].given_name,family_name:e.person.names[0].family_name,addresses:e.addresses,uuid:e.identifiers[1]?.identifier}));return e?{remotes:t,locals:e.locals}:{remotes:[],locals:[]}};var n=i(76990),d=i(92248),o=i(43210),c=i(28706),u=i(18345),m=i(75018);i(30474);var x=i(33164),h=i(61939),b=i(89061),j=i(32039),f=i(62116),p=i(13670),g=i(42938),y=i(80222),S=i(44504),v=i(30485),N=i(5608);let E=v.Ik().shape({[g.W.REFERRED_FROM]:v.Yj().label("Referee Medical Facility"),[g.W.ADDITIONAL_NOTES]:v.Yj()}),D=({onSubmit:e,submitButton:t=!0,setContext:i=e=>{}})=>{let{data:a}=(0,h.WL)(),[r,l]=(0,o.useState)("yes"),[n,d]=(0,o.useState)("");return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(m.PD,{validationSchema:E,initialValues:{[g.W.REFERRED_FROM]:"",[g.W.ADDITIONAL_NOTES]:"yes"},onSubmit:e,submitButtonText:"submit",submitButton:t,children:[(0,s.jsx)(x.Ji,{setFormContext:i}),(0,s.jsx)(N.uQ,{children:"Health Facilities"}),(0,s.jsx)(m.el,{label:"Referral Medical Facility",name:g.W.REFERRED_FROM,getValue:d,multiple:!1,disabled:"no"==r,options:a?a.map(e=>({id:e.facility_name,label:e.facility_name})):[]}),""==n&&(0,s.jsx)(m.b1,{name:g.W.ADDITIONAL_NOTES,getValue:e=>{l(e)},label:"Is the facility you are looking for available?",options:[{label:"Yes",value:"yes"},{label:"No",value:"no"}]}),"no"==r&&(0,s.jsx)(m.A8,{name:g.W.REFERRED_FROM,label:"Other Facility",id:g.W.REFERRED_FROM})]})})};var A=i(93251),T=i(28961),_=i(43102),R=i(82373),C=i(55330),O=i(28274),F=i(78590),I=i(79534);let P=({patient:e,open:t,onClose:i})=>{let{navigateTo:a}=(0,h.cq)(),[r,l]=(0,o.useState)(0),[n,d]=(0,o.useState)({});return(0,s.jsx)(m.eV,{onClose:i,open:t,title:"Remote Patient",children:(0,s.jsx)(O.default,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:(0,s.jsxs)(O.default,{sx:{width:{sm:"100%",lg:"40%"}},children:[0==r&&(0,s.jsx)(w,{patient:e,next:()=>l(1)}),1==r&&(0,s.jsx)(k,{setUpdatedPatient:d,person:e,next:()=>l(2)}),2==r&&(0,s.jsx)(M,{next:()=>l(3)}),3==r&&(0,s.jsx)(W,{next:()=>l(4)}),4==r&&(0,s.jsx)(Y,{next:()=>l(5)}),5==r&&(0,s.jsx)(V,{next:()=>l(6)}),6==r&&(0,s.jsx)(L,{next:()=>l(7)}),7==r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.Yc,{firstName:n.given_name,lastName:n.family_name,addresses:n?.addresses?n?.addresses:[],identifiers:n.identifiers}),(0,s.jsx)("br",{}),(0,s.jsx)(m.O6,{title:"Register More",sx:{mr:"1px"},onClick:()=>a("/registration/list")}),(0,s.jsx)(m.O6,{title:"Home",onClick:()=>a("/dashboard")})]})]})})})},w=({patient:e,next:t})=>{let{params:i}=(0,h.KU)(),[a,r]=(0,o.useState)({firstName:"",lastName:"",birthDate:"",gender:"",birthDateEstimated:""}),[l,d]=(0,o.useState)({nationality:"",district:"",village:"",traditionalAuthority:""}),[c,u]=(0,o.useState)({district:"",traditionalAuthority:"",village:"",closeLandMark:""}),x=e=>{e&&d({nationality:e?.addresses[0]?.country??"",district:e?.addresses[0]?.address1??"",village:e?.addresses[0]?.address2??"",traditionalAuthority:e?.addresses[0]?.county_district??""})},b=e=>{e&&u({district:e?.addresses[0]?.current_district??"",traditionalAuthority:e?.addresses[0]?.current_traditional_authority??"",village:e?.addresses[1]?.address1??"",closeLandMark:e?.addresses[1]?.address2??""})},j=e=>{e&&r({firstName:e?.given_name,lastName:e?.family_name,birthDate:e?.birthdate,gender:e?.gender,birthDateEstimated:!!e?.birthdateEstimated})},{mutate:f,isPending:p,isSuccess:g,data:y}=(0,n.h1)();return(0,o.useEffect)(()=>{g&&t()},[g]),(0,o.useEffect)(()=>{j(e),x(e),b(e)},[e]),(0,s.jsxs)(O.default,{children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(F.default,{variant:"h5",children:"Demographics"}),(0,s.jsx)("br",{}),(0,s.jsx)(H,{label:"First Name",value:a.firstName}),(0,s.jsx)(H,{label:"Last Name",value:a.lastName}),(0,s.jsx)(H,{label:"Gender",value:a.gender}),(0,s.jsx)(H,{label:"Date of birth",value:a.birthDate})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(F.default,{variant:"h5",children:"Home Location"}),(0,s.jsx)("br",{}),(0,s.jsx)(H,{label:"Country",value:l.nationality}),(0,s.jsx)(H,{label:"Home District",value:l.district}),(0,s.jsx)(H,{label:"Home Traditional Authority",value:l.traditionalAuthority}),(0,s.jsx)(H,{label:"Home Village",value:l.village})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(F.default,{variant:"h5",children:"Current Location"}),(0,s.jsx)("br",{}),(0,s.jsx)(H,{label:"Current District",value:c.district}),(0,s.jsx)(H,{label:"Current Traditional Authority",value:c.traditionalAuthority}),(0,s.jsx)(H,{label:"Current Village",value:c.village}),(0,s.jsx)(H,{label:"Close Land Mark",value:c.closeLandMark})]}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"Merge",onClick:()=>{f({primary:{patient_id:i?.id},secondary:[{doc_id:e.uuid}]})}})]})},k=({next:e,person:t,setUpdatedPatient:i})=>{let{mutate:r,isPending:l,isSuccess:d,data:c}=(0,n.Wv)(),{mutate:u,isPending:x,isSuccess:b,data:j}=(0,n.Wv)(),{params:f}=(0,h.KU)(),[p,y]=(0,o.useState)({}),[S,v]=(0,o.useState)({}),[N,E]=(0,o.useState)(),[D,A]=(0,o.useState)(),[T,R]=(0,o.useState)(),[C,O]=(0,o.useState)([]);(0,o.useEffect)(()=>{d&&e()},[d]);let I=e=>{let t={identifiers:e.identificationNumber?[{identifier:e.identificationNumber,identifierType:g.W.NATIONAL_ID_IDENTIFIER_TYPE,preferred:!0}]:[],names:[{givenName:e.firstName,familyName:e.lastName}],gender:e.gender,birthdateEstimated:e.birthdateEstimated,birthdate:e.birthDate};r({id:f?.id,data:t})},P=()=>{let e=[{address1:p?.district,address2:p?.village,address3:S?.district,stateProvince:S?.traditionalAuthority,countyDistrict:p?.traditionalAuthority,cityVillage:p?.traditionalAuthority,country:p?.nationality,preferred:!0},{address1:S?.village,address2:S?.closeLandMark,countryDistrict:S?.district,cityVillage:S?.traditionalAuthority,preferred:!1}];u({id:f?.id,data:{addresses:e}})};(0,o.useEffect)(()=>{0!=Object.keys(p).length&&0!=Object.keys(S).length&&P()},[p,S]),(0,o.useEffect)(()=>{b&&(i(j?.patient),e())},[b]);let w=t.identifiers.find(e=>e?.identifier_type?.uuid==g.W.NATIONAL_ID_IDENTIFIER_TYPE)?.identifier;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.OverlayLoader,{open:l}),(0,s.jsxs)(B,{children:[(0,s.jsx)(F.default,{variant:"h5",children:"Edit Demographics"}),(0,s.jsx)("br",{}),(0,s.jsx)(_.H5,{setContext:E,submitButton:!1,initialValues:{identificationNumber:w,firstName:t.given_name,lastName:t.family_name,gender:t.gender,birthDate:t.birthdate,birthdateEstimated:!1},onSubmit:e=>{I(e)}})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(F.default,{variant:"h5",children:"Home Location"}),(0,s.jsx)("br",{}),(0,s.jsx)(_.CB,{setContext:A,initialValues:{nationality:t?.addresses[0]?.country??"",district:t?.addresses[0]?.address1??"",village:t?.addresses[0]?.address2??"",traditionalAuthority:t?.addresses[0]?.county_district??""},onSubmit:y,submitButton:!1})]}),(0,s.jsxs)(B,{children:[(0,s.jsx)(F.default,{variant:"h5",children:"Current Location"}),(0,s.jsx)("br",{}),(0,s.jsx)(_.CB,{currentLocation:!0,setContext:R,initialValues:{district:t?.addresses[0]?.current_district??"",traditionalAuthority:t?.addresses[0]?.current_traditional_authority??"",village:t?.addresses[1]?.address1??"",closeLandMark:t?.addresses[1]?.address2??""},onSubmit:v,submitButton:!1})]}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:e,errors:t,isValid:i,touched:s,dirty:a}=N,{submitForm:r,errors:l,isValid:n,touched:d,dirty:o}=D,{submitForm:c,errors:u,isValid:m,touched:x,dirty:h}=T;e(),r(),c()}})]})},M=({next:e})=>{let{ServerTime:t}=(0,S.useServerTime)(),{activeVisit:i}=(0,h.gd)(),{params:r}=(0,h.KU)(),{mutate:l,isSuccess:n,isPending:d,isError:c}=(0,f.Fs)(),[u,x]=(0,o.useState)();return(0,o.useEffect)(()=>{n&&e()},[n]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(B,{children:[(0,s.jsx)(a.OverlayLoader,{open:d}),(0,s.jsx)(_._T,{submitButton:!1,setContext:x,initialValues:{},onSubmit:e=>{let s=t.getServerTimeString();l({encounterType:g.fA.SOCIAL_HISTORY,visit:i,patient:r.id,encounterDatetime:s,obs:(0,C.gX)(e,s)})}})]}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:e,errors:t,isValid:i,touched:s,dirty:a}=u;e()}})]})},V=({next:e})=>{let{ServerTime:t}=(0,S.useServerTime)(),[i,a]=(0,o.useState)(),{params:r}=(0,h.KU)(),{activeVisit:l}=(0,h.gd)(),{mutate:n,isSuccess:d,isPending:c,isError:u}=(0,f.Fs)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{children:(0,s.jsx)(D,{setContext:a,submitButton:!1,onSubmit:e=>{let i=t.getServerTimeString();n({encounterType:g.fA.REFERRAL,visit:l,patient:r.id,encounterDatetime:i,obs:(0,C.gX)(e,i)})}})}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:t,errors:s,isValid:a,touched:r,dirty:l}=i;t(),e()}})]})},L=({next:e})=>{let{ServerTime:t}=(0,S.useServerTime)(),[i,a]=(0,o.useState)(),{params:r}=(0,h.KU)(),{activeVisit:l}=(0,h.gd)(),{mutate:n,isSuccess:d,isPending:c,isError:u}=(0,f.Fs)();return(0,o.useEffect)(()=>{d&&e()},[d]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{children:(0,s.jsx)(_.OE,{initialValues:{},setContext:a,submitButton:!1,onSubmit:e=>{let i=t.getServerTimeString(),s=e[g.W.PAYMENT_OPTIONS].filter(e=>e.value).map(e=>({concept:g.W.PAYMENT_OPTIONS,value:e.key,obsDatetime:i}));n({encounterType:g.fA.FINANCING,visit:l,patient:r.id,encounterDatetime:i,obs:[...(0,C.gX)(e,i),...s]})}})}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:t,errors:s,isValid:a,touched:r,dirty:l}=i;t(),e()}})]})},W=({next:e})=>{let{ServerTime:t}=(0,S.useServerTime)(),[i,a]=(0,o.useState)(),[r,l]=(0,o.useState)(""),{patient:n}=(0,h.gd)(),{mutate:c,isPending:u,isSuccess:x,data:b,isError:j}=(0,d.AU)(),{mutate:f,isPending:p,isSuccess:g,isError:y,data:v}=(0,d.bJ)();return(0,o.useEffect)(()=>{g&&(t.getServerTimeString(),c({patient:n?.uuid,person:v?.uuid,nextOfKinRelationship:r}))},[g]),(0,o.useEffect)(()=>{x&&e()},[x]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{children:(0,s.jsx)(_.tc,{initialValues:{},setContext:a,submitButton:!1,onSubmit:e=>{f(e),l(e.relationship)}})}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:e,errors:t,isValid:s,touched:a,dirty:r}=i;e()}})]})},Y=({next:e})=>{let{params:t}=(0,h.KU)(),[i,a]=(0,o.useState)(),{mutate:r,isPending:l,isSuccess:n,isError:c,data:u}=(0,d.bJ)(),{mutate:x,isPending:b,isSuccess:j,data:f,isError:p}=(0,d.AU)();return(0,o.useEffect)(()=>{n&&x({patient:t?.id,person:u?.uuid,nextOfKinRelationship:g.W.GUARDIAN})},[n]),(0,o.useEffect)(()=>{j&&e()},[j]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B,{children:(0,s.jsx)(_.tc,{isGuardian:!0,initialValues:{given_name:"",family_name:"",relationship:g.W.GUARDIAN},setContext:a,submitButton:!1,onSubmit:e=>{console.log({values:e}),r({nextOfKinFirstName:e.given_name,nextOfKinLastName:e.family_name})}})}),(0,s.jsx)(m.O6,{sx:{width:"100%",borderRadius:"1ch"},title:"submit",onClick:()=>{let{submitForm:e,errors:t,isValid:s,touched:a,dirty:r}=i;e(),console.log(t)}})]})},B=({children:e})=>(0,s.jsx)(I.default,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",p:"1ch",flex:1,my:"1ch"},children:e}),H=({label:e,value:t})=>(0,s.jsxs)(O.default,{sx:{display:"flex",alignItems:"flex-start",py:"0.5ch",mb:"0.5ch",borderBottom:"#D8D8D8 solid 1px"},children:[(0,s.jsx)(F.default,{width:"20ch",sx:{fontSize:"0.8rem"},children:e}),(0,s.jsx)(F.default,{fontWeight:"900",sx:{fontSize:"0.8rem",textTransform:"capitalize"},children:t})]});var U=i(50772),$=i(88334),z=i(34987);let G=({searchedPatient:e,searchResults:t,genericSearch:i})=>{let{navigateTo:a}=(0,h.cq)(),{params:l}=(0,h.KU)(),[n,d]=(0,o.useState)(!1),{setRegistrationType:c,setPatient:u,patient:x}=(0,o.useContext)(r.$0),[b,j]=(0,o.useState)(""),{setPatient:f}=(0,o.useContext)(r.$0),p=()=>{f(e),a(`/registration/${l.id}/new`)},g=(e,t)=>{u(e),d(!0),j(t)},y=t?.locals?.length==0&&t?.remotes?.length==0;return(0,s.jsxs)(m.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)(m.Th,{variant:"h5",children:"Search Results"}),y&&(0,s.jsxs)(m.jD,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)("br",{}),(0,s.jsx)(m.Th,{variant:"body2",children:"No patient with similar demographics found"}),(0,s.jsx)("br",{}),!i&&(0,s.jsx)(m.O6,{sx:{mr:"0.2ch",borderRadius:"1px"},variant:"secondary",title:"add new record",onClick:p})]}),(0,s.jsx)("br",{}),!y&&(0,s.jsx)(m.jD,{sx:{width:"100%"},children:!i&&(0,s.jsx)(m.O6,{sx:{mr:"0.2ch",borderRadius:"1px"},variant:"secondary",title:"add new record",onClick:p})}),(0,s.jsx)("br",{}),(0,s.jsxs)(m.jD,{sx:{width:"100%",height:"50ch",overflow:"scroll"},children:[t?.locals?.map(e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(K,{genericSearch:i,setOpen:e=>!i&&g(e,"local"),type:"Local",person:e},e?.uuid)})),t?.remotes?.map(e=>(0,s.jsx)(K,{genericSearch:i,setOpen:e=>!i&&g(e,"remote"),type:"Remote",person:e},e?.uuid))]}),"local"==b&&(0,s.jsx)(J,{type:b,patient:x||{},onClose:()=>d(!1),open:n}),"remote"==b&&(0,s.jsx)(P,{patient:x||{},onClose:()=>d(!1),open:n})]})},K=({person:e,type:t,setOpen:i,genericSearch:a})=>{let[r,l]=(0,o.useState)(!1),{navigateTo:n}=(0,h.cq)();if((0,o.useEffect)(()=>{l(!!e?.active_visit)},[e]),!e)return(0,s.jsx)(s.Fragment,{});let d=e?.identifiers?.find(e=>e?.identifier_type?.name=="National id");return(0,s.jsxs)(m.sc,{onClick:()=>{r||i(e)},sx:{display:"flex",padding:2,width:"100%",my:1,cursor:"pointer"},children:[(0,s.jsxs)(m.jD,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",mr:1},children:[(0,s.jsx)(m.jD,{sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#F5F5F5"},children:(0,s.jsx)(m.Th,{color:m.zQ.primary,variant:"h1",children:(0,s.jsx)(b.x$1,{})})}),(0,s.jsx)("br",{}),"Local"==t&&a&&(0,s.jsx)(R.jx,{title:"Print Barcode",icon:(0,s.jsx)(F.default,{mr:"1ch",children:(0,s.jsx)(b.SCC,{})}),variant:"primary",uuid:e?.uuid}),"Local"==t&&a&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(U.A,{onClick:()=>n(`/patient/${e.uuid}/profile`),sx:{mb:"1ch"},variant:"text",children:"view profile"})}),r&&!a&&(0,s.jsx)(z.R,{patientId:"",dialogTitle:"Close Patient Visit",dialogConfirmationMsg:"Are you sure you want to close this visit?",visitId:e?.active_visit?.uuid,buttonTitle:"Close Visit",onDelete:()=>l(!1)})]}),(0,s.jsxs)(m.jD,{children:[(0,s.jsxs)(m.jD,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)(m.Th,{variant:"h5",children:[e?.given_name," ",e?.family_name]}),(0,s.jsx)(m.Th,{children:t})]}),(0,s.jsxs)(m.jD,{sx:{display:"flex"},children:[(0,s.jsx)(m.Th,{color:"GrayText",sx:{mr:1},children:"NPID:"}),(0,s.jsx)(m.Th,{color:"GrayText",children:d?.identifier})]}),(0,s.jsx)("br",{}),(0,s.jsxs)(m.jD,{sx:{display:"flex",mb:1},children:[(0,s.jsx)(q,{label:"Date of birth",value:e?.birthdate}),(0,s.jsx)(q,{label:"Gender",value:e?.gender})]}),(0,s.jsxs)(m.jD,{sx:{display:"flex"},children:[(0,s.jsx)(q,{label:"Home district",value:e&&e.addresses&&e?.addresses[0]?.address1}),(0,s.jsx)(q,{label:"Home traditional authority",value:e&&e.addresses&&e?.addresses[0]?.cityVillage}),(0,s.jsx)(q,{label:"Home village",value:e&&e.addresses&&e?.addresses[0]?.address2})]})]}),(0,s.jsx)(m.jD,{sx:{ml:"1ch"},children:r&&(0,s.jsx)($.A,{color:"success",label:"Visit"})})]})},q=({label:e,value:t})=>(0,s.jsxs)(m.jD,{sx:{display:"flex",flexDirection:"column",mr:1},children:[(0,s.jsx)(m.Th,{variant:"subtitle2",color:"#C0C0C0",sx:{mr:.5},children:e}),(0,s.jsx)(m.Th,{variant:"subtitle2",color:"#585858",children:t?t.toString():""})]}),J=({patient:e,onClose:t,open:i,type:r="remote"})=>{let[l,d]=(0,o.useState)(r),{params:c}=(0,h.KU)(),{ServerTime:u}=(0,S.useServerTime)(),{data:x}=(0,f.$O)(c?.id),{data:b,isPending:v}=(0,f.$O)(e?.uuid),{mutate:N,isSuccess:E}=(0,p.FD)(),{data:D,isPending:A}=(0,n.B$)(e?.uuid),[_,R]=(0,o.useState)({}),[C,O]=(0,o.useState)(""),[F,I]=(0,o.useState)(!1),[P,w]=(0,o.useState)(!1),{mutateAsync:k,isPending:M,isSuccess:V,isError:L}=(0,f.jM)(),{mutateAsync:W,isPending:Y,isSuccess:B,isError:H}=(0,f.jM)(),{mutateAsync:U,isPending:$,isSuccess:z,isError:G}=(0,f.jM)(),{mutateAsync:K,isPending:q,isSuccess:J,isError:Z,data:ee}=(0,n.h1)(),{mutateAsync:et,isPending:ei,isSuccess:es,isError:ea,data:er}=(0,n.h1)(),[el,en]=(0,o.useState)({}),[ed,eo]=(0,o.useState)({}),[ec,eu]=(0,o.useState)({[g.W.REFERRED_FROM]:""});(0,o.useEffect)(()=>{R(e)},[e]),(0,o.useEffect)(()=>{es&&d("")},[es]),(0,o.useEffect)(()=>{let e=x?.find(e=>e.encounter_type.uuid==g.fA.SCREENING_ENCOUNTER);O((0,y.m)(e?.obs,g.W.IS_PATIENT_REFERRED))},[x]),(0,o.useEffect)(()=>{z&&w(!0)},[z]);let em=async()=>{let t=e?.uuid,i=c?.id,s=await K({primary:{patient_id:t},secondary:[{patient_id:i}]});await k({encounterType:g.fA.SOCIAL_HISTORY,visit:s?.active_visit?.uuid,patient:s?.uuid,encounterDatetime:u.getServerTimeString(),obs:el?.obs?.map(e=>({concept:e.names[0].uuid,value:e.value,obsDatetime:u.getServerTimeString()}))}),await U({encounterType:g.fA.REFERRAL,visit:s?.active_visit?.uuid,patient:s?.uuid,encounterDatetime:u.getServerTimeString(),obs:[{concept:g.W.REFERRED_FROM,value:ec[g.W.REFERRED_FROM],obsDatetime:u.getServerTimeString()}]}),await W({encounterType:g.fA.FINANCING,visit:s?.active_visit?.uuid,patient:s?.uuid,encounterDatetime:u.getServerTimeString(),obs:ed?.obs?.map(e=>({concept:e.names[0].uuid,value:e.value,obsDatetime:u.getServerTimeString()}))})};(0,o.useEffect)(()=>{let e=b?.find(e=>e.encounter_type.uuid==g.fA.FINANCING),t=b?.find(e=>e.encounter_type.uuid==g.fA.SOCIAL_HISTORY);t&&en(t),e&&eo(e)},[b]);let ex=async e=>{await eu(e),await em(),I(!1)};return(0,s.jsxs)(m.eV,{sx:{backgroundColor:"#F6F6F6"},onClose:t,open:i,title:"view patient",children:[(0,s.jsx)(a.OverlayLoader,{open:q||$||Y||M||ei}),(0,s.jsx)(X,{open:P}),(0,s.jsx)(m.Th,{variant:"h4",children:`${e.given_name} ${e.family_name}`}),(0,s.jsx)("br",{}),(0,s.jsx)(m.O6,{title:"Continue with Patient",onClick:()=>{if(C==g.W.YES)return void I(!0);em()}}),"remote"==l&&(0,s.jsx)(m.O6,{sx:{mx:"1px"},title:"Merge Patient",onClick:()=>{let t=e?.uuid;et({primary:{patient_id:_.uuid},secondary:[{doc_id:t}]})}}),(0,s.jsx)(Q,{open:F,onClose:()=>I(!1),onSubmit:ex}),(0,s.jsx)("br",{}),(0,s.jsx)(j.l,{disabled:"remote"==l,patient:e}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsx)(T.vY,{disabled:"remote"==l,patientId:e?.uuid,loading:A,relationships:D||[]}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(m.jD,{display:"flex",children:[(0,s.jsx)(T.oC,{disabled:"remote"==l,onSubmit:e=>{en({obs:Object.keys(e).map(t=>({names:[{uuid:t}],concept:t,value:e[t],obsDatetime:u.getServerTimeString()}))})},loading:v,socialHistory:el||{}}),(0,s.jsx)(T.c4,{disabled:"remote"==l,onSubmit:e=>{let t=e[g.W.PAYMENT_OPTIONS].filter(e=>e.value),i=t[0]?.key;e[g.W.PAYMENT_OPTIONS]=i;let s=JSON.parse(JSON.stringify(ed)),a={"c7bcc8bd-09d5-4f98-8d58-5179f749fd99":g.W.PAYMENT_OPTIONS,"b0ffce26-2d25-449e-871e-c702e44bb37e":g.W.INSURANCE_PROVIDER,"98b08fb2-f877-45b6-a95a-db89dffefb27":g.W.INSURANCE_NUMBER,"db2e6bba-7d04-4873-a0a2-ac7bd69dd7b1":g.W.INSURANCE_SCHEME,"3cdd53d9-35a5-47e5-909f-654e5bc7c9a8":g.W.INSURANCE_STATUS},r=s.obs.map(t=>{let i=e[a[t.names[0].uuid]];return{...t,value:i}});s.obs=r,eo(s)},loading:v,financing:ed||{}})]})]})},Q=({open:e,onClose:t,onSubmit:i})=>(0,s.jsx)(m.eV,{maxWidth:"sm",title:"Add Referral",open:e,onClose:t,children:(0,s.jsx)(D,{onSubmit:i})}),X=({open:e})=>{let{navigateTo:t}=(0,h.cq)();return(0,s.jsx)(m.eV,{open:e,maxWidth:"sm",title:"",onClose:()=>{},children:(0,s.jsx)(A.n,{title:"Process Completed Successfully",primaryActionText:"Register More",secondaryActionText:"Go Home",onPrimaryAction:()=>{t("/registration/list")},onSecondaryAction:()=>{t("/dashboard")}})})},Z=({patient:e,genericSearch:t=!1})=>{let{setSearchedPatient:i}=(0,o.useContext)(r.$0),[d,u]=(0,o.useState)({firstName:"",lastName:"",gender:""}),{refetch:m,isFetching:x,isSuccess:h,data:b,isError:j}=(0,n.L3)(d.firstName,d.lastName,d.gender),[f,p]=(0,o.useState)({});return(0,o.useEffect)(()=>{d.firstName&&m()},[d]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.B,{init:{firstName:e?.given_name,lastName:e?.family_name},onSubmit:t=>{p(t),u({firstName:t.firstName,lastName:t.lastName,gender:t.gender}),i({patient_id:e.patient_id,firstName:t.firstName,lastName:t.lastName,gender:t.gender})},fullForm:!1}),(0,s.jsx)("br",{}),(0,s.jsx)(a.OverlayLoader,{open:x}),(h||j)&&(0,s.jsx)(G,{genericSearch:t,searchResults:l(b),searchedPatient:f})]})},ee=({genericSearch:e=!0})=>{let[t,i]=(0,o.useState)(""),{refetch:r,isFetching:l,isSuccess:n,data:c,isError:m}=(0,d.Ov)(t);return(0,o.useEffect)(()=>{t&&r()},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.OverlayLoader,{open:l}),(0,s.jsx)(u.c,{onSubmit:e=>i(e.npid)}),(n||m)&&(0,s.jsx)(G,{genericSearch:e,searchResults:c||{remotes:[],locals:[]},searchedPatient:c})]})}}};