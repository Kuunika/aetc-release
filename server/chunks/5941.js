"use strict";exports.id=5941,exports.ids=[5941],exports.modules={75941:(a,b,c)=>{c.d(b,{Ay:()=>v,wv:()=>s});var d=c(21124),e=c(95627),f=c.n(e),g=c(38301),h=c(45992),i=c(80350),j=c(95745),k=c(82283),l=c(50852),m=c(66951),n=c(48936),o=c(38634),p=c(85910),q=c(90675),r=c(79165);let s={dischargeHome:{name:j.W.DISCHARGE_HOME,label:"Discharge home",groupMembersWithLabel:!0,type:"string",children:[{concept:j.W.DISCHARGE_PLAN,label:"Discharge Plan"},{concept:j.W.FOLLOWUP_PLAN,label:"Follow-Up Plan",children:[{concept:j.W.FOLLOWUP_DETAILS,label:"Follow-Up Facility"},{concept:j.W.SPECIALIST_CLINIC,label:"Clinics"}]},{concept:j.W.HOME_CARE_INSTRUCTIONS,label:"Home Care Instructions"},{concept:j.W.DISCHARGE_NOTES,label:"Discharge Notes"}]},deathOutcome:{name:j.W.DEATH,label:"Death",groupMembersWithLabel:!0,type:"string",children:[{concept:j.W.CAUSE_OF_DEATH,label:"Cause of Death"},{concept:j.W.FAMILY_INFORMED,label:"Family Informed"},{concept:j.W.RELATIONSHIP_TO_DECEASED,label:"Relationship to Deceased"},{concept:j.W.MORTUARY,label:"Mortuary"},{concept:j.W.LAST_OFFICE_CONDUCTED,label:"Last Office Conducted"},{concept:j.W.NAME_OF_HEALTH_WORKER_WHO_CONDUCTED_LAST_OFFICE,label:"Name of Health Worker Who Conducted Last Office"},{concept:j.W.DATE_OF_LAST_OFFICE,label:"Date of Last Office"}]},absconded:{name:j.W.ABSCONDED,label:"Absconded",groupMembersWithLabel:!0,type:"string",children:[{concept:j.W.LAST_SEEN_LOCATION,label:"Last Seen Location"},{concept:j.W.DATE_OF_ABSCONDING,label:"Date of Absconding"},{concept:j.W.TIME_OF_ABSCONDING,label:"Time of Absconding"}]},admission:{name:j.W.ADMISSION,groupMembersWithLabel:!0,label:"Admission",type:"string",children:[{concept:j.W.WARD,label:"Ward"},{concept:j.W.BED_NUMBER,label:"Bed number"},{concept:j.W.REASON_FOR_ADMISSION,label:"reason for admission"},{concept:j.W.SPECIALITY_DEPARTMENT,label:"Speciality Department"}]},awaitingSpeciaty:{name:j.W.AWAITING_SPECIALITY_REVIEW,label:"Awaiting specialty review",groupMembersWithLabel:!0,type:"string",children:[{concept:j.W.SPECIALITY_DEPARTMENT,label:"Speciality Department"},{concept:j.W.REASON_FOR_REQUEST,label:"Reason for Request"},{concept:j.W.DATE,label:"Date"}]},refusedTreatment:{name:j.W.REFUSED_HOSPITAL_TREATMENT,label:"Refused Hospital Treatment",type:"string",groupMembersWithLabel:!0,children:[{concept:j.W.REASON_FOR_REFUSAL,label:"Reason for refusal"},{concept:j.W.PLANS_TO_RETURN_FOR_TREATMENT,label:"Plans to return for treatment"},{concept:j.W.DATE_OF_REFUSAL,label:"Date of refusal"},{concept:j.W.WITNESS_NAME,label:"Witness name"}]},transferOut:{name:j.W.TRANSFER_OUT,label:" Transfer Out",groupMembersWithLabel:!0,children:[{concept:j.W.FACILITY_NAME,label:"Facility Name"},{concept:j.W.REASON_FOR_TRANSFER,label:"Reason for Transfer"}]}},t=n.Ik({specialistClinic:n.Yj().when("followUpPlan",{is:a=>a===j.W.YES,then:a=>a,otherwise:a=>a.optional()})}),u={dischargePlan:"",followUpPlan:"",homeCareInstructions:"",followUpDetails:"",dischargeNotes:"",specialistClinic:"",otherServiceArea:""};function v({openPatientSummary:a,setInitialNotes:b}){let{params:c}=(0,k.KU)(),{mutate:e}=(0,l.jM)(),[f,n]=(0,g.useState)(void 0),{data:r}=(0,m.iu)(c.id),{init:s,ServerTime:t}=(0,q.useServerTime)(),[u,v]=(0,g.useState)(null),x=(0,g.useRef)(null),y=async(d,g)=>{let h=t.getServerTimeString(),i=d.specialistClinic;d.specialistClinic===u&&d.otherServiceArea&&(i=d.otherServiceArea),b({dischargeNotes:d.dischargeNotes,dischargePlan:d.dischargePlan,followUpDetails:d.followUpDetails,followUpPlan:d.followUpPlan,clinic:g.find(a=>a.id===d.specialistClinic)?.label||d.specialistClinic,homeCareInstructions:d.homeCareInstructions});let k=[{concept:j.W.DISCHARGE_HOME,value:j.W.DISCHARGE_HOME,obsDatetime:h,groupMembers:[{concept:j.W.DISCHARGE_PLAN,value:d.dischargePlan,obsDatetime:h},{concept:j.W.FOLLOWUP_PLAN,value:d.followUpPlan,obsDatetime:h},{concept:j.W.HOME_CARE_INSTRUCTIONS,value:d.homeCareInstructions,obsDatetime:h},{concept:j.W.FOLLOWUP_DETAILS,value:d.followUpDetails,obsDatetime:h},{concept:j.W.DISCHARGE_NOTES,value:d.dischargeNotes,obsDatetime:h},{concept:j.W.SPECIALIST_CLINIC,value:i||"",obsDatetime:h}]}],l={encounterType:j.fA.DISPOSITION,visit:f?.uuid,patient:c.id,encounterDatetime:h,obs:k};try{await e(l),a()}catch(a){console.error("Error submitting Discharge Home information: ",a)}};(0,h.useReactToPrint)({contentRef:x});let z=[{id:"DischargeHome",title:(0,d.jsx)("h2",{children:"Discharge Home"}),content:(0,d.jsx)(w,{handleSubmit:y,setOtherId:v,otherId:u,contentRef:x})},{id:"medications",title:(0,d.jsx)("h2",{children:"Prescribe Medications"}),content:(0,d.jsx)(p.a,{})}];return(0,d.jsx)(i.Yr,{container:!0,spacing:2,children:(0,d.jsx)(i.Yr,{item:!0,xs:12,lg:12,children:(0,d.jsx)(o.M,{sections:z})})})}let w=({handleSubmit:a,contentRef:b,setOtherId:c,otherId:e})=>{let{data:h}=(0,k.WL)(),{serviceAreaOptions:l}=(0,r.C)(),[m,o]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{if(l){let a=l.find(a=>"Other"===a.label);c(a?a.id:null)}},[l]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.PD,{initialValues:u,validationSchema:(()=>{let a=t.clone();return e?a.shape({otherServiceArea:n.Yj().when("specialistClinic",{is:a=>a===e,then:a=>a.required("Other Service Area is required"),otherwise:a=>a.optional()})}):a})(),onSubmit:b=>a(b,l),submitButtonText:"Submit",children:({values:a,setFieldValue:c})=>((0,g.useEffect)(()=>{a.specialistClinic===e?o(!0):(o(!1),c("otherServiceArea",""))},[a.specialistClinic,e,c]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{ref:b,className:"jsx-7b66091306a8e529 printable-content",children:(0,d.jsxs)("div",{className:"jsx-7b66091306a8e529 print-only",children:[(0,d.jsx)(i.TF,{}),(0,d.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,d.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Discharge Plan:"})," ",a.dischargePlan]}),(0,d.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,d.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Followup Plan:"})," ",a.followUpPlan]}),(0,d.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,d.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Home care Instructions:"})," ",a.homeCareInstructions]}),a.followUpPlan===j.W.YES&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,d.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Follow up details:"})," ",a.followUpDetails]}),(0,d.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,d.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Service Area:"})," ",a.specialistClinic===e?a.otherServiceArea:l.find(b=>b.id===a.specialistClinic)?.label||a.specialistClinic]})]}),(0,d.jsxs)("p",{className:"jsx-7b66091306a8e529",children:[(0,d.jsx)("strong",{className:"jsx-7b66091306a8e529",children:"Discharge notes:"})," ",a.dischargeNotes]})]})}),(0,d.jsxs)(i.Yr,{container:!0,spacing:2,children:[(0,d.jsxs)(i.Yr,{item:!0,xs:12,md:6,children:[(0,d.jsx)(i.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,d.jsx)(i.A8,{id:"dischargeNotes",name:"dischargeNotes",label:"Discharge Notes",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write discharge notes"})}),(0,d.jsx)(i.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,d.jsx)(i.A8,{id:"dischargePlan",name:"dischargePlan",label:"Discharge Plan (apart from the medications)",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write the discharge plan"})}),(0,d.jsx)(i.Yr,{item:!0,xs:12,children:(0,d.jsx)(i.A8,{id:"homeCareInstructions",name:"homeCareInstructions",label:"Home Care Instructions",sx:{width:"100%"},multiline:!0,rows:3,placeholder:"Write specific home care instructions"})})]}),(0,d.jsxs)(i.Yr,{item:!0,xs:12,md:6,children:[(0,d.jsx)(i.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,d.jsx)(i.b1,{name:"followUpPlan",label:"Follow-Up Plan",options:[{value:j.W.YES,label:"Yes"},{value:j.W.NO,label:"No"}]})}),a.followUpPlan===j.W.YES&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.Yr,{item:!0,xs:12,sx:{mb:2},children:(0,d.jsx)(i.el,{name:"followUpDetails",label:"Follow-Up Facility",options:h?h.map(a=>({id:a.facility_name,label:a.facility_name})):[],multiple:!1})}),(0,d.jsxs)(i.Yr,{item:!0,xs:12,children:[(0,d.jsx)(i.el,{name:"specialistClinic",label:"Clinics (If applicable)",options:l,multiple:!1}),m&&(0,d.jsx)(i.A8,{id:"otherServiceArea",name:"otherServiceArea",label:"Other Service Area",sx:{mt:2,width:"100%"}})]})]})]})]})]}))}),(0,d.jsx)(f(),{id:"7b66091306a8e529",children:"@media print{.print-only.jsx-7b66091306a8e529{display:block!important}}.print-only.jsx-7b66091306a8e529{display:none}"})]})}},79165:(a,b,c)=>{c.d(b,{C:()=>f});var d=c(38301),e=c(29324);let f=()=>{let{data:a,isLoading:b}=(0,e.X)("Service areas"),[c,f]=(0,d.useState)([]);return(0,d.useEffect)(()=>{if(a){let b=a.map(a=>({label:a.name,id:a.uuid}));f(b),b.find(a=>"Other"===a.label)}},[a]),{serviceAreaOptions:c,serviceAreaLoading:b,serviceAreas:a}}},85910:(a,b,c)=>{c.d(b,{a:()=>B});var d=c(21124),e=c(80350),f=c(38301),g=c(16776),h=c(48936),i=c(81637),j=c(21544),k=c(44990),l=c(82081),m=c(95745),n=c(50852),o=c(82283),p=c(24390),q=c(1973),r=c(38634),s=c(95373),t=c(90675);let u={name:"",formulation:"",medication_dose:0,medication_dose_unit:"",medication_frequency:"",medication_duration:0,medication_duration_unit:""},v={medications:[u]},w=[{id:m.W.TABLET,label:"Tablet"},{id:m.W.VIAL,label:"Vial"},{id:m.W.INTRAVENOUS,label:"Intravenous"},{id:m.W.POWDER,label:"Powder"},{id:m.W.SOLUTION,label:"Solution"},{id:m.W.EYE_OINTMENT,label:"Eye Ointment"},{id:m.W.CREAM,label:"Cream"},{id:m.W.EYE_DROPS,label:"Eye Drops"},{id:m.W.OINTMENT,label:"Ointment"},{id:m.W.INHALER,label:"Inhaler"},{id:m.W.SUPPOSITORY,label:"Suppository"},{id:m.W.PESSARY,label:"Pessary"},{id:m.W.SUSPENSION,label:"Suspension"},{id:m.W.SHAMPOO,label:"Shampoo"},{id:m.W.EAR_DROPS,label:"Ear Drops"},{id:m.W.EYE_PASTE,label:"Eye Paste"}],x=[{id:"STAT",label:"STAT"},{id:m.W.ONCE_A_DAY,label:"24 Hourly (OD) - Once a day "},{id:m.W.TWICE_A_DAY,label:"12 Hourly (BID) - Twice a day"},{id:m.W.THREE_TIMES_A_DAY,label:"8 Hourly (TID) - Three times a day"},{id:m.W.FOUR_TIMES_A_DAY,label:"6 Hourly (QID) - Four times a day"},{id:m.W.SIX_TIMES_A_DAY,label:"4 Hourly (OD) - Six times a day "},{id:m.W.ONCE_A_WEEK,label:"Once a week"},{id:m.W.ONCE_A_MONTH,label:"Once a month"},{id:m.W.MORNING,label:"Morning"},{id:m.W.EVENING,label:"Evening"},{id:m.W.OTHER,label:"Other"}],y=h.Ik().shape({medications:h.YO().of(h.Ik().shape({name:h.Yj().required("Medication name is required"),formulation:h.Yj().required("Formulation is required"),medication_dose:h.ai().required("Dose is required").positive("Dose must be greater than 0"),medication_dose_unit:h.Yj().required("Dose unit is required"),medication_frequency:h.Yj().required("Frequency is required"),medication_duration:h.ai().required("Duration is required").positive("Duration must be greater than 0"),medication_duration_unit:h.Yj().required("Duration unit is required"),medication_date_last_taken:h.p6().nullable().required("Date of last taken is required"),medication_date_of_last_prescription:h.p6().nullable().required("Date of last prescription is required")}))}),z=["Milligrams (mg)","Micrograms (\xb5g)","Grams (g)","International Units (IU)","Milliliters (ml)","Millimoles (mmol)"],A=({onSubmit:a,onSkip:b,encounterType:c=m.fA.DISPOSED_PRESCRIPTIONS,onSubmissionSuccess:h,medicationTitle:A="Prescribed Medication",medicationLabelTitle:B})=>{let{ServerTime:C}=(0,t.useServerTime)(),{mutate:D,isPending:E,isSuccess:F}=(0,n.jM)(),{medicationOptions:G,loadingDrugs:H}=(0,s.A)(),[I,J]=(0,f.useState)({}),[K,L]=(0,f.useState)({medications:[]}),{activeVisit:M,patientId:N}=(0,o.gd)();(0,f.useEffect)(()=>{F&&h()},[F]);let O=()=>{let a=C.getServerTimeString(),b=K.medications.map(b=>({concept:m.W.DRUG_GIVEN,value:b.name,obsDateTime:a,groupMembers:[{concept:m.W.MEDICATION_FORMULATION,value:b.formulation,obsDateTime:a},{concept:m.W.MEDICATION_DOSE,value:b.medication_dose,obsDateTime:a},{concept:m.W.MEDICATION_DOSE_UNIT,value:b.medication_dose_unit,obsDateTime:a},{concept:m.W.MEDICATION_FREQUENCY,value:b.medication_frequency,obsDateTime:a},{concept:m.W.MEDICATION_DURATION,value:b.medication_duration,obsDateTime:a},{concept:m.W.MEDICATION_DURATION_UNIT,value:b.medication_duration_unit,obsDateTime:a},{concept:m.W.DESCRIPTION,value:"current",obsDateTime:a}]}));D({encounterType:c,visit:M,patient:N,encounterDatetime:a,obs:b})},P=[{id:"prescribed",title:A,content:(0,d.jsx)(q.Z,{medicationLabelTitle:B,encounterType:c})}];return(0,d.jsxs)(p.h,{loading:E||H,children:[(0,d.jsx)(r.M,{sections:P}),(0,d.jsx)("br",{}),(0,d.jsx)(e.PD,{initialValues:v,validationSchema:y,onSubmit:a,enableReinitialize:!0,submitButton:!1,children:({values:a,setFieldValue:b})=>(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.fP,{getValues:L}),(0,d.jsx)(g.ED,{name:"medications",children:({push:c,remove:f})=>(0,d.jsx)(j.A,{items:a.medications,setItems:a=>b("medications",a),newItem:u,renderFields:(a,c)=>(0,d.jsxs)(i.default,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[(0,d.jsx)(e.el,{name:`medications[${c}].name`,label:"Medication Name",options:G,getValue:a=>b(`medications[${c}].name`,a),multiple:!1}),(0,d.jsx)(e.el,{name:`medications[${c}].formulation`,label:"Formulation",options:w,getValue:a=>b(`medications[${c}].formulation`,a),sx:{flex:1},multiple:!1}),(0,d.jsx)(e.pj,{id:`medications[${c}].medication_dose`,label:"Dose",name:`medications[${c}].medication_dose`,unitName:`medications[${c}].medication_dose_unit`,unitOptions:z,placeholder:"e.g., 500",inputIcon:(0,d.jsx)(l.gaX,{})}),I[c]?(0,d.jsx)(e.A8,{id:`medications[${c}].medication_frequency`,name:`medications[${c}].medication_frequency`,label:"Specify frequency",sx:{flex:1}}):(0,d.jsx)(e.el,{name:`medications[${c}].medication_frequency`,label:"Frequency",options:x,getValue:a=>{"Other"===a&&J(a=>({...a,[c]:!0})),b(`medications[${c}].medication_frequency`,a)},multiple:!1}),K?.medications[c]?.medication_frequency!="STAT"&&(0,d.jsx)(e.pj,{id:`medications[${c}].medication_duration`,name:`medications[${c}].medication_duration`,unitName:`medications[${c}].medication_duration_unit`,label:"Duration",unitOptions:m.bH,placeholder:"e.g. 7",inputIcon:(0,d.jsx)(k.YmN,{}),sx:{flex:1}})]})})}),(0,d.jsx)(e.jD,{sx:{mt:"2ch"},children:(0,d.jsx)(e.O6,{sx:{m:.5},title:"Submit",type:"submit",onClick:O})})]})})]})},B=()=>(0,d.jsx)(A,{medicationLabelTitle:"Medication to Pharmacy",medicationTitle:"Medication to Pharmacy",onSubmissionSuccess:()=>{},encounterType:m.fA.DISPOSED_PRESCRIPTIONS,onSkip:()=>{},onSubmit:()=>{}})}};